<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@page import="com.estar.system.common.DptUtils"%>
<%@ include file="../include/common.jsp"%>
<%@page isELIgnored="false"%> 
<html>
<HEAD>
<TITLE>车辆定损信息</TITLE> 
	  <base target="_self">
       <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
       <meta http-equiv="pragma" content="no-cache">
       <meta http-equiv="expires" content="wed, 26 Feb 1997 08:21:57 GMT">
       <link rel="stylesheet" type="text/css" href="<%=context%>/common/css/td_style_ec.css" />
	   <link href="<%=context%>/css/style.css" rel="stylesheet" type="text/css">
	   <script type="text/javascript" src="<%=context%>/javascript/tab.js"></script>
	   <script type="text/javascript" src="<%=context%>/javascript/common.js"></script>
	   <%-- <script type="text/javascript" src="<%=context%>/javascript/validator.js"></script> --%>
	   <script type="text/javascript" src="<%=context%>/claimjs/surveyauto.js"></script>
	   <script type="text/javascript" src="<%=context%>/javascript/list.js"></script>
	   <script type="text/javascript" src="<%=context%>/common/js/prototypeajax.js" ></script>	
	   <script type="text/javascript" src="<%=context%>/common/js/ecside.js" ></script>
	   <script type="text/javascript" src="<%=context%>/javascript/ajax.js"></script>
       <script type="text/javascript" src="<%=context%>/javascript/claimcommon.js"></script>
	   <script type="text/javascript" src="<%=context%>/javascript/img.js"></script>
	   <link href="<%=context%>/css/messagebox.css" rel="stylesheet" type="text/css" />
	   <script language="javascript" src="<%=context%>/javascript/messagebox.js"></script>
	   <script type="text/javascript" src="<%=context%>/javascript/datetime.js"></script>
		<script type="text/javascript" src="<%=context%>/javascript/jquery-1.7.js"></script>
	   <script language=javascript> 
		document.write("<script type='text/javascript' src='<%=context%>/javascript/validator.js?"+Math.random()+"'></scr"+"ipt>");
	   </script> 
	   	
	<script language=javascript>
		var doc=window.opener.document;
		var win=window.opener;
		var othInsCde = ["030006"];
		
		function addStandardFitting(){	
			if(document.getElementById("vo.factoryType").value == ""){
				alert("请选择修理厂类型！");
				return;
			}
			if(document.getElementById("vo.lcnNo").value == ""){
				alert("请录入车牌号！");
				return;
			}
			
			if(document.getElementById("dictIns").value == null || document.getElementById("dictIns").value == ""){
				alert("当前不允许定损本车信息，不能进入精友！");
				return;
			}
			
			document.getElementById("directTrainOpr").value = "0";
			nowTime = new Date();
			var strUrl = "http://www.51clm.com:8112/survey/partSelect_main.do?dptId="+doc.getElementById("deptId").value+"&r="+nowTime;
			nowTime = new Date();
			var strUrl = "../survey/surveyAuto.do?mhd=addStandardFitting&dptId="+doc.getElementById("deptId").value+"&r="+nowTime;
			var condition = "&dispatchId=" + document.getElementById("dispatchId").value+
							"&caseNo=" + document.getElementById("caseNo").value+
							"&operateFlag=" + document.getElementById("operateFlag").value+
							"&dictIns=" + document.getElementById("dictIns").value+
							"&lcnNo=" + document.getElementById("vo.lcnNO").value+
							"&engNo=" + document.getElementById("vo.engNo").value+
							"&vhlFrm=" + document.getElementById("vo.vhlFrm").value+
							"&brndNme=" + document.getElementById("vo.brndNme").value+
							"&brndCde=" + document.getElementById("vo.brndCde").value+
							"&deptName=" + document.getElementById("deptName").value+
							"&userId=" + document.getElementById("userId").value+
							"&userName=" + document.getElementById("userName").value+
							"&factoryType=" + document.getElementById("vo.factoryType").value;
			var url = strUrl+condition;
			url = encodeURI(url);
			url = encodeURI(url);
			window.open(url,"surveyjy","height=668,width=1024,top=0,left=0,toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=yes"); 
		}
			
		//配件获取函数
		function closeModelDiv(){
		   showmodeldiv.style.display = "none";
		}
		
		//配件获取函数
		function getFitting(){
			request=new newXMLHttpRequest();
			var url = "../survey/surveyAuto.do";
			var param = "mhd=getFitting&dispatchId="+document.getElementById("dispatchId").value+"&dptId="+doc.getElementById("deptId").value;
			request.open("POST", url, true);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange =rollback_tasklist;
	    	request.send(param);
		}
		////配件新增的ajax回调函数
		function rollback_tasklist() {
			if (request.readyState == 4) {
				if (request.status == 200) {
					var response=request.responseText;
					//alert(response);
					
					// 返回数据 配件信息 + "@@@@@@" + 车型信息
					var responseArr = response.split("@@@@@@");				
					var result = eval('o= new Array('+responseArr[0]+');');
					var lossCarInfo;
					
					// 保存车型的信息
					if (responseArr.length > 1) {
						lossCarInfo = eval('o= new Array('+responseArr[1]+');');	
					    var vehType = lossCarInfo[0].vehType;
					    var carTyp = "国产";// 车辆类型(1进口 2国产 3合资)
					    if ("1" == vehType) {
					       carTyp = "进口";
					    }	   			   
						document.getElementById("vo.brndCde").value=lossCarInfo[0].vehCertainCode;// 车辆型号编码
						document.getElementById("vo.brndNme").value=lossCarInfo[0].vehCertainName;// 车辆型号
						document.getElementById("vo.carTyp").value=carTyp;// 车辆类型
						document.getElementById("vo.prdYear").value=lossCarInfo[0].vehYearType;// 生产年份
						document.getElementById("vo.fctNme").value=lossCarInfo[0].vehFactoryName;// 生产厂家
						document.getElementById("vo.carNme").value=lossCarInfo[0].vehBrandName;// 车辆品牌
						document.getElementById("vo.carSeries").value=lossCarInfo[0].vehSeriName; // 车型系列			   
					}
					
					var html="";
					html='<TABLE  width=100% border="0" cellspacing="1" cellpadding="2" class=listTable>\n';
					var ctrlCount = 0;
					var fitStr;
					var fitArr = new Array();
					if (result.length > 0) {
					  fitStr = clearFittingTable();
					  fitArr = eval('o= new Array('+fitStr+');');
					 }
					
					for (var i = 0 ; i < result.length ; i++) {
						fittings_add('0');  //加一行
	
						ctrlCount =  document.getElementById("fitIndex").value;  //列表行数
						ctrlCount = ctrlCount - 1;
						var strName = "autoFittingsList["+ctrlCount+"].";					
						document.getElementsByName(strName + "iniFtnsCde")[0].value = result[i].iniFtnsCde;
						//document.getElementsByName(strName + "insCde")[0].value = result[i].insCde;
						document.getElementsByName(strName + "fittingsNme")[0].value = result[i].fittingsNme;
						document.getElementsByName(strName + "fittingsNme")[0].readOnly = true;
						document.getElementsByName(strName + "fitType")[0].value = "0510001";   //result[i].fitType;
						document.getElementsByName(strName + "fitAmt")[0].value = result[i].fitAmt;
						document.getElementsByName(strName + "fitAmt")[0].readOnly = true;
						document.getElementsByName(strName + "fitMarketAmt")[0].value = result[i].fitMarketAmt;// fitMarketAmt
						document.getElementsByName(strName + "srvyAmt")[0].value = result[i].srvyAmt;
						document.getElementsByName(strName + "piece")[0].value = result[i].piece;
						document.getElementsByName(strName + "piece")[0].readOnly = true;
						//alert(document.getElementsByName(strName + "piece")[0].readonly );
						document.getElementsByName(strName + "totalAmt")[0].value = result[i].totalAmt;
						document.getElementsByName(strName + "firstAmt")[0].value = result[i].firstAmt;
						document.getElementsByName(strName + "remark")[0].value = result[i].remark;	
						document.getElementsByName(strName + "callbackFlagSave")[0].value = "0";	
						
						var claimInfo = result[i].claimInfo;	
						var claimInfoArr = claimInfo.split("@");
						// 配件回收标志
						if (claimInfoArr[0] == "1") {
						   document.getElementsByName(strName + "callBackFlag")[0].checked = true;
						   document.getElementsByName(strName + "callbackFlagSave")[0].value = "1";
						}
						if (claimInfoArr.length > 1) {
						   document.getElementsByName(strName + "insCde")[0].value = claimInfoArr[1];
						}					
						// recyclePrintId
						if (claimInfoArr.length > 2) {
						   document.getElementsByName(strName + "recyclePrintId")[0].value = claimInfoArr[2];
						}
						
						//add by qinfx on 2011-03-07 start
						//核价金额
						if (claimInfoArr.length > 3) {
						   document.getElementsByName(strName + "checkAmt")[0].value = claimInfoArr[3];
						}
						
						//核价数量
						if (claimInfoArr.length > 4) {
						   document.getElementsByName(strName + "checkPiece")[0].value = claimInfoArr[4];
						}
						
						//核价残值
						if (claimInfoArr.length > 5) {
						   document.getElementsByName(strName + "checkSrv")[0].value = claimInfoArr[5];
						}
						
						//核价总额
						if (claimInfoArr.length > 6) {
						   document.getElementsByName(strName + "chktotAmt")[0].value = claimInfoArr[6];
						}															
						//add by qinfx on 2011-03-07 end
						
						// ---------------------------- 20101014 xuh add for jyfittings start 
						document.getElementsByName(strName + "partId")[0].value = result[i].partId;
						sumFittings(document.getElementById(strName+"srvyAmt"));
						// ---------------------------- 20101014 xuh add for jyfittings end 
					}
					
					for (var i = 0 ; i < fitArr.length ; i++) {
					    fittings_add('0');  //加一行
						ctrlCount =  document.getElementById("fitIndex").value;  //列表行数
						ctrlCount = ctrlCount - 1;
						var strName = "autoFittingsList["+ctrlCount+"].";					
						document.getElementsByName(strName + "iniFtnsCde")[0].value = fitArr[i].iniFtnsCde;
						document.getElementsByName(strName + "fittingsNme")[0].value = fitArr[i].fittingsNme;
						document.getElementsByName(strName + "fitType")[0].value = fitArr[i].fitType;
						document.getElementsByName(strName + "fitAmt")[0].value = fitArr[i].fitAmt;
						document.getElementsByName(strName + "fitAmt")[0].readOnly = true;
						document.getElementsByName(strName + "fitMarketAmt")[0].value = fitArr[i].fitMarketAmt;
						document.getElementsByName(strName + "fitMarketAmt")[0].readOnly = true;
						document.getElementsByName(strName + "srvyAmt")[0].value = fitArr[i].srvyAmt;
						document.getElementsByName(strName + "piece")[0].value = fitArr[i].piece;
						document.getElementsByName(strName + "srv")[0].value = fitArr[i].srv;
						document.getElementsByName(strName + "remark")[0].value = fitArr[i].remark;	
						document.getElementsByName(strName + "partId")[0].value = "";
						document.getElementsByName(strName + "fitAllStyle")[0].value = fitArr[i].fitAllStyle;
						document.getElementsByName(strName + "insCde")[0].value = fitArr[i].insCde; // insCde
						document.getElementsByName(strName + "recyclePrintId")[0].value = fitArr[i].recyclePrintId; // recyclePrintId
						
						//add by qinfx on 2011-03-07 start
						document.getElementsByName(strName + "checkAmt")[0].value = fitArr[i].checkAmt;			// 核价金额
						document.getElementsByName(strName + "checkPiece")[0].value = fitArr[i].checkPiece;		// 核价数量
						document.getElementsByName(strName + "checkSrv")[0].value = fitArr[i].checkSrv; 		// 核价残值
						document.getElementsByName(strName + "chktotAmt")[0].value = fitArr[i].chktotAmt; 		// 核价总额
	
						//add by qinfx on 2011-03-07 start
						
						sumFittings(document.getElementById(strName+"srvyAmt"));
						
						if (fitArr[i].callBackFlag == "1") {
						  document.getElementsByName(strName + "callBackFlag")[0].checked = true;
						}
					}
				} else{
					alert("system error,status is " + request.status);
				}
			}
			
			showmodeldiv.style.display = "none";
		}
		
		//配件成功返回时，清除配件表格数据，并将自定义配件数据保存到缓存中。
		function clearFittingTable() {
		   var fitIndex = document.getElementById("fitIndex").value;
		   if (fitIndex == null) {
		     return null;
		   }
		  var fitStr = "";
		  for (var i = 0; i < fitIndex; i++) {
		      var name = "autoFittingsList[" + i + "].";
		      var partId = document.getElementById(name + "partId").value;
		      
		      //partId!=null or partId!="" 则为自定义配件 反之，则为标准配件
		      if (partId != null && partId != "") {
		         continue;
		      }
		      if (fitStr == "") {
		        fitStr =  "{";
		      } else {
		        fitStr +=  ",{";
		      }
		      fitStr += "iniFtnsCde:'" + document.getElementById(name + "iniFtnsCde").value + "',";   // 配件编号
		      fitStr += "fittingsNme:'" + document.getElementById(name + "fittingsNme").value + "',"; // 配件名称
		      fitStr += "fitType:'" + document.getElementById(name + "fitType").value + "',";         // 配件类型
		      fitStr += "remark:'" + document.getElementById(name + "remark").value + "',";           // 备注
		      fitStr += "fitAmt:'" + document.getElementById(name + "fitAmt").value + "',";           // 专修价
		      fitStr += "fitMarketAmt:'" + document.getElementById(name + "fitMarketAmt").value + "',"; // 市场价
		      fitStr += "srvyAmt:'" + document.getElementById(name + "srvyAmt").value + "',";         // 定损价
		      fitStr += "srv:'" + document.getElementById(name + "srv").value + "',";                 // 定损残值
		      fitStr += "piece:'" + document.getElementById(name + "piece").value + "',";             // 定损数量
		      fitStr += "fitAllStyle:'" + document.getElementById(name + "fitAllStyle").value + "',";  // 定损数量
		      fitStr += "insCde:'" + document.getElementById(name + "insCde").value + "',";  // 险种代码
		      fitStr += "recyclePrintId:'" + document.getElementById(name + "recyclePrintId").value + "',";  // recyclePrintId
			  
			  //add by qinfx on 2011-03-07 start
			  fitStr += "checkAmt:'" + document.getElementById(name + "checkAmt").value + "',";         // 核价金额
			  fitStr += "checkPiece:'" + document.getElementById(name + "checkPiece").value + "',";     // 核价数量
		      fitStr += "checkSrv:'" + document.getElementById(name + "checkSrv").value + "',";  		// 核价残值
		      fitStr += "chktotAmt:'" + document.getElementById(name + "chktotAmt").value + "',";  		// 核价总额
			  //add by qinfx on 2011-03-07 end
	
		      var callback = "0";
		      if (document.getElementById(name + "callBackFlag").checked) {
		        callback = "1";
		      }	      
		      fitStr += "callBackFlag:'" + callback + "'";  // 回收标志 
		      fitStr += "}";
		   }
		   while (document.getElementById("fitIndex").value > 0) {
		      fitIndex = document.getElementById("fitIndex").value;
		      document.getElementById("fitTab").deleteRow(parseInt(fitIndex) + 1);
		      document.getElementById("fitIndex").value--;
		   }
		   
		   return fitStr;
		}
		
		function cancel_onclick(){
			page_onunload();
			window.close();
		}
		
		function del_row(tablename){
			if(getFieldValue("operateFlag")!="survey"){
				alert("当前任务不可以进行删除操作！");
				return;
			}
			
			if(vadtclmTms(tablename)){
	              return;		
			}
			
			var i = event.srcElement.parentElement.parentElement.rowIndex;
			var delRepairId = "";
			if(tablename.id=="fitTab"){
				document.getElementById("fitIndex").value--;
				
				// -------------------- 2010.10.14 旧件回收删除时序号调整 start
				var fitIndex = document.getElementById("fitIndex").value;
				var name = "autoFittingsList["+fitIndex+"].recycleSeqNo";
				if (fitIndex > 0) {
				  name = "autoFittingsList["+(fitIndex - 1)+"].recycleSeqNo";
				}
				var maxTblFitIndex = document.getElementById(name).value;
				document.getElementById("recycleFitIndex").value = parseInt(maxTblFitIndex) + 1;			
				// ------------------- 2010.10.14 旧件回收删除时序号调整 End
			}
			tablename.deleteRow(event.srcElement.parentElement.parentElement.rowIndex);
			
			if(tablename.id=="fitTab"){
				changeIndexStart(tablename,i,3);
				sumFittings(document.getElementById("autoFittingsList[0].srvyAmt"))
				
			}else if(tablename.id=="repairTab"){
				changeIndexStart(tablename,i,2);
				sumRepair(document.getElementById("autoRepairList[0].repairAmt"))
				document.getElementById("repairIndex").value--;
				
				//逻辑删除调整 shilk
				if(delRepairId != "" && parseInt(delRepairId)!=0){
					if(document.getElementById("deleteRepair").value == ""){
						document.getElementById("deleteRepair").value = delRepairId;
					}else{
						document.getElementById("deleteRepair").value += ","+delRepairId;
					}
				}
			}else if(tablename.id=="feeTab"){
				changeIndexStart(tablename,i,1);
				sumFee(document.getElementById("lossFeeList[0].feeAmt"));
				document.getElementById("lossFeeIndex").value--;
			}
		}
		
		
		function fittings_add(colorFlag){	
		//alert("sssssssssssssssssssssssssssssssss")
		   var inscde=inscded();
			var i = document.getElementById("fitIndex").value;
			if (i == null || parseInt(i) < 1) {
			  document.getElementById("recycleFitIndex").value=1;
			} else {
			  var maxTblFitIndex = document.getElementById("autoFittingsList["+(i-1)+"].recycleSeqNo").value;
			  if (maxTblFitIndex == null || maxTblFitIndex == "") {
			    document.getElementById("recycleFitIndex").value=parseInt(i)+ 1;
			  } else {
			    document.getElementById("recycleFitIndex").value=parseInt(maxTblFitIndex)+ 1;
			  }
			}
			var back_type=document.getElementById("dispatchVo.backType").value;
			
			var recycleFitIndex = document.getElementById("recycleFitIndex").value;
			var name = "autoFittingsList["+i+"].";
			R=fitTab.insertRow(fitTab.rows.length-1); 
			
			
			if(colorFlag=="0"){
			   R.className="newtitleTr";
			}else if(back_type=="0690001") {
			   R.className="AddTr";
			}else{
				R.className="titleTr";
			}
			 
			td=R.insertCell();                                                                            
			td.className = "editTd";     
			s = createSelect(name+'insCde',inscde,document.getElementById("dictIns").value,"notempty='true' msg='险种名称' Class='needInput' onchange='checkIns(this);'");
			td.innerHTML = s;   
			
			// 配件序号 （2010.06.17 Add start）
			td=R.insertCell();
			td.className = 'editTd';
			td.innerHTML = "<input type='text' class='readonlyInput' size='4' name='"+name+"recycleSeqNo' value='"+recycleFitIndex+"' readonly>";                           
			// 配件序号 （2010.06.17 Add end）
			
			 //配件编号
			td=R.insertCell();
			td.className = 'editTd';
			td.innerHTML = "<input type='text'class='editInput' size='10' maxlength='20' name='"+name+"iniFtnsCde' readonly>";  
			 
			 //配件名称   
			td=R.insertCell(); 
			td.className = 'editTd';
			s = "<input class='needInput' notempty='true' msg='配件名称' type='text' size='30' maxlength='60' name='"+name+"fittingsNme'><img src='../images/write.gif' alt='标准配件明细' onclick='detail()' style='cursor:pointer;'>";  
			s=s+"<input type='hidden' name='"+name+"fitType' value='0510002'><input type='hidden' name='"+name+"remark'>";
			td.innerHTML = s;  
			
			//专修价
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input class='editInput' type='text' size='5' readonly value=0 name='"+name+"refPrice1' >"; 
			
			//市场价
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input type='text' name='"+name+"refPrice2' size='5' class='editInput' readonly  value=0 >"; 
			
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			//if(colorFlag=="0"){
			//	td.innerHTML = "<input class='needInput' notempty='true' msg='定损价' type='text' size='2' value=0 name='"+name+"srvyAmt' onchange='sumFittings(this)'>"; 
			//}else{
			td.innerHTML = "<input class='needInput' notempty='true' msg='定损价格' type='text' size='2' value=0 name='"+name+"srvyAmt' onchange='sumFittings(this)'>"; 
			//}	
			
			//修理厂价格
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input class='readOnlyInput' type='text' size='2' value='0' name='"+name+"fitAmt' readonly>"; 
			
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input class='needInput' notempty='true' msg='定损数量' type='text' style='width:26px' value=1 maxlength='10' name='"+name+"piece' onchange='checkInt();sumFittings(this);warnCheckNum(this)'>"; 
			
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input class='needInput' notempty='true' msg='定损残值' type='text' style='width:26px' value=0 name='"+name+"srv' onchange='sumFittings(this)'>";                           
			                                                                                             
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			s = "<input class='editInput' type='text' size='3' value=0 name='"+name+"totalAmt' readonly>";
			s = s + "<input type='hidden' name='"+name+"firstAmt'>"; 
			s = s + "<input type='hidden' name='"+name+"level' value='0'>"; 
			s = s + "<input type='hidden' name='"+name+"recycleCount' value=''>";
			s = s + "<input type='hidden' name='"+name+"recycleResult' value=''>";
			s = s + "<input type='hidden' name='"+name+"recycleReason' value=''>";
			s = s + "<input type='hidden' name='"+name+"recycleDate' value=''>";
			s = s + "<input type='hidden' name='"+name+"recyclePrintId' value=''>";
			s = s + "<input type='hidden' name='"+name+"recycleFlag' value='0'>";
			
			s = s + "<input type='hidden' name='"+name+"fitNmeStyle' value='needInput'>"; 
			s = s + "<input type='hidden' name='"+name+"fitAmtStyle' value='needInput'>";
			s = s + "<input type='hidden' name='"+name+"fitPieceStyle' value='needInput'>";
			s = s + "<input type='hidden' name='"+name+"fitSrvStyle' value='needInput'>";
			
			s = s + "<input type='hidden' name='"+name+"survyAmt' value='0.0'>";
			s = s + "<input type='hidden' name='"+name+"amount' value='1'>";
			s = s + "<input type='hidden' name='"+name+"remainderAmt' value='0.0'>";
			
			s = s + "<input type='hidden' name='"+name+"partId' value=''>";		
			s = s + "<input type='hidden' name='"+name+"updateCde' value=''>";
			s = s + "<input type='hidden' name='"+name+"callbackFlagSave' value=''>";
			
			if(back_type=="0690001"){
				s = s + "<input type='hidden' name='"+name+"fitAllStyle' value='AddTr'>";
			}else {
				s = s + "<input type='hidden' name='"+name+"fitAllStyle' value='titleTr'>";
			}
			
			//新理赔 新增配件标识
			s = s + "<input type='hidden' name='"+name+"saveFlag' value='4000001'>";
			
			//配件来源 -- 1系统自定义
			s = s + "<input type='hidden' name='"+name+"fittSource' value='1'>";
			td.innerHTML = s;
			
			
			 //定损核价                                                                                            
			td=R.insertCell();                                                                            
			td.className = "editTd";                                                                             
			td.innerHTML = "<input class='editInput' type='text' name='"+name+"checkAmt' size='2' value=0 readonly>";          
			
			//核价数量
			td=R.insertCell();                                                                            
			td.className = "editTd";     
			td.innerHTML = "<input class='editInput'  type='text' name='"+name+"checkPiece' style='width:26px' value=1  value=0 readonly>";
			
			 
			 //残值核价                                                                                            
			td=R.insertCell();                                                                            
			td.className = "editTd";                                                                             
			td.innerHTML = "<input class='editInput'  type='text' name='"+name+"checkSrv' style='width:26px' value=0  value=0 readonly>";                   
			
			 
			//核价总额                                                                                            
			td=R.insertCell();                                                                            
			td.className = "editTd";                                                                             
			s = "<input class='editInput' type='text' name='"+name+"chktotAmt' size='3' value=0 readonly>";
			s+="<input type='hidden' name='"+name+"clmTms' value='"+document.getElementById('clmTms').value+"'>";
			td.innerHTML =s;
			
			
			td=R.insertCell();                                                                            
			td.className = 'editTd';
			td.innerHTML = "<input type='checkbox' name='"+name+"callBackFlag' title='回收' value='1' disabled='true' type='hidden'>";
			
			
			td=R.insertCell();                                                                            
			td.className = "editTd";                                                                             
			td.innerHTML = "<input type='button' style='height: 1.5em;'  value='删除' onclick='del_row(fitTab)' >"; 
			
			
			document.getElementById("fitIndex").value++;
			document.getElementById("recycleFitIndex").value++; 
	
			//alert(R.innerHTML)
		}
		
		function repair_add(){	
			var inscde=inscded();
			var i = document.getElementById("repairIndex").value;
			var serNo = 1;
			if(i > 0){
				 var maxTblFitIndex = document.getElementById("autoRepairList["+(i-1)+"].serialNo").value;
			  	 serNo=parseInt(maxTblFitIndex)+ 1;
			}
			var name = "autoRepairList["+i+"].";
			R=repairTab.insertRow(repairTab.rows.length-1); 
			
	
			R.className="titleTr"
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = createSelect(name+"insCde",inscde,document.getElementById("dictIns").value,"notempty='true' msg='险种名称' class='needInput' onchange='checkIns(this);'");
			tdd.innerHTML = s;  
								 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号' name='"+name+"serialNo' value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = "<input type='text' class='readonlyInput' msg='工时编号' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = s + "<input type='text' class='needInput' notempty='true' msg='修理名称' name='"+name+"repairNme' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='修理名称' name='"+name+"repairItemNme' size='50' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = "<input type='text' class='needInput' notempty='true' msg='工时费报价' value=0.0 name='"+name+"repairAmt' size='20' onchange='sumRepair(this)' >";
			s = s + "<input type='hidden' name='"+name+"firstAmt'>"; 
			tdd.innerHTML=s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s="<input type='text'  class='editInput' name='"+name+"checkAmt' value=0  size='20' maxlength='60' readonly>"; 
			s=s+"<input type='hidden' name='"+name+"clmTms' value='"+document.getElementById('clmTms').value+"'>";
			s=s+"<input type='hidden' name='"+name+"saveFlag' value='4000001'>";
			s=s+"<input type='hidden' name='"+name+"selfFlag' value='1'>";
			//工时来源 -- 1系统自定义
			s = s + "<input type='hidden' name='"+name+"repairSource' value='1'>";
			tdd.innerHTML=s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='button'  value='删除' onclick='del_row(repairTab)'>";
			document.getElementById("repairIndex").value++;
		}
		
		function fee_add(){	
		    var inscde=inscded();
			var i = document.getElementById("lossFeeIndex").value;
			var name = "lossFeeList["+i+"].";
			
			R=feeTab.insertRow(feeTab.rows.length-1); 
			
			R.className="titleTr"
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = createSelect(name+"insCde",inscde,document.getElementById("dictIns").value,"notempty='true' msg='险种名称' class='needInput' onchange='checkIns(this);'" );
			tdd.innerHTML = s;   
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = createSelect(name+"feeType","",document.getElementById("dictFeeType").value,"notempty='true' msg='费用类型' class='needInput' onchange='selectfeetype(this)'");
			s = s+ "<input type='hidden' name='"+name+"feeKind' value='"+getFieldValue("feeKind")+"'>"; 
			tdd.innerHTML=s; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = "<input type='text' class='needInput' notempty='true' msg='费用金额' name='"+name+"feeAmt' size='20' value=0 onchange='sumFee(this)'>";
			s = s + "<input type='hidden' name='"+name+"firstAmt'>"; 
			tdd.innerHTML=s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = "<input type='text' class='editInput' name='"+name+"checkFee' value=0 size='20' maxlength='60' readonly>"; 
		    s=s+"<input type='hidden' name='"+name+"clmTms' value='"+document.getElementById('clmTms').value+"'>";
			tdd.innerHTML= s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='button'  value='删除' onclick='del_row(feeTab)'>";
			
			document.getElementById("lossFeeIndex").value++;
		}
		
       function click_submit(method){				        
		    totalLossAmt();								    
		  	var operateFlag = document.getElementById("operateFlag").value;
		   	var factoryType=document.getElementById("vo.factoryType").value;
		   	
		   	var vhlNo = document.getElementById("vo.vhlFrm").value;
			var reg = /^[A-Z0-9]+$/;
			
	        /* REQ00025571--真实VIN码校验  add by limingyue 2016年10月08日14:32:12--Start
			//验证车架号格式
			if(!reg.test(vhlNo)){
				alert("车架号，仅允许录入大写英文字母、阿拉伯数字");
				return;
			}
			if(vhlNo.match(/^([0-9a-zA-Z])\1*$/) != null && vhlNo.length>=17){
				alert("车架号，不允许17位（含）以上连续相同数字或字母");
				return;
			}
	       	REQ00025571--真实VIN码校验  add by limingyue 2016年10月08日14:32:12--END */
			
			
			//<!-- 	2015/7/28修理厂组织机构代码证和第三者车辆承保公司名称做系统改造  成功   -->
			var va=getFieldValue("dptCde");
			var dptc=va.substr(0, 5);
			var dptd=va.substr(0,3);
			if(dptd=="221"){ 	
				if(dptc!='22102'){
					// REQ00021303 add by chenggong 2015-8-20 --辽宁三者车定损环节增加录入字段 -- 这里不做核价核损管控  
					if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"){
							//辽宁 改造 只做定损 管控
							if(document.getElementById("vo.backShopStructure").value==""){
				 				alert("辽宁机构，修理厂组织机构代码不能为空！");
						 		return;
							}
							if(getFieldValue("vo.autoFlag")=="0400002"){
								if(document.getElementById("vo.forceThirdCompany").value == ""){
						 			alert("辽宁机构交强险第三者车辆承保公司不能为空！");
						 			return;
						 		}
						 		if(document.getElementById("vo.businessThirdCompany").value == ""){
						 			alert("辽宁机构商业险第三者车辆承保公司不能为空！");
						 			return;
					 			}
							}
						}
												
					/* if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"){
						if(document.getElementById("vo.backShopStructure").value==""){
				 			alert("辽宁机构，修理厂组织机构代码不能为空！");
					 		return;
						}
// 						var btc = document.getElementById("btc");
// 				 		var ftc = document.getElementById("ftc");
// 				 		var startT=document.getElementById("dispatchVo.completeTm").value;
// 				 		if(ftc.checked){
					 		if(document.getElementById("vo.forceThirdCompany").value == ""){
					 			alert("辽宁机构交强险第三者车辆承保公司不能为空！");
					 			return;
					 		}
// 				 		}
// 				 		if(btc.checked){
				 			if(document.getElementById("vo.businessThirdCompany").value == ""){
					 			alert("辽宁机构商业险第三者车辆承保公司不能为空！");
					 			return;
					 		}
// 				 		}
					}else{
						//核价、核损提交管控
						var startT=document.getElementById("dispatchVo.completeTm").value;
						if(startT>"2015-08-08 00:00:00"){
							if(document.getElementById("vo.backShopStructure").value==""){
					 			alert("辽宁机构，修理厂组织机构代码不能为空！");
						 		return;
							}
						}
					} */
		 		}
			}
			
		   	
		  	if(operateFlag=="checkPrice"){
	       		/* if(document.getElementById("vo.chkManageRate").value=="" && factoryType!="0270004"){
		   			 alert("请输入核价管理费比率");
		   			 return;
		   		} */
	        	if( document.getElementById("checkLogVO.checkIdea").value==""){
	  	      		alert("核价说明不能为空");
	  	      		return;
			 	}
		  	    if(method=="submit"){
			  	    if( document.getElementById("checkLogVO.checkResult").value==""){
				  	    alert("请选择[核价意见]");
				  	    return;
				  	}      	
				  	/* }else if(ischeckPicUpReport()){//判断是否上报
			  	        if(!window.confirm("当前核价权限不够，是否上报？")){
			  	              return;
			  	         }else{
			  	             document.getElementById("upreportFlag").value="1"; 
			  	         }  */ 
			  	    /* }else if(fitAmtSame() > 0){
			  	    	if(document.getElementById("checkLogVO.checkResult").value == "0030001"){
			  	    		alert("配件定损金额与核价金额不一致，不能选择[同意]意见");
			  	    		return;
			  	    	}
			  	    } */
		  	   	}
		  	}		  	
		  	if(operateFlag=="checkLoss"){
		  	    if( document.getElementById("checkLogVO.checkIdea").value==""){
					alert("核损说明不能为空");
					return;
				}
		  	    if(method=="submit"){
			  	    if(document.getElementById("checkLogVO.checkResult").value==""){
						alert("请选择核损意见");
					    return;
					}else if((parseFloat(document.getElementById("vo.repairAmt").value)!=parseFloat(document.getElementById("vo.repChktotAmt").value)||parseFloat(document.getElementById("vo.feeAmt").value)!=parseFloat(document.getElementById("vo.feeChktotAmt").value))&&document.getElementById("checkLogVO.checkResult").value=="0030001"){
						alert("核损金额与定损金额不一致;核损意见为同意,不能提交！\r\n 你可以执行【强制通过核损金额】后再提交本案");
						return;
				  	}else if(document.getElementById("checkLogVO.checkResult").value!="0030001"){
				  	        if(!window.confirm("核损意见不同意，是否退回到定损！")){
				  	            return;
				  	        }
			  	    }else if(document.getElementById("checkPriceIdea").value !="0030001"){
				  	        if(!window.confirm("核价意见不同意，是否退回到定损！")){
				  	            return;
				  	        }
			  	    }else if((parseFloat(document.getElementById("vo.fitChktotAmt").value)+parseFloat(document.getElementById("vo.repChktotAmt").value)+parseFloat(document.getElementById("vo.feeChktotAmt").value)+parseFloat(document.getElementById("vo.chkManageAmt").value))>parseFloat(document.getElementById("checkLossTotalAmt").value)){
				  	    if(!window.confirm("当前核损权限不够，是否上报？")){
				  	        return;
				  	    }else{
				  	        document.getElementById("upreportFlag").value="1"; 
				  	    }
				  	}
				}
		  	}
		  			  	
		   //lixj 添加
		   	if(operateFlag=="survey"){
		   	    //都邦去除4S店录入管控且管理费比例不会为空 update by zhengyg 2014年4月12日 19:01:46
		   		/* if(document.getElementById("vo.manageRate").value=="" && factoryType!="0270004"){
		   			 alert("请输入定损管理费比率");
		   			 return;
		   		} */
		   		
		   		//删除的配件不管控
		   		if(insNullFlag()){
		   			alert("险种名称不允许为空！");
		   			return;
		   		}
		   	}
		   	
		   	if(operateFlag=="survey"){//本车车牌验证modify by licy 20091230
		       	var lonNoArr=getFieldValue("thrLonNoString").split(",");
		   		for(var i=0;i<lonNoArr.length;i++){  
		   			if(lonNoArr[i]==getFieldValue("vo.lcnNo") && getFieldValue("vo.lcnNo")!="无" ){
		       			if(getFieldValue("vo.autoFlag")=="0400001"){//三者车牌验证modify by licy 20091230
			  				alert("本车车牌号与三者任务中的车牌号不能相同\n本车车牌号不能与现场查勘中录入的三者车信息相同\n请修改");
			  				return;
			  			}
		       			
		       			if(getFieldValue("vo.autoFlag")=="0400002"){//三者车牌验证modify by licy 20091230
			  				alert("三者车任务中的车牌号之间不能相同\n三者车任务中的车牌号与本车任务中的车牌号不能相同\n三者车任务中的车牌号不能与保单车牌号相同\n请修改");
			  				return;
			  			}
	       				 
	       			}
	       			
	       		} 
	       		//校验本车和三者车的车架号信息一致
	       		for(var j=0;j<lonNoArr.length;j++){
	       			if(lonNoArr[j]==getFieldValue("vo.vhlFrm")){
	       				if(getFieldValue("vo.autoFlag")=="0400001"){//三者车牌验证modify by licy 20091230
			  				alert("本车车架号与三者任务中的车架号不能相同\n本车车架号不能与现场查勘中录入的三者车信息相同\n请修改");
			  				return;
			  			}
		       			if(getFieldValue("vo.autoFlag")=="0400002"){//三者车牌验证modify by licy 20091230
			  				alert("三者车任务中的车架号之间不能相同\n三者车任务中的车架号与本车任务中的车架号不能相同\n三者车任务中的车架号不能与保单车架号相同\n请修改");
			  				return;
			  			}
	       			}
	       		}
	       		var certiType = document.getElementById("vo.certiType").value
				if(""==certiType){
					alert("请选择驾驶员证件类型");
					return;
				}
				if(document.getElementById("vo.certiNumber").value==""){
					alert("请输入驾驶员证件号码");
					return;
				}
     			
		       	
		       	//REQ00024954--身份证号真实性校验  add by liuchun 2016年8月17日9:26:12
	       		if(method=="submit"){
		        	var validRes = cardValid(document.getElementById("caseNo").value,
		        							getFieldValue("dptCde"),
		        							"CARD_TYPE_DRIVER",
		        							document.getElementById("vo.driveNo").value,
		        							false);
					if(!validRes){//校验不通过
						return ;
					}
	       		}
	       		
	       		//REQ00025571--真实VIN码校验  add by limingyue 2016年10月08日14:32:12--Start
				/*REQ00026132-- VIN码规则校验用户体验升级 --update by lmy on 2016-11-16-end 	       		
	       		if(method=="submit"){
	       			var validRes = vinValid(document.getElementById("vo.vhlFrm").value)
	       		    if(!validRes){//校验不通过
						return ;
					}
	       		}
	       		 REQ00026132-- VIN码规则校验用户体验升级 --update by lmy on 2016-11-16-end*/
	       		//REQ00025571--真实VIN码校验  add by limingyue 2016年10月08日14:32:12--END
	        }
		   	
		   	//核损核价意见只要不是同意就去除相关限制
		   	if((operateFlag=="checkPrice" || operateFlag=="checkLoss") && document.getElementById("checkLogVO.checkResult").value !="0030001"){ 
		   	}else{
			  	if(document.getElementById("vo.autoFlag").value=="0400001"){//本车验证
			  	
			  		//单交强险案件，只有互碰自赔才可以提交本车信息
			  	   if(onlyForcePly()){
			  	   		if(!document.getElementById("claimVO.bumpFlag").checked){
				  	   		alert("该案件为单交强险案件，且不是互碰自赔案件，不允许保存本车定损信息！");
							return;
			  	   		}
				   }			   
			       if(vlidateAuto()){
			         return;
			       }			       
			  	}
			  	
			  	/* if(chekListIns()){
			  		alert("险种错误！只能选择【玻璃单独破碎】");
					return;
				} */
		   	}	   
 			  	
		  	if(method=="submit"){
		  		/*****************委托任务必须录入委托类型 shilk start*****************/
		  		//判断定损核价核损环节是否委托
		  		var devolveFlag = "";
		  		if(operateFlag=="survey"){		//定损
		  			devolveFlag = document.getElementById("dispatchVo.devolveFlag").value;
		  		}else if(operateFlag=="checkPrice"){	//核价
		  			devolveFlag = document.getElementById("dispatchVo.devolveCheckFlag").value;
		  		}else if(operateFlag=="checkLoss"){		//核损
		  			devolveFlag = document.getElementById("dispatchVo.devolveCheckLossFlag").value;
		  		}
		  			  		
				//核损核价意见只要不是同意就去除相关限制
			   	if((operateFlag=="checkPrice" || operateFlag=="checkLoss") && document.getElementById("checkLogVO.checkResult").value !="0030001"){ 
			   	}else{
				  	if(devolveFlag == "1"){	//若当前环节已委托
				  		if(document.getElementById("dispatchVo.devolveType").value == ""){
				  			alert("委托任务，请选择[委托类型]！");
				  			return;
				  		}
				  	}
				  	/*****************委托任务必须录入委托类型 shilk end*****************/			  				   				   				   	
				   	if(checkLcnRmk()){ //该车车牌号为无号，请录入补充车牌信息
				   		return;
				   	}
				   				   	
				    //如果损失部位没有一项被选中就返回
				    if(!checkAfoul()){
				   		return;
				    }
			   	}
			    
			   	if(document.getElementById("operateFlag").value=="survey"){
			 		if("1"==validatezero()){
			   			return;
			   		}
			   	}
		  	}

			//ShowMsg("正在进行操作，请稍候......");
			//去掉末尾空字符串+验证所有表单数据不允许全部为空+对前台提交表单的内容进行过滤(表单数据含有可能不安全的特殊符号或保留字)+输入框disabled和readOnly判断
		  	if(!validatorForm2()){
		  		//HiddenAllSelect(false);
				//document.getElementById('background').style.display = 'none';
				//document.getElementById('msgBox').style.display = 'none';
		  	 	return ; 
		  	}

		    document.getElementById("save").disabled=true;
		    document.getElementById("putin").disabled=true;
		    document.getElementById("abandbutton").disabled=true;	
		    
		  	var operateFlag = document.getElementById("operateFlag").value;
		  	document.getElementById("sysAction").value = method; 
		  	document.forms[0].target = "";
		  	document.forms[0].action="../survey/surveyAuto.do?mhd=commonSaveAuto";
		    //alert("保存成功");return;
			document.forms[0].submit();
		}
		
		function validatorForm2(){
			var repairFactory = document.getElementById("vo.repairFactory");//修理厂名称
			var factoryType = document.getElementById("vo.factoryType");//修理厂类型
			var vhlFrm = document.getElementById("vo.vhlFrm");//车架号			
			var lcnNo = document.getElementById("vo.lcnNo");//车牌号
			var driver = document.getElementById("vo.driver");//驾驶员姓名
			var driveNo = document.getElementById("vo.driveNo");//驾驶证号
			var fctNme = document.getElementById("vo.fctNme");//生产厂家
			var carNme = document.getElementById("vo.carNme");//车辆品牌
			var attachType = document.getElementById("vo.attachType");//所属性质
			var useType = document.getElementById("vo.useType");//使用性质			
			var lcnType = document.getElementById("vo.lcnType");//号牌种类
			var autoType = document.getElementById("vo.autoType");//交管车辆类型
			var devolveType = document.getElementById("dispatchVo.devolveType");//委托类型
			var caseFlow = document.getElementById("vo.caseFlow");//案件流程
			
			//校验是否为空
			var alertString = ""; 
			alertString += checkNull(repairFactory);
			alertString += checkNull(factoryType);
			alertString += checkNull(vhlFrm);
			alertString += checkNull(lcnNo);
			alertString += checkNull(driver);
			alertString += checkNull(driveNo);
			alertString += checkNull(fctNme);
			alertString += checkNull(carNme);
			alertString += checkNull(attachType);
			alertString += checkNull(useType);
			alertString += checkNull(lcnType);
			alertString += checkNull(autoType);
			alertString += checkNull(devolveType);
			alertString += checkNull(caseFlow);
			
			var hh = document.getElementById("lossFeeIndex").value;
			for(var k=0;k<hh;k++){
			  	alertString += checkNull(document.getElementById("lossFeeList["+k+"].insCde"));
			  	alertString += checkNull(document.getElementById("lossFeeList["+k+"].feeType"));
			  	alertString += checkNull(document.getElementById("lossFeeList["+k+"].feeAmt"));
			}
			
			
			//核损核价意见只要不是同意就去除相关限制
		   	if((document.getElementById("operateFlag").value =="checkPrice" || document.getElementById("operateFlag").value =="checkLoss") && document.getElementById("checkLogVO.checkResult").value !="0030001"){ 
		   	}else{
				if(alertString != ""){
					alert(alertString);
					return false;
				}
		   	}
			
			var boxObjs = document.getElementsByTagName("checkbox");
			for(var i=0; i<boxObjs.length; i++){ 
				setDisabledFalse(boxObjs[i]);
			}
			
			//放开禁用的数据
			setDisabledFalse("vo.repairFactory");
			setDisabledFalse("vo.factoryType");
			setDisabledFalse("vo.vhlFrm");
			setDisabledFalse("vo.lcnNo");
			setDisabledFalse("vo.driver");
			setDisabledFalse("vo.driveNo");
			setDisabledFalse("vo.fctNme");
			setDisabledFalse("vo.carNme");
			setDisabledFalse("vo.attachType");
			setDisabledFalse("vo.useType");
			setDisabledFalse("vo.lcnType");
			setDisabledFalse("vo.autoType");
			setDisabledFalse("dispatchVo.devolveType");
			setDisabledFalse("vo.caseFlow");
			
			
			setDisabledFalse("fullAuto");
			setDisabledFalse("foreside");
			setDisabledFalse("leftForeside");
			setDisabledFalse("rightForeside");
			setDisabledFalse("nearside");
			setDisabledFalse("starboard");
			setDisabledFalse("leftTail");
			setDisabledFalse("rigthTail");
			setDisabledFalse("foot");
			setDisabledFalse("top");
			setDisabledFalse("tail");
			setDisabledFalse("inside");
			
			setDisabledFalse("vo.engNo");
			setDisabledFalse("vo.drvOwner");
			setDisabledFalse("vo.lcnRmk");
			setDisabledFalse("vo.carSeries");
			setDisabledFalse("vo.brndNme");
			setDisabledFalse("vo.carTyp");
			setDisabledFalse("vo.prdYear");
			setDisabledFalse("vo.driveType");
			setDisabledFalse("vo.othForceAmt");
			setDisabledFalse("vo.lossAmt");
			setDisabledFalse("claimVO.bumpFlag");
			
			setDisabledFalse("vo.manageRate");
			setDisabledFalse("vo.manageAmt");
			setDisabledFalse("vo.fittingsAmt");
			setDisabledFalse("vo.chkManageRate");
			setDisabledFalse("vo.chkManageAmt");
			setDisabledFalse("vo.fitChktotAmt");
			setDisabledFalse("vo.repairAmt");
			setDisabledFalse("vo.repChktotAmt");
			setDisabledFalse("vo.feeAmt");
			setDisabledFalse("vo.feeChktotAmt");
			setDisabledFalse("vo.forcePlyno");
			setDisabledFalse("vo.forceCaseno");
			setDisabledFalse("vo.insureCom");
			setDisabledFalse("checkLogVO.checkIdea");
			setDisabledFalse("checkLogVO.checkResult");
			setDisabledFalse("checkPriceIdea");
			setDisabledFalse("checkPriceRemark");
			//<!-- 	2015/8/03修理厂组织机构代码证和第三者车辆承保公司名称做系统改造  成功   -->
			setDisabledFalse("vo.forceThirdCompany");
			setDisabledFalse("vo.businessThirdCompany");
			setDisabledFalse("vo.backShopStructure");
			
			//配件
			var jj=document.getElementById("fitIndex").value;
			for(var i=0;i<jj;i++){
			    setDisabledFalse("autoFittingsList["+i+"].insCde");
			   /*  setDisabledFalse("autoFittingsList["+i+"].recycleSeqNo");
			    setDisabledFalse("autoFittingsList["+i+"].iniFtnsCde");
			    setDisabledFalse("autoFittingsList["+i+"].fittingsNme");
			    setDisabledFalse("autoFittingsList["+i+"].refPrice1");
			    setDisabledFalse("autoFittingsList["+i+"].refPrice2");
			    setDisabledFalse("autoFittingsList["+i+"].srvyAmt");
			    setDisabledFalse("autoFittingsList["+i+"].fitAmt");
			    setDisabledFalse("autoFittingsList["+i+"].piece");
			    setDisabledFalse("autoFittingsList["+i+"].srv");
			    
			    setDisabledFalse("autoFittingsList["+i+"].checkAmt");
			    setDisabledFalse("autoFittingsList["+i+"].checkPiece");
			    setDisabledFalse("autoFittingsList["+i+"].checkSrv");
			    setDisabledFalse("autoFittingsList["+i+"].chktotAmt"); */
			}
			
			var ii=document.getElementById("repairIndex").value;
			for(var j=0;j<ii;j++){
			   	setDisabledFalse("autoRepairList["+j+"].insCde");
			   /* 	setDisabledFalse("autoRepairList["+j+"].serialNo");
			   	setDisabledFalse("autoRepairList["+j+"].jyRepairId");
			   	setDisabledFalse("autoRepairList["+j+"].repairNme");
			   	setDisabledFalse("autoRepairList["+j+"].repairItemNme");
			   	setDisabledFalse("autoRepairList["+j+"].repairAmt");
			   	setDisabledFalse("autoRepairList["+j+"].checkAmt"); */
			}
			for(var k=0;k<hh;k++){
			  	setDisabledFalse("lossFeeList["+k+"].insCde");
			  	setDisabledFalse("lossFeeList["+k+"].feeType");
			  	/* setDisabledFalse("lossFeeList["+k+"].feeAmt");
			  	setDisabledFalse("lossFeeList["+k+"].checkFee");
			  	setDisabledFalse("lossFeeList["+k+"].checkFee"); */
			}						
				
			return true;
		}
		
		function checkNull(obj){
			if(obj.notempty!=null && obj.notempty!=""){
				if(obj.notempty){				
					if(trim(obj.value) == null || trim(obj.value) == ""){
						return obj.msg + ":不能为空！\r\n";
					}
				}
			} 
			return "";
		}		
		
		function submitForm(i){
			var formobj = document.forms[i];
			for(var k = 0;k<formobj.elements.length;k++){ 
				var elem = formobj.elements[k];
				if(elem.type=="checkbox"||elem.type=="radio"||elem.type=="select-one" || elem.type=="text"){
					if(elem.disabled){ 
						setDisabledFalse(elem.name);
					}
					if(elem.readOnly){ 
						if(elem.name !="")
						setReadonlyFalse(elem.name);
					}
				}
			}
		}
		
		function setReadonlyFalse(name){
			if(document.getElementById(name).readOnly){ 
				document.getElementById(name).readOnly=false;
			}	
		}
		function setDisabledFalse(obj){
			if(document.getElementById(obj) == null || typeof(document.getElementById(obj))=='undefined'){
				return;
			}
			if(document.getElementById(obj).disabled){ 
				document.getElementById(obj).disabled=false;
			}
		}
		
		function getXMLHttpObj(){
			var axO=['Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.4.0','Msxml2.XMLHTTP.3.0', 'Msxml2.XMLHTTP', 'Microsoft.XMLHTTP'], i;
			for(i=0;i<axO.length;i++)
			try{
				return new ActiveXObject(axO[i]);
			}catch(e){}
			if(typeof(XMLHttpRequest)!='undefined')
				return new XMLHttpRequest();
			return null;
		}
		function selectcar(){
			url="../autoType/vhlList.do?mhd=toShow";
			window.showModalDialog(url,document,"dialogHeight:800px;dialogWidth:1000px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
		}
		function searchFactory(type){
			if(type == '0'){//上海保单
				url="../autoType/searchRepairDept.do?mhd=toShow";
				window.showModalDialog(url,document,"dialogHeight:800px;dialogWidth:1000px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
			}else if(type == '1'){//其他机构保单
				url="../repairFactory/factoryChooseAction.do?mhd=toRepairFactory";
				var result = showModalDialog(encodeURI(url),document,"dialogHeight:600px;dialogWidth:1000px;center:yes;resizable:no;status:no;toolbar:no;menubar:no;location:no");
				
				if(typeof(result)!='undefined' && result != ''){
					var factorys = new Array();
					factorys = result.split(",");
					//document.getElementById("vo.repairFactory").value = factorys[0];
					
					var factoryType =  document.getElementById("vo.factoryType");
					for(var i = 0; i<factoryType.length;i++) {
						if(factoryType.options[i].value == factorys[1]) {
							factoryType.selectedIndex = i;
							break;
						}
					}
				}
				//都邦去除4S店录入管控且管理费比例不会为空 update by zhengyg 2014年4月12日 19:01:46
				/* if(document.getElementById("vo.factoryType").value=="0270004"){
					document.getElementById("vo.manageRate").value="0";
					document.getElementById("vo.manageAmt").value="0.0";
					document.getElementById("vo.manageRate").readOnly=true;//
				}else{
					document.getElementById("vo.manageRate").readOnly=false;
				} */
			}
			
			//showFaild();//验证推修是否成功
		}
		
		function to_checkStat(obj){
			var prefixMark = getPrefixMark(obj);
			if(obj.value=="0030001"){
				document.getElementById(prefixMark+"checkAmt").value=document.getElementById(prefixMark+"srvyAmt").value;
				document.getElementById(prefixMark+"checkSrv").value=document.getElementById(prefixMark+"srv").value;
				setReadonlyTrue(prefixMark+"checkAmt");
				setReadonlyTrue(prefixMark+"checkSrv");
		 	}else{
		 		setReadonlyFalse(prefixMark+"checkAmt");
				setReadonlyFalse(prefixMark+"checkSrv");
		 	}	
		}
		function totalLossAmt(){
			var amt=parseFloat(getFieldValue("vo.fittingsAmt"))+parseFloat(getFieldValue("vo.repairAmt"))+parseFloat(getFieldValue("vo.feeAmt"));
			document.getElementById("vo.lossAmt").value=amt+parseFloat(getFieldValue("vo.manageAmt"));
		}
	 	function ischeckPicUpReport(){
	   	    var fitChktotAmt=document.getElementById("vo.fitChktotAmt").value;
	   	    var chekManageAmt=document.getElementById("vo.chkManageAmt").value;
	   	    var chkManageRate = document.getElementById("vo.chkManageRate").value;
	   	    var checkPicTotAmt=document.getElementById("checkPicTotalAmt").value;
	   	    var checkPicManageRate=document.getElementById("checkPicManageRate").value;//核价管理费比率
	   	    var checkPicCosAmt=document.getElementById("checkPicCosAmt").value;//自定义配件
	   	    var checkPicSignlAmt=document.getElementById("checkPicSignlAmt").value;//标准配件
	   	    var fitIndex=document.getElementById("fitIndex").value;	   	    	   	   
	   	    var chekPicAmt=0;
	   	    var cheseleAmt=0;
	   	    for(var i=0;i<fitIndex;i++){ 
	   	      if(document.getElementById("autoFittingsList["+i+"].fittSource").value=='1'){ //手机端案件默认按照自定义配件核价权限判断上报
	   	      	if(parseFloat(chekPicAmt)<parseFloat(document.getElementById("autoFittingsList["+i+"].checkAmt").value)){
		   	          chekPicAmt=document.getElementById("autoFittingsList["+i+"].checkAmt").value;
		   	      }
	   	      }else{ //pc理赔精友配件
		   	      if(document.getElementById("autoFittingsList["+i+"].fittype").value=='0510001'){//标准配件
			 	      if(parseFloat(cheseleAmt)<parseFloat(document.getElementById("autoFittingsList["+i+"].checkAmt").value)){
			   	          cheseleAmt=document.getElementById("autoFittingsList["+i+"].checkAmt").value;
			   	      }	
			   	  }else{//自定义配件
			   	      if(parseFloat(chekPicAmt)<parseFloat(document.getElementById("autoFittingsList["+i+"].checkAmt").value)){
			   	          chekPicAmt=document.getElementById("autoFittingsList["+i+"].checkAmt").value;
			   	      }
			   	  }    		   	      
	   	      } 
	   	    }
	   	    /* 
	   	    alert("parseFloat(fitChktotAmt)+parseFloat(chekManageAmt)："+parseFloat(fitChktotAmt)+parseFloat(chekManageAmt)+"=parseFloat(checkPicTotAmt)=："+parseFloat(checkPicTotAmt));
	   	    alert("=parseFloat(chekPicAmt)=："+parseFloat(chekPicAmt)+"=parseFloat(checkPicCosAmt):"+parseFloat(checkPicCosAmt));
	   	    alert("=parseFloat(cheseleAmt)=:"+parseFloat(cheseleAmt)+"=parseFloat(checkPicSignlAmt)=:"+parseFloat(checkPicSignlAmt));
	   	    alert("=parseFloat(chkManageRate)=:"+parseFloat(chkManageRate)+"=parseFloat(checkPicManageRate)=:"+parseFloat(checkPicManageRate));	   	    
	   	     */
	   	    //配件金额+管理费的有总额||配件金额大于自定义||标准配件大于标配
	   	   if(parseFloat(fitChktotAmt)+parseFloat(chekManageAmt)>parseFloat(checkPicTotAmt)
	   	   ||parseFloat(chekPicAmt)>parseFloat(checkPicCosAmt)
	   	   ||parseFloat(cheseleAmt)>parseFloat(checkPicSignlAmt)
	   	   || parseFloat(chkManageRate) > parseFloat(checkPicManageRate)){
	   	         return true;
	   	   }
	   	}
	   	
	   	function inscded(){
	   	  var inscde="";
	   	  var i = document.getElementById("fitIndex").value;
	   	  var k = document.getElementById("repairIndex").value;
	   	  var j = document.getElementById("lossFeeIndex").value;
	   	  if(i>0){
			   inscde=document.getElementById("autoFittingsList["+(i-1)+"].insCde").value;
		  }else if(k>0){
			   inscde=document.getElementById("autoRepairList["+(k-1)+"].insCde").value;
		  }else if(j>0){
			   inscde=document.getElementById("lossFeeList["+(j-1)+"].insCde").value;
		  }
		  return inscde;
	   	}
	   	
	   	function thirdBeiJing(){
	   	 	var obj = doc;
	   	  	var deptCde=obj.getElementById("deptId").value;
	   	  	var force = document.getElementById("vo.forcePlyno").value;
		  	var forceCaseNo = document.getElementById("vo.forceCaseno").value;
		  	var insurcCom = document.getElementById("vo.insureCom").value;
		  	setMoreProperty("vo.dvlvClm",false);
		  	var dvlvClm ="0";
		  	if(document.getElementsByName("vo.dvlvClm")[0].checked){
		  		dvlvClm = "1";
		  	}
		  	setMoreProperty("vo.dvlvClm",true);
		  	var bjcolltion = obj.all.item("claimVO.bjCollision").value;
	     	var str=deptCde.substr(0,2);
	     // alert("bjcolltion=["+bjcolltion+"]"+"autoFlag=["+document.getElementById("vo.autoFlag").value+"]"+"str=["+str+"]");
	      if(bjcolltion=="1"&&document.getElementById("vo.autoFlag").value=="0400002"&&str=="02"){
	        if(force==""){
	           alert("交强险保单号 不能为空");
	           return true;
	        }else if(forceCaseNo==""){
	           alert("交强险报案号 不能为空");
	           return true;  
	        }else if(insurcCom==""){
	           alert("交强险投保公司 不能为空");
	           return true;  
	        }else if(dvlvClm!="1"){
	           alert("委托索赔标志 必须为（是）");
	           return true;
	        }else{
	           return false;
	        }
	      }else{
	          return false;
	      }
	   	}
	   	
	   function vlidateAuto(){
		     if(document.all.item("vo.engNo").value==""){
		        alert("发动机号不能为空！");
		        return true;
		     }else if(document.all.item("vo.drvOwner").value==""){
		        alert("车主不能为空！");
		        return true;
		     }else if(document.all.item("vo.driveType").value==""){
		        alert("准驾车型不能为空！");
		        return true;
		     }else{
		       return false;
		     }
	   }
	   
	   function upropertMeth(parmart){//判断是在，定损，核价，核损退回后 再次定损
	       var flag=false;
	       if(parmart=="1"){//点击同意核价金额，定损金额复制核价金额
	           if(!window.confirm("确定此次操作吗？")){
	           	  return;
	           }
	           document.getElementById("vo.manageAmt").value=document.getElementById("vo.chkManageAmt").value;
	           document.getElementById("vo.manageRate").value=document.getElementById("vo.chkManageRate").value;
	           document.getElementById("vo.totalSrv").value=document.getElementById("vo.chkTotalSrv").value;
	          //REQ00029927--核价强制通过核价金额后定损残值和核价残值未更新--add by limingyue on 2017-8-16
	           var parm =  document.getElementById("fitIndex").value;
	           var totalSrv = 0 ;
	           //循环当前残值然后累加
	           for(var i=0;i<parseInt(parm);i++){
	             var checkSrv = parseInt(document.getElementById("autoFittingsList["+i+"].checkSrv").value); 
		  		 totalSrv += checkSrv;
	           }
	           document.getElementById("vo.totalSrv").value = totalSrv
	           document.getElementById("vo.chkTotalSrv").value = totalSrv;
	           upchechPriceBack(document.getElementById("fitIndex").value);
	           sumTotal();
	           flag=true;
	       }else if(parmart=="2"){//点击同意核损金额，定损金额复制核损金额
	       	   if(!window.confirm("确定此次操作吗？")){
	           	  return;
	           }
	           upcheckLossback1(document.getElementById("repairIndex").value);
	           upcheckLossback2(document.getElementById("lossFeeIndex").value);
	           sumTotal();
	           flag=true;
	       }else if(parmart=="3"){//点击同意定损金额，核价或核损复制定损金额
	       	   if(!window.confirm("确定此次操作吗？")){
	           	  return;
	           }

	           if(document.getElementById("upreportFlag").value=="2"){
	            document.getElementById("vo.chkManageAmt").value=document.getElementById("vo.manageAmt").value;
	            document.getElementById("vo.chkManageRate").value=document.getElementById("vo.manageRate").value;
	            document.getElementById("vo.chkTotalSrv").value=document.getElementById("vo.totalSrv").value;
	               upcheckPrice(document.getElementById("fitIndex").value);//配件
	               flag=true;
	           }else if(document.getElementById("upreportFlag").value=="3"){
	               upcheckLoss1(document.getElementById("repairIndex").value);//修理
	               upcheckLoss2(document.getElementById("lossFeeIndex").value);//费用  
	               flag=true;
	           }
	       }
	       return flag;
	   }
	   
	   function setCheckIdea(){
	   		var result = document.getElementById("checkLogVO.checkResult").value;
	   		var idea = document.getElementById("checkLogVO.checkIdea").value;
	   		
	   		if(result=="0030001"&&idea==""){
	   			document.getElementById("checkLogVO.checkIdea").value = "同意";
	   		}else if((result=="0030002"||result=="0030003")&&idea=="同意"){
	   			document.getElementById("checkLogVO.checkIdea").value = "";
	   		}
	   	}
	   	
	   	function abandon_submit(){
	   		if(!window.confirm("确定放弃本任务吗？")){
	   			return;
	   		}
	   	    submitForm(0);		
	   	   	document.forms[0].action="../survey/surveyAuto.do?mhd=toAhandon&sysAction=abandon";
			document.forms[0].submit();
	   	}	   	
		
	   	function vadtclmTms(tabname){//验证赔付次数，如果保单赔付次数不等于定损中的赔付次数不能删除
	   	    //alert(event.srcElement.parentElement.parentElement.rowIndex);
	   	    var stat=false;
	   		var idx=0
	   		//alert(tabname.id);
	   		var clmTm="";
	   		if(tabname.id=="fitTab"){
	   			idx=parseInt(event.srcElement.parentElement.parentElement.rowIndex)-3;
	   			clmTm = document.getElementById("autoFittingsList["+idx+"].clmTms").value;
	   		}else if(tabname.id=="repairTab"){
	   			idx=parseInt(event.srcElement.parentElement.parentElement.rowIndex)-2; 
	   			clmTm = document.getElementById("autoRepairList["+idx+"].clmTms").value;
	   		}else if(tabname.id=="feeTab"){
	   			idx=parseInt(event.srcElement.parentElement.parentElement.rowIndex)-1;
	   			clmTm = document.getElementById("lossFeeList["+idx+"].clmTms").value;
	   		}
	   		//alert("---clmTm--"+clmTm);
	   		//alert("---clmTms--"+document.getElementById("clmTms").value);
		    if(document.getElementById("clmTms").value!=clmTm){
		    	alert("不能删除当前记录!");
		    	stat=true;
		    }
		    return stat;
	   	}
	   	
	   	function select_one(obj){
			if(!obj.checked){
				//document.getElementById("checkAll").checked = false;
			}
			
			var prename=obj.name.substring(0,parseInt(obj.name.indexOf("."))+1);
			document.getElementById(prename+"level").value=document.getElementById("userCheckLossLevel").value;
		}
		function select_all(obj){
			var v = obj.checked;
			var sel = document.getElementById("fitIndex").value;
			var checkLosLevel=document.getElementById("userCheckLossLevel").value;//当前核损人的级别
			for(var i=0;i<sel;i++){			
				var fitlevel=document.getElementById("autoFittingsList["+i+"].level").value;//配件修改级别
				if (document.getElementById("autoFittingsList["+i+"].callBackFlag").disabled){
				   continue;
				}
				
				// 在定损的时如果是理算/核赔退回的任务且回收标志为回收，该任务不能修改或是删除
				if (fitlevel==""||fitlevel=="0"||parseInt(checkLosLevel)>=parseInt(fitlevel)) {
				  document.getElementById("autoFittingsList["+i+"].callBackFlag").checked=v;
				}
			}
		}
		
		function detail(obj){
		   var index=event.srcElement.parentElement.parentElement.rowIndex-3;
		   var parm=new Array();
		   parm[0]=document;
		   parm[1]=index;
		   var html = window.showModalDialog("../fittingsDail.jsp",parm,"dialogHeight:270px;dialogWidth:430px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
		   document.getElementById("autoFittingsList["+index+"].remark").value=html;
		}
		function autolistInit(){
			var indx = document.getElementById("fitIndex").value;
		    for(var i=0;i<indx;i++){
		    	var clmts = document.getElementById("autoFittingsList["+i+"].clmTms").value;
		    	if(clmts!=document.getElementById("clmTms").value){
		    		readonlyFitlist(i);   
		    	}    
		    }
			if(document.getElementById("vo.caseFlow").value==""){
				document.getElementById("vo.caseFlow").value=1490001;
			}
			
			displyLcnRmk();
			
			var operateFlag = getFieldValue("operateFlag");
		    var vehType = document.getElementById("vo.carTyp").value;
			var carTyp = "国产";// 车辆类型(1进口 2国产 3合资)
			if ("进口" == vehType || "进口车" == vehType) {
			   carTyp = "进口";
			} else if (vehType == null || "" == vehType) {
			   carTyp = "";
			}
			document.getElementById("vo.carTyp").value=carTyp;// 车辆类型
		}
		function readonlyFitlist(i){
			name="autoFittingsList["+i+"]."
			document.getElementById(name+"insCde").disabled=true;
			document.getElementById(name+"iniFtnsCde").readOnly=true;
			document.getElementById(name+"fittingsNme").readOnly=true;
			document.getElementById(name+"fitAmt").readOnly=true;
			document.getElementById(name+"fitMarketAmt").readOnly=true;
			document.getElementById(name+"srvyAmt").readOnly=true;
			document.getElementById(name+"piece").readOnly=true;
			document.getElementById(name+"srv").readOnly=true;
			document.getElementById(name+"checkAmt").readOnly=true;
			document.getElementById(name+"checkSrv").readOnly=true;
			document.getElementById(name+"callBackFlag").disabled=true;
		}
		
		function validatezero(){
			var flag="";
			if(document.getElementById("vo.lossAmt").value=="0"){
				if(window.confirm("定损金额为零，是否提交？")){
					flag="0";
				}else{
					flag="1";
				}
			}
			return flag;
		}	
			
		function selectfeetype(pama){return;//modify by hujl  2014-3-25　三者车定损不限制录入的费用只为施救费
		 if(document.getElementById("vo.autoFlag").value=="0400002"){
		   		if(pama.value!="0070201"){
		   			alert("费用类型只能选择[施救费]");
		   			pama.value="0070201";
		   			pama.options.selectedIndex=1;
		   		}
	   		}else if(document.getElementById("vo.autoFlag").value=="0400001"){//本车定损  add by liuchun 2015-4-19 12:52:06 商车费改需求增加
	   			//增加管控内容：0508产品下 本车定损任务  发动机涉水损失保险下 不能选择施救费
	   			var prodNo = document.getElementById("claimPolicyVO.prodNo").value;
	   			if("0508"==prodNo){
	   				//获取险别
	   				var prefix = pama.name.substring(0,pama.name.indexOf(".")+1);
	   				var insCde = document.getElementById(prefix+".insCde").value;
	   				if("030113"==insCde){//发动机涉水损失险
	   					if(pama.value=="0070201"){//施救费
	   						alert("发动机涉水损失险不能选择[施救费]");//
	   						pama.value="";
	   						pama.options.selectedIndex=0;
	   					}
	   				}
	   			}
			}
		}
		
		function quickClaim(actionFlag){
		
			//var win=window.dialogArguments;
			var parobj=doc;
			var accident=parobj.getElementById("claimVO.accidentSubcause").value;
			var otherTask=document.getElementById("otherTask").value;
			var url="";
			if(actionFlag=="submit"&&accident=="0100025"&&otherTask=="1"){//玻璃单独破碎
				//url="../survey/surveyAuto.do?mhd=editGlass";
				url="../survey/surveyAuto.do?mhd=commonSaveAuto";
			}else if(actionflag=="submit"&&otherTask=="2"){///快速一站式
				url="../survey/surveyAuto.do?mhd=editquick";
			}
			return url;
		}
		
		 function dispMessage(){
		    msg1.style.display = "";
		    msg1.innerHTML = "<table style=\'background:#cccccc;border:0px solid #003399;width:400;font:9pt arial;\' cellspacing=\'1\' cellpadding=\'0\' border=0><tr bgcolor=\'eeeeee\'><td align=\'center\'><br><b>Page is downloading ...... </b><br><br></td></tr></table>";
		    
		    return;
		  }
		  
		  function checkIns(obj){
		  	/* if(document.getElementById("vo.autoFlag").value=='0400001'&&doc.getElementById("claimVO.accidentSubcause").value=='0100025'&&obj.value!='030010'&&obj.value!='030004'){
		  		alert("只能选择【玻璃单独破碎】");
		  		obj.value="";
		  	} */
		  	
		  	//REQ00024334--理算带入车辆定损其他交强赔付金额计算改造 
		  	//add by liuchun 2016年6月28日13:39:39 无需页面再次计算其他交强险赔付金额
		  	//calOthForceAmt();
		  }
		  
		  function chekListIns(){
		 	var flag=false;
		  	if(document.getElementById("vo.autoFlag").value=='0400001' && doc.getElementById("claimVO.accidentSubcause").value=='0100025'){
			  	var fitI=document.getElementById("fitIndex").value;			  	
			  	var repairI=document.getElementById("repairIndex").value;
			  	var lossFeeI=document.getElementById("lossFeeIndex").value;
			  	
			  	for(var i=0;i<fitI;i++){
			  		if(document.getElementById("autoFittingsList["+i+"].insCde").value!='030010'&&document.getElementById("autoFittingsList["+i+"].insCde").value!='030004'){	  			
			  			document.getElementById("autoFittingsList["+i+"].insCde").value='';
			  			flag=true;
			  		}
			  		
			  	}
			  	for(var i=0;i<repairI;i++){
			  		if(document.getElementById("autoRepairList["+i+"].insCde").value != '030010' && document.getElementById("autoRepairList["+i+"].insCde").value != '030004'){
			  			document.getElementById("autoRepairList["+i+"].insCde").value='';
			  			flag=true;
			  		}
			  	
			  	}
			  	for(var i=0;i<lossFeeI;i++){
			  		if(document.getElementById("lossFeeList["+i+"].insCde").value!='030010'&&document.getElementById("lossFeeList["+i+"].insCde").value!='030004'){
			  			document.getElementById("lossFeeList["+i+"].insCde").value='';
			  			flag=true;
			  		}
		  		}
		  	}
		  
		  	return flag;
		  }
		  function tosurvey(){
			  var url="../survey/surveyEdit.do?mhd=initsurveySave&operateFlag=read&caseNo="+document.getElementById("caseNo").value;
			  window.open(url);
		  }
		 
		 function showImg(uploadFlag){
		    if(document.getElementById("vo.autoFlag").value=="0400001"){
	        	var platform="0700002";                 
	       	}else{
	       	    var platform="0700003";
	       	}
			var context = "<%=imgUrl%>";
			var caseNo=document.getElementById("vo.caseNo").value;
			var lcnNo=document.getElementById("vo.lcnNo").value;
			var engNo = document.getElementById("vo.engNo").value;
			var vhlFrm = document.getElementById("vo.vhlFrm").value;
			var userId = document.getElementById("userId").value;
			var userName = document.getElementById("userName").value;
			var deptId = document.getElementById("dptId").value;
			var deptName = document.getElementById("deptName").value;
			var uploadFlag=uploadFlag;
			if(lcnNo==null||lcnNo==""){
				alert("录入车牌号后，才可以增加图片");
				return;
			}
			displayInitImage(context,platform,uploadFlag,caseNo,lcnNo,engNo,vhlFrm,userId,userName,deptId,deptName);
		}
		 	
		function addcompate_onclick(){//图片对比
	   		var context = "<%=imgUrl%>";
	       	var caseNo = document.getElementById("vo.caseNo").value;
		   	var lcnNo = document.getElementById("vo.lcnNo").value;
		   	var engNo = document.getElementById("vo.engNo").value;
			var vhlFrm = document.getElementById("vo.vhlFrm").value;
			if(lcnNo==null||lcnNo==""){
				alert("录入车牌号后，才可以图片对比");
				return;
			}
	       	displayCompareImage(context,caseNo,lcnNo,engNo,vhlFrm);
	   	}
	   	
		function checkLcnRmk(){
			var flag=false;
			if(document.getElementById("vo.lcnNo").value=="无"){
				if(document.getElementById("vo.lcnRmk").value.trim()==""){
					alert("该车车牌号为无号，请录入补充车牌信息。");
					flag=true;
				}
			}
			return flag;
		}
		
		function displyLcnRmk(){
			
			if(doc.getElementById("claimVO.bumpFlag").value=="1"&&document.getElementById("vo.lcnNo").value=="无"){
				alert("该案件为互碰自赔案件，车牌号不可以输[无]");
				document.getElementById("vo.lcnNo").value="";
			}
			 if((doc.getElementById("claimVO.disposeDept").value=="0110005"||doc.getElementById("claimVO.disposeDept").value=="0110001")&&document.getElementById("vo.lcnNo").value=="无"){
				alert("当现场查勘的事故处理类型为:[当事人自行协商处理非互碰自赔案件]或是\n[当事人自行协商处理互碰自赔案件]时候!车牌号不能输入'无'");
				document.getElementById("vo.lcnNo").value="";
			}
			if(document.getElementById("vo.lcnNo").value=="无"){
				document.getElementById("lcnRmkTr").style.display="";
			}else{
				document.getElementById("lcnRmkTr").style.display="none";
			}
			
		}
		function checkAfoul(){
			var flag=false;
			var fullAuto=document.getElementById("fullAuto");//全车
			var foreside=document.getElementById("foreside");//前部
			var leftForeside=document.getElementById("leftForeside");//左前部
			var rightForeside=document.getElementById("rightForeside");//右前部
			var nearside=document.getElementById("nearside");//左侧
			var starboard=document.getElementById("starboard");//右侧
			var leftTail=document.getElementById("leftTail");//左后部
			var rigthTail=document.getElementById("rigthTail");//右后部
			var foot=document.getElementById("foot");//底部
			var top=document.getElementById("top");//顶部
			var tail=document.getElementById("tail");//尾部
			var inside=document.getElementById("inside");//内部
			if(fullAuto.checked||foreside.checked||leftForeside.checked||rightForeside.checked||nearside.checked||starboard.checked||leftTail.checked||rigthTail.checked||foot.checked||top.checked||tail.checked||inside.checked){
				flag=true;
			}else{
				alert("损失部位 必须选一项!");
			}
			return flag;
		}
	    function printRecycle(){//xuhui
		  var caseNo = getFieldValue("vo.caseNo");
		  var dispatchId = getFieldValue("vo.dispatchId");
		  var params = "&caseNo=" + caseNo;
		  params += "&dispatchId=" + dispatchId;
		  url = "../callback/PrintRecycle.do?mhd=toShow" + params;
		  window.open(url,'',"height=680px,width=1020px,alwaysRaised=yes,top=0,left=0,menubar=no,resizable=no,scrollbars=1");
		}
		
		function modifyObj(obj){//licy style modify
			var back_type=document.getElementById("dispatchVo.backType").value;
			var qname=obj.name.substring(0,parseInt(obj.name.indexOf("."))+1);//前缀
			var hname=obj.name.substring(parseInt(obj.name.indexOf("."))+1);//后缀
			
			if(back_type=="0690001"){
				if(isNaN(obj.value)){
					obj.className='modifyInput';
					document.getElementById(qname+"fitNmeStyle").value=obj.className
				}else{
					if(hname=="srvyAmt"){
						if(parseFloat(obj.value)>parseFloat(document.getElementById(qname+"survyAmt").value)){
							obj.className='addInput';
							document.getElementById(qname+"fitAmtStyle").value=obj.className;
						}else if(parseFloat(obj.value)<parseFloat(document.getElementById(qname+"survyAmt").value)){
							obj.className='subInput';
							document.getElementById(qname+"fitAmtStyle").value=obj.className;
						}else{
							obj.className='needInput';
							document.getElementById(qname+"fitAmtStyle").value="needInput";
						}
					}else if(hname=="piece"){
						if(parseFloat(obj.value)>parseFloat(document.getElementById(qname+"amount").value)){
							obj.className='addInput';
							document.getElementById(qname+"fitPieceStyle").value=obj.className;
						}else if(parseFloat(obj.value)<parseFloat(document.getElementById(qname+"amount").value)){
							obj.className='subInput';
							document.getElementById(qname+"fitPieceStyle").value=obj.className;
						}else{
							obj.className='needInput';
							document.getElementById(qname+"fitPieceStyle").value="needInput";
						}
					}else if(hname=="srv"){
						if(parseFloat(obj.value)>parseFloat(document.getElementById(qname+"remainderAmt").value)){
							obj.className='addInput';
							document.getElementById(qname+"fitSrvStyle").value=obj.className;
						}else if(parseFloat(obj.value)<parseFloat(document.getElementById(qname+"remainderAmt").value)){
							obj.className='subInput';
							document.getElementById(qname+"fitSrvStyle").value=obj.className;
						}else{
							obj.className='needInput';
							document.getElementById(qname+"fitSrvStyle").value="needInput";
						}
					}else if(obj.name=="vo.manageAmt"){
						if(parseFloat(getFieldValue("vo.manageAmt"))>parseFloat(getFieldValue("vo.surveyManageAmt"))){
							obj.className='addInput';
							document.getElementById(qname+"manageAmtStyle").value=obj.className;
						}else if(parseFloat(getFieldValue("vo.manageAmt"))<parseFloat(getFieldValue("vo.surveyManageAmt"))){
							obj.className='subInput';
							document.getElementById(qname+"manageAmtStyle").value=obj.className;
						}else{
							obj.className='needInput';
							document.getElementById(qname+"manageAmtStyle").value="needInput";
						}
					}
					
				}
			}	 
		}
		
		/*************************新影像系统调用 begin**************************/	 	  
		function transferImg(url,xml){
			var myForm = document.createElement("form") ; 
			myForm.method = "POST" ; 
			myForm.action = url ; 
			myForm.target = "_bank" ;
			var myInput = document.createElement("input") ; 
			myInput.setAttribute("type", "hidden") ;
			myInput.setAttribute("name", "xml") ; 
			myInput.setAttribute("id", "xml"); 
			myInput.setAttribute("value", xml);
			myForm.appendChild(myInput) ;
			document.body.appendChild(myForm) ; 
			myForm.submit(); 
			document.body.removeChild(myForm) ;
		}
		  
		  
	  	function addImg(){
			var platform = "" ;
			if(document.getElementById("vo.autoFlag").value == "0400001"){
	        	platform = "0700002" ;                 
	       	}else{
	       	    platform = "0700003" ;
	       	}
			var caseNo = document.getElementById("vo.caseNo").value ;
			var lcnNo = document.getElementById("vo.lcnNo").value ;
			var engNo = document.getElementById("vo.engNo").value ;
			var vhlFrm = document.getElementById("vo.vhlFrm").value ;
			var dispatchId = document.getElementById("dispatchId").value ;
			var dispatchIdByImg = document.getElementById("dispatchIdByImg").value ;
			var userId = document.getElementById("userId").value ;
			var userName = document.getElementById("userName").value ;
			var deptId = document.getElementById("dptId").value ;
			var deptName = document.getElementById("deptName").value ;
			var subtype = document.getElementById("dispatchVo.dispSubtype").value ;
			if(lcnNo == null || lcnNo == ""){
				alert("录入车牌号后，才可以增加图片") ;
				return ;
			}
	
			var xml = "<?xml version='1.0'?>" ;
			xml += "<root>" ;
			xml += "<BASE_DATA>" ;
				xml += "<APP_TYPE>CL</APP_TYPE>" ;
				xml += "<ORG_NUM>" + deptId + "</ORG_NUM>" ;
				xml += "<OP_USER>" + userName + "</OP_USER>" ;
				xml += "<OP_ID>" + userId + "</OP_ID>" ;
				xml += "<OP_RIGHT>" + platform + "</OP_RIGHT>" ;
				xml += "<OP_TYPE>0</OP_TYPE>" ;
			xml += "</BASE_DATA>" ;
			xml += "<META_DATA>" ;
				xml += "<APP_CODE>" + <%=App_Code%> + "</APP_CODE>" ;
				xml += "<INS_TYPE>" + <%=Ins_Type%> + "</INS_TYPE>" ;
				xml += "<BUSI_NUM>" + caseNo + "</BUSI_NUM>" ;
			xml += "</META_DATA>" ;
			
			xml += "<OTHER_DATA>" ; 
				xml += "<WRITEBACK_META_DATA>" ; 
				xml += "<CASE_NO ISPAGE='1'>" + caseNo + "</CASE_NO>" ;
				if(lcnNo != ''){
					xml += "<CAR_NO ISPAGE='1'>" + lcnNo + "</CAR_NO>" ;
				}
				if(vhlFrm != ''){
					xml += "<DRIVER_NO ISPAGE='1'>" + vhlFrm + "</DRIVER_NO>" ;
				}
				if(engNo != ''){
					xml += "<ENGINE_NO ISPAGE='1'>" + engNo + "</ENGINE_NO>" ;
				}
				xml += "</WRITEBACK_META_DATA>" ;	
			if(subtype=='0170003'){			//本车图片上传走 现场查勘ID 进行图片上传接口
				xml += "<BD TASK='" + dispatchIdByImg + "'>" + lcnNo + "</BD>" ;
			}else {							//三者车图片上传 保持正常不变
				xml += "<BD TASK='" + dispatchId + "'>" + lcnNo + "</BD>" ;
			}				
			xml += "</OTHER_DATA>" ;
			xml += "</root>" ;
			transferImg(<%=TransferImg_Add%>, xml) ;       
		}	  
		
		function compareImg(){
			var platform = "" ;
			if(document.getElementById("vo.autoFlag").value == "0400001"){
	        	platform = "0700002" ;                 
	       	}else{
	       	    platform = "0700003" ;
	       	}
	       	var caseNo = document.getElementById("vo.caseNo").value ;
		   	var lcnNo = document.getElementById("vo.lcnNo").value ;
		   	var engNo = document.getElementById("vo.engNo").value ;
			var vhlFrm = document.getElementById("vo.vhlFrm").value ;
			var userId = document.getElementById("userId").value ;
			var userName = document.getElementById("userName").value ;
			var deptId = document.getElementById("dptId").value ;
			var deptName = document.getElementById("deptName").value ;
			
			if(lcnNo == null || lcnNo == ""){
				alert("录入车牌号后，才可以图片对比") ;
				return ;
			}
			
			/*  新需求图片对比*/
			if(lcnNo =="*"){
				alert("车牌号为*号不允许图片对比!");
				return false;
			}
			var url = "../survey/surveyAuto.do?mhd=toimgContrastShow&caseNo="+caseNo+"&lcnNo="+lcnNo+"&platform="+platform;
			window.open(encodeURI(url),"z","height=560px,width=800px,alwaysRaised=yes,top=0,left=0,menubar=no,resizable=no,scrollbars=1");
			
			
			/*旧需求图片对比
			var xml = "<?xml version='1.0'?>" ;
			xml += "<root>" ;
			xml += "<BASE_DATA>" ;
				xml += "<APP_TYPE>CL</APP_TYPE>" ;
				xml += "<ORG_NUM>" + deptId + "</ORG_NUM>" ;
				xml += "<OP_USER>" + userName + "</OP_USER> ";
				xml += "<OP_ID>" + userId + "</OP_ID>" ;
				xml += "<OP_RIGHT>" + platform + "</OP_RIGHT>" ;
			xml += "</BASE_DATA>" ;
			xml += "<META_DATA BATCH_ID='001'>" ;
				xml += "<APP_CODE>" + <%=App_Code%> + "</APP_CODE>" ;
				xml += "<INS_TYPE>" + <%=Ins_Type%> + "</INS_TYPE>" ;
				xml += "<BUSI_NUM>" + caseNo + "</BUSI_NUM>" ;
			xml += "</META_DATA>" ;
			xml += "<META_DATA BATCH_ID='002'>" ;
				xml += "<APP_CODE>" + <%=App_Code%> + "</APP_CODE>" ;
				xml += "<INS_TYPE>" + <%=Ins_Type%> + "</INS_TYPE>" ;
				xml += "<CAR_NO>" + lcnNo + "</CAR_NO>" ;
			xml += "</META_DATA>" ;
			xml += "</root>" ;
			
			transferImg(<%=TransferImg_Compare%>, xml) ;*/
		}
		
		function showImg_new(){
			var platform = "" ;
		    if(document.getElementById("vo.autoFlag").value == "0400001"){
	        	platform = "0700002" ;                 
	       	}else{
	       	    platform = "0700003" ;
	       	}
			var caseNo = document.getElementById("vo.caseNo").value ;
			var lcnNo = document.getElementById("vo.lcnNo").value ;
			var engNo = document.getElementById("vo.engNo").value ;
			var vhlFrm = document.getElementById("vo.vhlFrm").value ;
			var userId = document.getElementById("userId").value ;
			var userName = document.getElementById("userName").value ;
			var deptId = document.getElementById("dptId").value ;
			var deptName = document.getElementById("deptName").value ;
			
			var xml = "<?xml version='1.0'?>" ;
			xml += "<root>" ;
			xml += "<BASE_DATA>" ;
				xml += "<APP_TYPE>CL</APP_TYPE>" ;
				xml += "<ORG_NUM>" + deptId + "</ORG_NUM>" ;
				xml += "<OP_USER>" + userName + "</OP_USER>" ;
				xml += "<OP_ID>" + userId + "</OP_ID>" ;
				xml += "<OP_RIGHT>" + platform + "</OP_RIGHT>" ;
			xml += "</BASE_DATA>" ;
			xml += "<META_DATA>" ;
				xml += "<APP_CODE>" + <%=App_Code%> + "</APP_CODE>" ;
				xml += "<INS_TYPE>" + <%=Ins_Type%> + "</INS_TYPE>" ;
				xml += "<BUSI_NUM>" + caseNo + "</BUSI_NUM>" ;
			xml += "</META_DATA>" ;
			xml += "</root>" ;
			
			transferImg(<%=TransferImg_Show%>, xml) ;			
		}
	/*************************新影像系统调用 end**************************/
	
	   function initServy() {
			var operateFlag = getFieldValue("operateFlag");
			if(operateFlag =="survey"){ // 等于查勘定损时
			  if (subDptCde(document.getElementById("dptCde").value, '1') || subDptCde(document.getElementById("dptCde").value, '2')){
			    /* document.getElementById("vo.repairFactory").readOnly=true; */
			    if (document.getElementById("selectV").disabled) {
			       document.getElementById("showSearchFactoryButton").innerHTML="<input type=\"button\" name=\"searchFactoryButton\" value=\"查询\" style=\"width:50\" onclick=\"searchFactory(0);\"/>";
			    } else {
			       document.getElementById("showSearchFactoryButton").innerHTML="<input type=\"button\" name=\"searchFactoryButton\" value=\"查询\" style=\"width:50\" onclick=\"searchFactory(0);\"/>";
			    }
			  }else{
			  	document.getElementById("vo.repairFactory").readOnly=false;
			    if (document.getElementById("selectV").disabled) {
			       document.getElementById("showSearchFactoryButton").innerHTML="<input type=\"button\" name=\"searchFactoryButton\" value=\"查询\" style=\"width:50\" onclick=\"searchFactory(1);\" disabled='true'/>";
			    } else {
			       document.getElementById("showSearchFactoryButton").innerHTML="<input type=\"button\" name=\"searchFactoryButton\" value=\"查询\" style=\"width:50\" onclick=\"searchFactory(1);\"/>";
			    }
			  }
			  
			  if(document.getElementById("vo.autoFlag").value == "0400001"){	//本车，才初始互碰自赔险别
			  	  if(document.getElementById("claimVO.bumpFlag").checked){
					  bumpChangeIns();	//单交强险时，初始险别
				  }
			  }
			}	
			
	   }
	   
		//推荐修理厂判断
		function showFaild() {
			//推荐修理厂判断  start
		  	var repairFactoryName = document.getElementById("repairOldFactory").value;
		  	var dispSubtype = document.getElementById("dispatchVo.dispSubtype").value;
	
			if(dispSubtype == "0170003") {
				if(repairFactoryName != "") {
			  		if(repairFactoryName!= getFieldValue("vo.repairFactory")) {
			  			//var url="../survey/surveyAuto.do?mhd=toFactoryMessage";
						//var result = showModalDialog(encodeURI(url),document,"dialogHeight:400px;dialogWidth:600px;center:yes;resizable:no;status:no;toolbar:no;menubar:no;location:no");
						///if(typeof(result) != 'undefined' && null != result && result != ''){
						//	obj.value = result;
						//}
						document.getElementById("showFaildRemark").style.display="block";
						document.getElementById("vo.ispushrepairFlag").value="1";
			  		} else {
			  			document.getElementById("vo.ispushrepairFlag").value="0";
			  			document.getElementById("showFaildRemark").style.display="none";
			  		}
			  	}
			}
		  	//推荐修理厂判断
		}
		
		//lixj 添加 判断比率输入
		function checkSurveyDgr(obj){
			var manageAmt=0;
	<%--		if(obj.value>100){--%>
	<%--			alert("定损管理费比率不能大于【100％】");--%>
	<%--			obj.value=100;--%>
			<%--if(obj.value>15){//modify by hujl 2012-8-30  调整管理费比率不能大于 15%
				alert("定损管理费比率不能大于【15％】");
				obj.value=15;
				manageAmt=parseFloat(document.getElementById("vo.fittingsAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.manageAmt").value=manageAmt.toFixed(2);
			}--%>
			if(obj.value<0){
				alert("定损管理费比率不能等于或小于【0%】");
				obj.value=0;
				manageAmt=parseFloat(document.getElementById("vo.fittingsAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.manageAmt").value=manageAmt.toFixed(2);
			}else{
				manageAmt=parseFloat(document.getElementById("vo.fittingsAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.manageAmt").value=manageAmt.toFixed(2);
			}
			sumTotal();
			modifyObj(document.getElementById("vo.manageAmt"));
		}
		function checkSurveyPoint(obj){
			if(!/^-?[0-9]*(\.\d*)?$|^-?d^(\.\d*)?$/.test(obj.value)){   
			     alert("无效的数字!");  
			    }  
			else
		 		{
			var	manageRate =0;
				if(obj.value<0){
				alert("定损管理费不能等于或小于【0】");
				obj.value=0;
				manageRate=parseFloat(parseFloat(obj.value)/document.getElementById("vo.fittingsAmt").value)*100;
				document.getElementById("vo.manageRate").value=manageRate.toFixed(2);
				}
				else{
				manageRate=parseFloat(parseFloat(obj.value)/document.getElementById("vo.fittingsAmt").value)*100;
				document.getElementById("vo.manageRate").value=manageRate.toFixed(2);
				}
			}
		}
		function checkPrice(obj){
			var chkManageAmt=0;
	<%--		if(obj.value>100){--%>
	<%--			alert("定损管理费比率不能大于【100％】");--%>
	<%--			obj.value=100;--%>
			<%--if(obj.value>100){//modify by hujl 2012-8-30  调整管理费比率不能大于 15%
				alert("定损管理费比率不能大于【15％】");
				obj.value=15;
				chkManageAmt=parseFloat(document.getElementById("vo.fitChktotAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.chkManageAmt").value=chkManageAmt.toFixed(2);
			}else --%>
			if(obj.value<0){
				alert("定损管理费比率不能等于或小于【0%】");
				obj.value=0;
				chkManageAmt=parseFloat(document.getElementById("vo.fitChktotAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.chkManageAmt").value=chkManageAmt.toFixed(2);
			}else{
				chkManageAmt=parseFloat(document.getElementById("vo.fitChktotAmt").value)*(parseFloat(obj.value)/100);
				document.getElementById("vo.chkManageAmt").value=chkManageAmt.toFixed(2);
			}
		}
		function checkManageRate(obj){
		    //都邦去除4S店录入管控且管理费比例不会为空 update by zhengyg 2014年4月12日 19:01:46
			/* if(obj.value=="0270004"){
				document.getElementById("vo.manageRate").value="0";
				document.getElementById("vo.manageAmt").value="0.0";
				document.getElementById("vo.chkManageRate").value="0";
				document.getElementById("vo.chkManageAmt").value="0.0";
				document.getElementById("vo.manageRate").readOnly=true;
				document.getElementById("vo.chkManageRate").readOnly=true;
			} */
			
			//else{
				var operateFlag = document.getElementById("operateFlag").value;
				if(operateFlag=="survey"){
					document.getElementById("vo.manageRate").readOnly=false;
				}else if(operateFlag=="checkPrice"){
					document.getElementById("vo.chkManageRate").readOnly=false;
				}
			//}
			
			totalLossAmt();
			
		}
		
		
		
		
		//swh 2012-12-1 add  判断快速流程必须要先进行现场查勘
		function check_FieldSurvey(){
			 
			var url="../survey/surveyAuto.do";
			
			var conntion="mhd=checkFieldSurvey&accidentSubcause="+doc.getElementById("claimVO.accidentSubcause").value;
			conntion += "&caseNo="+document.getElementById("caseNo").value;
			//alert(document.getElementById("vo.caseFlow").value);
			conntion += "&caseFlow="+document.getElementById("vo.caseFlow").value;
			
			request=new newXMLHttpRequest();
			request.open("post", url, true);
		
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange =rollback_FieldSurvey;
			request.send(conntion);
			
		}
		
		function rollback_FieldSurvey(){
			if (request.readyState == 4) {
				if (request.status == 200) {
					var response=request.responseText;
					 
					if(response =="-1"){
						alert("当前案件的出险类型不属于快速流程，不能选择快速流程！");
					}else if(response =="1"){
						alert("快速流程案件，现场查勘提交完成后，才可以提交本任务");
					}else if(response =="2"){
						alert("当前案件为快速流程案件,有除现场和本车外的其他任务，不能提交任务！");
					}else{
						click_submit('submit');
					
					}
				}
			}		
		}
		
		//验证三者车驾驶姓名只允许字母和中文
		function isCheckName(obj){
			var pattern =/[0-9]/;
			var reg =/^[\w\u4e00-\u9fa5]+$/g; 
			if(!reg.test(obj.value) || pattern.test(obj.value)){
				alert('姓名格式不符合规范，如姓名不详,请填"未知"');
				obj.value = "";
			}
		}
		
<%--		//事故责任定损及核损--%>
<%--		function changeNum(val){--%>
<%--		 	 var parmar ="";--%>
<%--			 if(val ==1){--%>
<%--		     	parmar= document.getElementById("defaultCaseDuty").value;--%>
<%--			 }else{--%>
<%--				parmar= document.getElementById("claimVO.caseDuty").value;--%>
<%--			 }--%>
<%--	--%>
<%--		     if(parmar =="0240001"){--%>
<%--		       document.getElementById("claimVO.dutyPercent").value="100";--%>
<%--		     }else if(parmar=="0240002"){--%>
<%--		       document.getElementById("claimVO.dutyPercent").value="70";--%>
<%--		     }else if(parmar=="0240003"){--%>
<%--		       document.getElementById("claimVO.dutyPercent").value="50";--%>
<%--		     }else if(parmar=="0240004"){--%>
<%--		       document.getElementById("claimVO.dutyPercent").value="30";--%>
<%--		     }else{--%>
<%--		    		if(parmar == "02401FF" && val==1){  //核损时，事故责任为：不确定时，设置事故责任为主责。--%>
<%--		     		document.getElementById("claimVO.caseDuty").value ="0240001";--%>
<%--		     		document.getElementById("claimVO.dutyPercent").value="100";--%>
<%--		     	}else{--%>
<%--		     		document.getElementById("claimVO.caseDuty").value ="0240005";--%>
<%--		        	document.getElementById("claimVO.dutyPercent").value="0";--%>
<%--		        }--%>
<%--		     }--%>
<%--	   }--%>

		
		/*******************************按需求修改 shilk 2013-09-02 12:16:23 start****************************************/
		function checkinquiry(){//调查申请
			var inquiryType = "";
			var flag=document.getElementById("operateFlag").value;
			if(flag=="checkPrice"){
				inquiryType="1480002";
			}else if(flag=="checkLoss"){
				inquiryType="1480003";
			}else{
				inquiryType="1480001";
			}
			//隐藏"caseNo","inquiryType"
			//inquiryType: 1480001 查勘，1480002 核价，1480003 核损，1480004 理算，1480005 核赔
			var parma=addinquiry(document.getElementById("caseNo").value,inquiryType);
			//if(parma=="1"){
			//	window.close();
			//}
		}
		
// 		function show_inquiry(){//疑案调查
// 			var url="../inquiry/dealinquiryedit.do?mhd=toView&caseNo="+document.getElementById("caseNo").value+"&sysAction=read";
// 			var openflag=document.getElementById("operateFlag").value;
// 			if(openflag=="checkLoss"){
			
// 				url+="&inquiryType=1480003";
				
// 			}else if(openflag=="checkPrice"){
			
// 				url+="&inquiryType=1480002";
				
// 			}else{
// 				url+="&inquiryType=1480001";
// 			}
			
// 			window.open(url);
// 		}
		
		//重案发起
		function to_CreateFMC(){
			var url = "";
			
		}
		
		//若配件数量大于3，则提示请审核
		function warnCheckFittingsNum(){
			 var warnNum = 3;		//设置警示配件数目，当配件数目大于此值时，才需要警示
			 var fitIndex = document.getElementById("fitIndex").value;
			 if (fitIndex == null) {
			     return null;
			 }
			 var checkFlg = false;	//是否需要提示
			 var checkString = "请审查以下配件数目：";	//提示语句
			 for (var i = 0; i < fitIndex; i++) {
			    var name = "autoFittingsList[" + i + "].";
			    var fittNum = parseInt(document.getElementById(name+"piece").value);
			    if(fittNum > 3){
			    	checkFlg = true;
			    	var fittName = document.getElementById(name+"fittingsNme").value;
			    	checkString += "\t 配件["+fittName+"]的定损数量为"+fittNum;
			    }
			 }
			 
			 if(checkFlg){
				alert(checkString);
			 }
		}
		
		//对于自定义配件，填写定损数量大于3，则提示
		function warnCheckNum(obj){
			var warnNum = 3;	//设置警示配件数目，当配件数目大于此值时，才需要警示
			if(obj.value > warnNum){
				var prefixMark = getPrefixMark(obj);
				var fitName = document.getElementById(prefixMark+"fittingsNme").value;
				alert("配件["+fitName+"]的定损数量大于"+warnNum+",请核查！");
			}
		}
		
		//修改配件和工时背景颜色
		function setJyBgColor(){
			//配件颜色
			var fittNum = parseInt(document.getElementById("fitIndex").value);
			if(fittNum > 0){
				for(var i=0;i<fittNum;i++){
					var fittPrefix = "autoFittingsList["+i+"].";
					var fittStat = document.getElementById(fittPrefix+"saveFlag").value;
					if(fittStat == "4000003"){
						var fittTrObj = document.getElementById(fittPrefix+"insCde").parentElement.parentElement;
						var fitChilds = fittTrObj.getElementsByTagName("input");
						for(var j=0;j<fitChilds.length;j++){
						        if(fitChilds[j].type == "text"){
								fitChilds[j].className = "readOnlyInput";	//元素置灰色
								fitChilds[j].readOnly = true;
							}
						}
						fittTrObj.style.backgroundColor="#CCC";	//删除行置灰色
					}else if(fittStat == "4000002"){
						document.getElementById(fittPrefix+"insCde").parentElement.parentElement.style.backgroundColor="#FFFFBB";	//已提交过的行置浅绿色
					}
				}
			}
			
			//工时颜色
			var repairNum = parseInt(document.getElementById("repairIndex").value);
			if(repairNum > 0){
				for(var i=0;i<repairNum;i++){
					var repairPrefix = "autoRepairList["+i+"].";
					var repairStat = document.getElementById(repairPrefix+"saveFlag").value;
					if(repairStat == "4000003"){
						var repairTrObj = document.getElementById(repairPrefix+"insCde").parentElement.parentElement;
						var repairChilds = repairTrObj.getElementsByTagName("input");
						for(var j=0;j<repairChilds.length;j++){
							if(repairChilds[j].type == "text"){
								repairChilds[j].className = "readOnlyInput";	//元素置灰色
								repairChilds[j].readOnly = true;
							}
						}
						repairTrObj.style.backgroundColor="#CCC";	//删除行置灰色
					}else if(repairStat == "4000002"){
						document.getElementById(repairPrefix+"insCde").parentElement.parentElement.style.backgroundColor="#FFFFBB";	//已提交过的行置浅绿色
					}
				}
			}
		}
		
		function openmajor(){//重案申请
			request = new newXMLHttpRequest();
			var caseNo = '${surveyAutoForm.caseNo}';
			var url = "../major/addmajor.do?";
			var param = "mhd=ajaxQueryInfo&caseNo=" + caseNo;
			request.open("POST",url,false);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange = majorObj;
		    request.send(param);
		}
		
		//重案上报回调函数
		function majorObj(){
			if (request.readyState == 4) {
				if (request.status == 200) {
					var htmlStr = request.responseText;
					var result = htmlStr.split('~');
					if(result[0] != "0180001"){	//案件主状态不是正常
						alert('案件在“'+ result[1] +'”环节，请先完成“'+ result[1] +'”操作，再进行重案上报操作！');
					} else {
						if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"){
							if(getFieldValue("vo.autoFlag")=="0400002"){
								var	bringType = "1750003";
							}else{
							    var	bringType = "1750002";
							}
						}
						 //隐藏"caseNo","bringType"
						 //bringType: 1750001 现场查勘，1750002 本车定损 1750003 三者车定损 1750004 财务定损 1750005 医疗查勘 
						var parma = addmajor(document.getElementById("caseNo").value,bringType);
						if(parma=="1"){//重案上报成功，关闭当前页面
							window.close();
						}
					}
				} else{
					alert("错误：\n操作失败，请联系系统管理员:\n" + request.status + ": " + request.statusText);
				}
			}
		}
		
		//重案调查
// 		function show_major(){	
// 			var url = "../major/majorEdit.do?mhd=toView&caseNo="+document.getElementById("caseNo").value+"&sysAction=read";
// 			window.open(url);
// 		}
		
		//资料收集
		function to_imageSys() {//影像资料
			var caseNo = document.getElementById("caseNo").value;
			var dispatchId=document.getElementById("dispatchId").value;
			var modelCode = getImgModel("survey"); //获取模块代码
			var lcnNo = document.getElementById("vo.lcnNo").value;   //车牌号
			var vhlFrm = document.getElementById("vo.vhlFrm").value;	//车架号
			var engNo = document.getElementById("vo.engNo").value;	//发动机号
			var lPPrivilege = "0"; //理赔特权标志，1-表示有特权，可以操作所有图片 0-表示无特权
			var seriesNo = document.getElementById("vo.tms").value;	//批次号
			
			var operateCode = "";
			if(document.getElementById("putin").disabled){
				operateCode = "R";
			}else{
				operateCode = "AD";
			}
			
			var operateFlag = getFieldValue("operateFlag");
			if(operateFlag == "checkPrice" || operateFlag == "checkLoss"){
				lPPrivilege = "1";	//核价核损有特权（可以查看 已删除的图片）
				operateCode = "R";
			}
			/**REQ00021718--影像类型系统支持自动扩展（理赔端） add lyd 2015-10-9 start **/
			if(lcnNo=="无"||lcnNo==""){
			 alert("请先录入车牌号后，再进入影像系统!");
			 return;
			}
			var carInfo="";
			var perInfo="";
			var autoFlag = document.getElementById("vo.autoFlag").value;   //0400002   三者车
			if(autoFlag=="0400002"){//三者车
				carInfo="1,"+lcnNo;  //本车：0;三者车：1;
			}else{//本车
				carInfo="0,"+lcnNo;
			}
			//参数：报案号，操作baseID，模块号，车牌号，车架号，发动机号，操作标志，理赔特权标志
			//dbimg_interface(caseNo,dispatchId,modelCode,lcnNo,vhlFrm,engNo,operateCode,lPPrivilege,seriesNo);
			dbimg_interface(caseNo,dispatchId,modelCode,lcnNo,vhlFrm,engNo,operateCode,lPPrivilege,seriesNo,carInfo,perInfo); //增加carInfo,perInfo参数   update by lyd 2015-10-9 
			/**REQ00021718--影像类型系统支持自动扩展（理赔端） add lyd 2015-10-9 end **/
		
		}
		
		//判断配件核价金额是否与定损金额一致（配件）
		function fitAmtSame(){
			var diffNum = 0;
			var fitIdx = parseInt(document.getElementById("fitIndex").value);
			if(fitIdx > 0){
				for(var i=0; i<fitIdx; i++){
					var prefix = "autoFittingsList["+i+"].";
					var surveyAmt = parseFloat(document.getElementById(prefix+"srvyAmt").value);	//定损单价
					var surveyPiece = parseFloat(document.getElementById(prefix+"piece").value);	//数量
					var surveySrv = parseFloat(document.getElementById(prefix+"srv").value);		//残值
					
					var checkAmt = parseFloat(document.getElementById(prefix+"checkAmt").value);		//核价单价
					var checkPiece = parseFloat(document.getElementById(prefix+"checkPiece").value);	//核价数量
					var checkSrv = parseFloat(document.getElementById(prefix+"checkSrv").value);		//核价残值
					
					if(surveyAmt != checkAmt || surveyPiece !=checkPiece || surveySrv!=checkSrv){
						diffNum++;
					}
				}
			}
			return diffNum;
		}
		
		
		//对于精友定损的配件和工时，不得在理赔系统中修改
		function initJyInfo(plyString){
			var disString = false;
			if(plyString == "none"){
				disString = true;
			}
			
			var fitIndex = parseInt(document.getElementById("fitIndex").value);
			var eleArray = new Array("fittingsNme","srvyAmt","piece","srv");
			for(var i=0; i<fitIndex; i++){
				var prefix = "autoFittingsList["+i+"].";
				document.getElementById(prefix+"insCde").disabled = disString;
				for(var j=0; j<eleArray.length; j++){
					document.getElementById(prefix+eleArray[j]).readOnly = disString;
				}
			}
			
			var repairIndex = parseInt(document.getElementById("repairIndex").value);
			var repairArray = new Array("repairItemNme","repairAmt");
			for(var i=0; i<repairIndex; i++){
				var prefix = "autoRepairList["+i+"].";
				document.getElementById(prefix+"insCde").disabled = disString;
				for(var j=0; j<repairArray.length; j++){
					document.getElementById(prefix+repairArray[j]).readOnly = disString;
				}
			}
		}
		
		//新增查勘费预付
		function add_feePrepay(){
			var caseNo = document.getElementById("caseNo").value;
			var url = "../survey/surveyEdit.do?mhd=&caseNo="+caseNo;
			request = new newXMLHttpRequest();
			var url = "../survey/surveyEdit.do?";
			var param = "mhd=addFeePrepay&caseNo="+caseNo;
			request.open("POST",url,false);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange = to_prepay;
		    request.send(param);
		}
		
		function to_prepay(){
			if (request.readyState == 4) {
				if (request.status == 200) {
					var xml=request.responseXML;
					var claimFee=xml.getElementsByTagName("prepay")[0];
					var case_no=claimFee.getElementsByTagName("caseNo")[0].firstChild.nodeValue;
					var flag = claimFee.getElementsByTagName("flag")[0].firstChild.nodeValue;
					var tsString = claimFee.getElementsByTagName("tsString")[0].firstChild.nodeValue;
					if(flag == "1"){
						var url="../prepay/dealprepayedit.do?mhd=toPrepayShow&stateFlag=caseStateWaitPrepay&caseNo="+case_no;
						window.open(url);
					}else{
						alert(tsString);
					}
				} else{
					alert("错误：\n操作失败，请联系系统管理员:\n" + request.status + ": " + request.statusText);
				}
			}
		}
		/*******************************按需求修改 shilk 2013-09-02 12:16:23 end****************************************/
		
		
		
		/**
		 * 车损信息提交时，判断险别是否可以为空
		 */
		 function insNullFlag(){
		 	var nullFlag = false;
		 	var fitIndex = parseInt(document.getElementById("fitIndex").value);
		 	if(fitIndex > 0){
		 		for(var i=0; i<fitIndex; i++){
		 			var prefix = "autoFittingsList["+i+"].";
		 			var saveFlag = document.getElementById(prefix+"saveFlag").value;
		 			if(saveFlag != "4000003"){
		 				if(document.getElementById(prefix+"insCde").value == "" || document.getElementById(prefix+"insCde").value == null){
		 					nullFlag = true;
		 					break;
		 				}
		 			}
		 		}
		 	}
		 	return nullFlag;
		 }
		 
		 function toBump(obj){//互碰自赔
			if(obj.checked==true){
				var subCase = doc.getElementById("claimVO.accidentSubcause").value;
				if(subCase != "0100001"){	//多车相撞
					alert("出险原因小类为[多车相撞]时，才可以选择互碰自赔！");
					obj.checked = false;
					return;
				}
				var url="../survey/surveyEdit.do?mhd=initBump&caseNo="+document.getElementById("caseNo").value;
				window.open(url);
			}
			
			if(obj.checked){
				bumpChangeIns();	//单交强险时，初始险别
			}
		}
		
		//是否单交强险案件
		function onlyForcePly(){
			var flag = false;
			var plyNos = document.getElementById("plyNos").value;
			if(plyNos != null && plyNos != ""){
				var plyArray = plyNos.split(",");
				if(plyArray.length == 1){
					for(var i=0; i<plyArray.length; i++){
						if(plyArray[i].substr(2,4) == "0590"){	//交强险
							flag = true;
							break;
						}
					}
				}
			}
			return flag;
		}
		
		//勾选互碰自赔，险别初始为交强险险别(只有针对单交强险案件，互碰自赔时调用)
		function bumpChangeIns(){
			var onlyForce = onlyForcePly();
			if(!onlyForce){
				return;
			}
			var bumpInsDict = document.getElementById("bumpDictIns").value; 	//互碰自赔险别
			
			//险别字典更换
			document.getElementById("dictIns").value = bumpInsDict;
		}
		//在系统改造 不用勾选 所以  不块代码用不了   add by chenggong 15.8.20
// 		<!-- 	2015/7/28修理厂组织机构代码证和第三者车辆承保公司名称做系统改造  成功   -->
// 		var ftc = document.getElementById("ftc");
// 		var va=getFieldValue("dptCde");
// 		var dptc=va.substr(0, 3);
// 		if(dptc=="221"){
// 			if(ftc.checked){
// 				document.getElementById("vo.forceThirdCompany").disabled=false;
// 				document.getElementById("vo.forceThirdCompany").className="needInput";
// 				document.getElementById("vo.forceThirdCompany").notempty=true;
// 			}else{
// 				document.getElementById("vo.forceThirdCompany").disabled=true;
// 				document.getElementById("vo.forceThirdCompany").className="editInput";
// 				document.getElementById("vo.forceThirdCompany").notempty=false;
// 			}
// 		}else{
// 			if(ftc.checked){
// 				document.getElementById("vo.forceThirdCompany").disabled=false;
// 			}else{
// 				document.getElementById("vo.forceThirdCompany").disabled=true;
// 			}
// 		}
// 		var btc = document.getElementById("btc");
// 		var va=getFieldValue("dptCde");
// 		var dptc=va.substr(0, 3);
// 		if(dptc=="221"){
// 			if(btc.checked){
// 				document.getElementById("vo.businessThirdCompany").disabled=false;
// 				document.getElementById("vo.businessThirdCompany").className="needInput";
// 				document.getElementById("vo.businessThirdCompany").notempty=true;
// 			}else{
// 				document.getElementById("vo.businessThirdCompany").disabled=true;
// 				document.getElementById("vo.businessThirdCompany").className="editInput";
// 				document.getElementById("vo.businessThirdCompany").notempty=false;
// 			}
// 		}else{
// 			if(btc.checked){
// 				document.getElementById("vo.businessThirdCompany").disabled=false;
// 			}else{
// 				document.getElementById("vo.businessThirdCompany").disabled=true;
// 			}
// 		}

	//任务分发器 - 本车和三者车核价、核损环节任务转发功能 add by zhangnn 2015-11-6 
	function to_forward(){
		var operateFlag = document.getElementById("operateFlag").value;
		request = new newXMLHttpRequest();
		var url = "../survey/surveyEdit.do?" ;
		var param = "mhd=checkEmpList&caseNo=" + document.getElementById("caseNo").value+"&dispatchId="+document.getElementById("dispatchId").value+"&operateFlag="+operateFlag;
		request.open("POST",url,true);
		request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
		request.send(param);
		request.onreadystatechange = receiveRs;
	}
	
	function receiveRs(){
			if (request.readyState == 4) {
				if (request.status == 200) {
					var html=request.responseText;
					if (parseInt(html) > 0) {
						var operateFlag = document.getElementById("operateFlag").value;
						var obj = window.showModalDialog("../survey/surveyEdit.do?mhd=toForward&caseNo=" + document.getElementById("caseNo").value+"&dispatchId="+document.getElementById("dispatchId").value+"&operateFlag="+operateFlag,"document,dialogHeight:700px;dialogWidth:1000px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
						if(obj == -1){ //转发成功则关闭当前页面
							window.close();
						}
					}else {
						alert("没有可以转发的人选！");
						window.returnValue = 1;
					}
				} else{
					alert("错误：\n" + request.status + ": " + request.statusText);
					window.returnValue = -1;
				}
			}
		}

		
		//打开免赔信息页面
		function openNonper(){
			var url="../directTrain/nonperEdit.do?mhd=initNonper&caseNo="+document.getElementById("caseNo").value+"&directChkFlag=1&dispatchId="+document.getElementById("dispatchId").value;
			var html = window.showModalDialog(url,document,"dialogHeight:800px;dialogWidth:1000px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
			//window.open(url);
			if(html != null){
				doDirectTrain();
			}
		}
		
		//执行直通车流程
		function doDirectTrain(){
			var doFlg = document.getElementById("nonDireFlag").value;
			if(doFlg == "1"){	//发起直通车流程
				document.getElementById("directTrainOpr").value = "2";
				click_submit('submit');
			}else if(doFlg == "2"){	//转入正常流程
				document.getElementById("claimVO.directTrainFlag").value = "0";
				document.getElementById("directTrainOpr").value = "0";
				document.getElementById("vo.othForceAmt").value = "0.00";
				click_submit('submit');
				
				//REQ00024334--理算带入车辆定损其他交强赔付金额计算改造
				//案件由直通车案件转为正常案件，则清空【无责代赔费】【本车其他交强险赔付】【三者车其他交强险赔付】
				changeNomalUpdate(document.getElementById("caseNo").value);
			}
		}
		
	   /**
		* 计算车损险的赔偿金额
		* 配件+修理工时+费用
		* shilk 2016-05-31
		*/
		function sumAutoInsAmt(){
			//配件部分
			var prefix = "autoFittingsList";
			var i=0;
			var name = prefix+"["+i+"].";
			insAmt = 0;
			while(document.getElementById(name+"insCde")!=null){
				if(document.getElementById(name+"saveFlag").value!="4000003"){	//非删除
					for(var j = 0; j <othInsCde.length ; j ++){
						if(othInsCde[j] == document.getElementById(name+"insCde").value){
							insAmt = insAmt + parseFloat(document.getElementById(name+"srvyAmt").value-document.getElementById(name+"srv").value);
						}
					}
				}
				
				i++;
				name =prefix+"["+i+"].";
			}
			
			//工时部分
			i=0;
			prefix = "autoRepairList";
			name = prefix+"["+i+"].";
			while(document.getElementById(name+"insCde")!=null){
				if(document.getElementById(name+"saveFlag").value!="4000003"){	//非删除
					for(var j = 0; j <othInsCde.length ; j ++){
						if(othInsCde[j] == document.getElementById(name+"insCde").value){
							insAmt = insAmt + parseFloat(document.getElementById(name+"repairAmt").value);
						}
					}
				}
				
				i++;
				name =prefix+"["+i+"].";
			}
			
			return parseFloat(insAmt);
		}
		
		/**
		 * 自动计算车损险其他交强险赔付金额
		 * 计算公式：min（车损金额,2000）
		 * 说明： 1 仅查勘定损时，计算其他交强险赔付 
		 *		2 全责时，其他交强险赔付为0
		 */
		 function calOthForceAmt(){
		 	if(operateFlag!="survey"){ // 不等于查勘时
		 		return;
		 	}
		 
		 	if(document.getElementById("vo.autoFlag").value=="0400001"){	//标的
		 		var caseduty = document.getElementById("claimVO.caseDuty").value;
		 		var autoLossAmt = 0;
		 		if(caseduty != "0240001"){	//非全责
		 			autoLossAmt = sumAutoInsAmt();
				 	if(autoLossAmt > 2000){
				 		autoLossAmt = 2000;
				 	}
		 		}
		 		document.getElementById("vo.othForceAmt").value=autoLossAmt;
			 	document.getElementById("vo.othForceAmt").readOnly = true;
		 	}
		 }
		/*AJAX javascript*/
		//add by wangzhilun
  		function checkCerti(){
  			request = new newXMLHttpRequest();	
  			certiType = document.getElementById("vo.certiType").value;
  			certiNumber = document.getElementById("vo.certiNumber").value;
  			if(""==certiNumber){
  				alert("请输入正确的证件类型！");
  				return;
  			}
  			if("117001"==certiType){
  				var url = "../survey/surveyEdit.do?";
				var param = "mhd=checkCerti&certiNumber=" + certiNumber;
				//alert(param);
				request.open("POST", url, true);
				request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
				request.onreadystatechange =updatecheckCerti;
	     		request.send(param);
  			}
  			
  				
  		}
  		function updatecheckCerti() {
			if (request.readyState == 4) {
				if (request.status == 200) {
					var flag=request.responseText;
					if (flag == "0") {
						alert("请输入正确的身份证号码！");
					}
				}
			}
		}
  		/*AJAX javascript*/
		
		
		function checkOtherForce(obj){
			var n_slfduty=obj.value;
			if (n_slfduty=="") obj.value=0;
			if (isNaN(n_slfduty)){//非数字
				alert("无效的数字");
				obj.value=0;
			}else{//数字
				var directFlag = document.getElementById("directFlag").value;//是否直通车案件标识
				if(directFlag=="1"){//直通车案件
					if(obj.value>2000){//其他交强险赔付金额大于2000
						alert("直通车案件其他交强险赔付金额不能大于2000，请确认");
						obj.value=0;
					}
				}
			}
			obj.value =Math.round( parseFloat(obj.value)* 100) / 100;
		}
		
	
	/*REQ00024306--直通车计算及移动查勘接口改造  add limingyue 2016-06-16-10:20---start*/
	function show_PayInfo(){
		var caseNo = document.getElementById("claimVO.caseNo").value;
		var directTrainFlag = document.getElementById("claimVO.directTrainFlag").checked ? "1":"0";
		var url = "../repairpay/repairPay.do?mhd=initPayInfoList&caseNo="+caseNo+"&directTrainFlag="+directTrainFlag;
		window.open(url,'_blank',"height=680px,width="+(window.screen.availWidth-30)+",alwaysRaised=yes,top=0,left=0,menubar=no,resizable=no,scrollbars=1");		
	}
	
	function isWaterFloodedChange()
	{
		var isWaterFlooded = document.getElementById("vo.isWaterFlooded").value;
		if(isWaterFlooded==1)
		{
			document.getElementById("vo.waterFloodedLevel").disabled = "";
				document.getElementById("vo.waterFloodedLevel").value = "1";
		}
		else
		{
			document.getElementById("vo.waterFloodedLevel").value = "";
			document.getElementById("vo.waterFloodedLevel").disabled = "disabled";
		}
	}
	/*REQ00024306--直通车计算及移动查勘接口改造  add limingyue 2016-06-16-10:20---end*/
	function setEdbicPrice(obj,index)
	{
	
	
		var operateFlag = document.getElementById("operateFlag").value;
		if(operateFlag=="survey")
		{
	   		var dbicPrice = obj.value;
			if(dbicPrice=="无"||dbicPrice=="")
			{
			}
			else
			{
				if(document.getElementById("autoFittingsList["+index+"].srvyAmt").value!=dbicPrice)
				{
					if (confirm("是否用历史价格覆盖定损价格")==true)
					{ 
		  				document.getElementById("vo.fittingsAmt").value = (parseFloat(document.getElementById("vo.fittingsAmt").value) + parseFloat(dbicPrice)-parseFloat(document.getElementById("autoFittingsList["+index+"].srvyAmt").value)).toFixed(2);
		  				document.getElementById("vo.lossAmt").value = (parseFloat(document.getElementById("vo.lossAmt").value) + parseFloat(dbicPrice)-parseFloat(document.getElementById("autoFittingsList["+index+"].srvyAmt").value)).toFixed(2);
		  				document.getElementById("autoFittingsList["+index+"].totalAmt").value = (parseFloat(document.getElementById("autoFittingsList["+index+"].totalAmt").value) + parseFloat(dbicPrice)-parseFloat(document.getElementById("autoFittingsList["+index+"].srvyAmt").value)).toFixed(2);
		  				
		  				
		  				document.getElementById("autoFittingsList["+index+"].srvyAmt").value = dbicPrice;
		  				
		 			}
		 			else
		 			{
		 				obj.options[0].selected = true;
		 			}
				}
			}
		}
	}
	
	function setCooperCheck(){
		//alert("1");
		//var a =document.getElementById("cooperCheck");
		if(document.getElementById("cooperCheck").checked){
			var url="../mobileSurveyJY/cooperateFactory.do?mhd=initAddList&flag=2&noTittleFlag=1&opt=1";
			var obj = window.showModalDialog(url,document,"dialogHeight:800px;dialogWidth:1400px;top=0,left=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
			if(null!=obj){
				document.getElementById("cooperFactoryCde").value=obj.cde;
				//document.getElementById("vo.repairFactory").value=obj.nme;
				document.getElementById("vo.factoryType").value=obj.factoryType;
				var operateFlag = document.getElementById("operateFlag").value;
					if(operateFlag=="survey"){
						document.getElementById("vo.manageRate").readOnly=false;
					}else if(operateFlag=="checkPrice"){
						document.getElementById("vo.chkManageRate").readOnly=false;
					}
				totalLossAmt();
				
				document.getElementById("vo.repairFactory").disabled="disabled";
				document.getElementById("vo.factoryType").disabled="disabled";
			} else{
				document.getElementById("cooperCheck").checked="";
			}
		}else{
				document.getElementById("cooperFactoryCde").value="";
				//document.getElementById("vo.repairFactory").value="";
				document.getElementById("vo.factoryType").value="";
				document.getElementById("vo.repairFactory").disabled="";
				document.getElementById("vo.factoryType").disabled="";
		}
	}
	var carInfoVhl;
	//调用配件系统
	function getFittings(caseNo){
			request=new newXMLHttpRequest();
			var url = "../survey/surveyAuto.do";
			var param = "mhd=getFittings&caseNo="+caseNo;
			request.open("POST", url, false);
			request.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
			request.onreadystatechange =fitting_String;
	    	request.send(param);
	}
	//返回拼接数据
	function fitting_String(){
			if (request.readyState == 4) {
				if (request.status == 200) {
					carInfoVhl=request.responseText;
					 
					alert(carInfoVhl);
					
				}
			}		
	}
	
	function fittings_adds(colorFlag){
		var callid =Math.random();
		//易星配件系统地址
		var carNo  = document.getElementById("vo.lcnNO").value;
		var caseNo  = document.getElementById("caseNo").value;
		var vinNo  = document.getElementById("vo.vhlFrm").value;
		var carType; 
		
		var u = "http://www.51clm.com:8112/survey/partSelect_main.do?";
		var ur;
		if(document.getElementById("vo.autoFlag").value== "0400001"){
			carType = "1";
			getFittings(caseNo);
			 ur = "carNo="+carNo+"&caseNo="+caseNo+"&vinNo="+vinNo+"&tempId="+callid+"&carType="+carType"&carInfo="+carInfoVhl;
			 alert(carInfoVhl);
		}else{
			carType = "2";
			 ur = "carNo="+carNo+"&caseNo="+caseNo+"&vinNo="+vinNo+"&tempId="+callid+"&carType="+carType;
		}
	
		var urls = u+ur;
			urls = encodeURI(urls);
			//urls = encodeURI(urls);
		//var urls = "http://www.51clm.com:8112/survey/partSelect_main.do?carNo=%E7%B2%A4A50909&caseNo=9385728783724234&vinNo=LSJDDJJDJD33JJJSA&tempId="+callid;
		window.showModalDialog(urls,document,"dialogHeight:2000px;dialogWidth:2000px;dialogTop=0,dialogLeft=0,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes , minimize:yes , maximize:yes");
		//window.open(urls,"newwindow","height=668,width=1024,top=0,left=0,toolbar=no,menubar=no,scrollbars=yes,resizable=no,location=no,status=yes ,minimize:yes , maximize:yes");
		addTable(callid);
		
	}

	
	function addTable(callid){
		var url = "http://www.51clm.com:8112/survey/partSelect_getSubmitInfo.do?tempId="+callid;
			request=getXMLHttpObj();
		
			request.open("post", url, true);

			request.onreadystatechange = states;
		
			request.send(null);
	}
	
	function states(){
	 		if (request.readyState == 4) {
				if (request.status == 200) {
				
					var s=request.responseText;	
					if(typeof(s)!='undefined' && s != ''){
						//alert(s);

						onbules(s);		
					}					 					
				} else{
					alert("system error,status is " + request.status);
				}
			}
	}
	//配件项id = fitTab
	function onbules(s){
		/* var fso, tf;

	fso = new ActiveXObject("Scripting.FileSystemObject");

	// 创建新文件

	tf = fso.CreateTextFile("d:\\testfile.txt", true);

	// 填写数据，并增加换行符

	tf.WriteLine(s) ;
	tf.Close();  */
		//json.partInfoList
		var jsonObj = new Function("return" + s)();//转换后的JSON对象  
		var ctrlCount = 0;
        //alert(jsonObj.partInfoList.length);
		//alert(jsonObj.partInfoList[1].partsName);
		//车辆信息
		
			document.getElementById("vo.carNme").value=jsonObj.obj.carInfo.brandName;// 车辆品牌
			document.getElementById("vo.prdYear").value=jsonObj.obj.carInfo.modelsYear;// 生产年份
	   		document.getElementById("vo.brndNme").value=jsonObj.obj.carInfo.modelSName;// 车辆型号
	   		document.getElementById("vo.carSeries").value=jsonObj.obj.carInfo.modelsGroup;// 车辆系列
	   		
	   		 document.getElementById("vo.vhlFrm").value=jsonObj.obj.carInfo.vin;// 车辆vin
	   		document.getElementById("vo.lcnNo").value=jsonObj.obj.carInfo.plateNo;// 车牌号
	   		document.getElementById("vo.engNo").value=jsonObj.obj.carInfo.vehicleEngineNo;// 发动机号 
	   			
	   		
	   	//修理产
	   		document.getElementById("cooperFactoryCde").value=jsonObj.obj.repairDepot.repairDepotName;
	   		
	   		document.getElementById("vo.repairFactory").value=jsonObj.obj.repairDepot.repairDepotName;// 修理厂名称
	   		document.getElementById("vo.backShopStructure").value=jsonObj.obj.repairDepot.repairDepotCode;// 修理厂代码
	   		
	 	
		//更换配件
		for (var i = 0; i < jsonObj.obj.partInfoList.length; i++) {
				//alert(i);
				fittings_add('0');  //加一行
						ctrlCount =  document.getElementById("fitIndex").value;  //列表行数
						ctrlCount = ctrlCount - 1;
						var strName = "autoFittingsList["+ctrlCount+"].";					
						document.getElementsByName(strName + "iniFtnsCde")[0].value = jsonObj.obj.partInfoList[i].partsNo;//零件编码
						//document.getElementsByName(strName + "insCde")[0].value = result[i].insCde;
						document.getElementsByName(strName + "fittingsNme")[0].value = jsonObj.obj.partInfoList[i].partsName;
						document.getElementsByName(strName + "refPrice2")[0].value = jsonObj.obj.partInfoList[i].partsPrice;//换件价格
						document.getElementsByName(strName + "piece")[0].value = jsonObj.obj.partInfoList[i].num;
						document.getElementsByName(strName + "fittingsNme")[0].readOnly = true;
						document.getElementsByName(strName + "totalAmt")[0].value = jsonObj.obj.partInfoList[i].partsFee;//换件小计
						document.getElementsByName(strName + "srvyAmt")[0].value = jsonObj.obj.partInfoList[i].partsPrice;
						
		}
		//维修费用
		for (var i = 0; i < jsonObj.obj.workHourList.length; i++) {
			var inscde=inscded();
			var repCount = document.getElementById("repairIndex").value;
			var serNo = 1;
			if(repCount > 0){
				 var maxTblFitIndex = document.getElementById("autoRepairList["+(repCount-1)+"].serialNo").value;
			  	 serNo=parseInt(maxTblFitIndex)+ 1;
			}
			var name = "autoRepairList["+repCount+"].";
			R=repairTab.insertRow(repairTab.rows.length-1); 
			
	
			R.className="titleTr"
			tdd=R.insertCell();  
			tdd.className = "editTd";
			s = createSelect(name+"insCde",inscde,document.getElementById("dictIns").value,"notempty='true' msg='险种名称' class='needInput' onchange='checkIns(this);'");
			tdd.innerHTML = s;  
								 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号' name='"+name+"serialNo' value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s = "<input type='text' class='readonlyInput' msg='工时编号' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = s + "<input type='text' class='needInput' notempty='true' msg='修理名称' value ='"+jsonObj.obj.workHourList[i].repairName+"' name='"+name+"repairNme' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='修理名称' value ='"+jsonObj.obj.workHourList[i].worktype+"' name='"+name+"repairItemNme' size='50' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='工时费报价' value ='"+jsonObj.obj.workHourList[i].workingHoursFee+"' name='"+name+"repairAmt' size='20' onchange='sumRepair(this)' >";
			s = s + "<input type='hidden' name='"+name+"firstAmt'>"; 
			tdd.innerHTML=s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			s="<input type='text'  class='editInput' name='"+name+"checkAmt' value=0  size='20' maxlength='60' readonly>"; 
			s=s+"<input type='hidden' name='"+name+"clmTms' value='"+document.getElementById('clmTms').value+"'>";
			s=s+"<input type='hidden' name='"+name+"saveFlag' value='4000001'>";
			s=s+"<input type='hidden' name='"+name+"selfFlag' value='1'>";
			//工时来源 -- 1系统自定义
			s = s + "<input type='hidden' name='"+name+"repairSource' value='1'>";
			tdd.innerHTML=s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='button'  value='删除' onclick='del_row(repairTab)'>";
			document.getElementById("repairIndex").value++;
		}
		//铺料费用
		for (var i = 0; i < jsonObj.obj.accessoriesInfoList.length; i++) {
			//var inscde=inscded();
			var accCount = document.getElementById("accessoriesIndex").value;
			var serNo = 1;
			/* if(accCount > 0){
				 var maxTblFitIndex = document.getElementById("accessoriesInfoList["+(accCount-1)+"].serialNo").value;
			  	 serNo=parseInt(maxTblFitIndex)+ 1;
			} */
			if(accCount>0){
				serNo=parseInt(accCount)+ 1;
			}
			var name = "accessoriesInfoList["+accCount+"].";
			R=accTab.insertRow(accTab.rows.length-1); 
			
	
			R.className="titleTr"
			 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号'  value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			//s = "<input type='text' class='readonlyInput' msg='辅料名称' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = "<input type='text' class='needInput' notempty='true' msg='辅料名称'  value ='"+jsonObj.obj.accessoriesInfoList[i].repairName+"' name='"+name+"repairName' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='辅料价格' value ='"+jsonObj.obj.accessoriesInfoList[i].accessoriesPrice+"' name='"+name+"accessoriesPrice' size='50' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='数量' value ='"+jsonObj.obj.accessoriesInfoList[i].num+"' name='"+name+"num' size='20'  >";
			
			tdd.innerHTML=s;
			s = "<input type='text' class='needInput' notempty='true' msg='辅料小计' value ='"+jsonObj.obj.accessoriesInfoList[i].accessoriesFee+"' name='"+name+"accessoriesFee' size='20'  >";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML=s;
			s = "<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML=s;
			
			document.getElementById("accessoriesIndex").value++; 
		}
		//风险评估
		for (var i = 0; i < jsonObj.obj.evaluateRiskInfo.riskInfo.length; i++) {
			var inscde=inscded();
			var risCount = document.getElementById("riskInfoIndex").value;
			var serNo = 1;
			if(risCount > 0){
				 //var maxTblFitIndex = document.getElementById("riskInfoList["+(risCount-1)+"].serialNo").value;
			  	 serNo=parseInt(risCount)+ 1;
			}
			var name = "riskInfoList["+risCount+"].";
			R=partTab.insertRow(partTab.rows.length); 
			
			R.className="titleTr";
			 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号'  value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			//s = "<input type='text' class='readonlyInput' msg='规则类型' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = "<input type='text' class='needInput' notempty='true' msg='规则类型' value ='"+jsonObj.obj.evaluateRiskInfo.riskInfo[i].riskType+"' name='"+name+"riskType' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='规则名称' value ='"+jsonObj.obj.evaluateRiskInfo.riskInfo[i].ruleName+"' name='"+name+"ruleName' size='20' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='风险类型' value ='"+jsonObj.obj.evaluateRiskInfo.riskInfo[i].classification+"' name='"+name+"classification' size='20'  >";
			
			tdd.innerHTML=s;
			s = "<input type='text' class='needInput' notempty='true' msg='风险描述' value ='"+jsonObj.obj.evaluateRiskInfo.riskInfo[i].riskDescription+"' name='"+name+"riskDescription' size='70'  >";
			//s = s+"<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			
			tdd.innerHTML=s;
			
			s = "<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML=s;
			
			document.getElementById("riskInfoIndex").value++;
		
		}
		//增加配件风险信息
		for (var i = 0; i < jsonObj.obj.evaluateRiskInfo.partsinfo.length; i++) {
			for(var j = 0 ; j< jsonObj.obj.evaluateRiskInfo.partsinfo[i].reqpartsinfo.length; j++){
			var inscde=inscded();
			var partsCount = document.getElementById("partsinfoIndex").value;
			var serNo = 1;
			if(partsCount > 0){
				 //var maxTblFitIndex = document.getElementById("riskInfoList["+(risCount-1)+"].serialNo").value;
			  	 serNo=parseInt(partsCount)+ 1;
			}
			var name = "partsInfoList["+partsCount+"].";
			R=partsTab.insertRow(partsTab.rows.length); 
			
			R.className="titleTr";
			 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号'  value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			//s = "<input type='text' class='readonlyInput' msg='规则类型' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = "<input type='text' class='needInput' notempty='true' msg='零件名称' value ='"+jsonObj.obj.evaluateRiskInfo.partsinfo[i].partsname+"' name='"+name+"partsName' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='零件编码' value ='"+jsonObj.obj.evaluateRiskInfo.partsinfo[i].partsno+"' name='"+name+"partsNo' size='20' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='零件价格' value ='"+jsonObj.obj.evaluateRiskInfo.partsinfo[i].partsprice+"' name='"+name+"partsPrice' size='20'  >";
			
			tdd.innerHTML=s;
			
			s = "<input type='text' class='needInput' notempty='true' msg='险别代码' value ='"+jsonObj.obj.evaluateRiskInfo.partsinfo[i].reqpartsinfo[j].riskcode+"' name='"+name+"riskCode' size='20'  >";
			//s = s+"<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			
			tdd.innerHTML=s;
			s = "<input type='text' class='needInput' notempty='true' msg='风险提示' value ='"+jsonObj.obj.evaluateRiskInfo.partsinfo[i].reqpartsinfo[j].riskcodeinfo+"' name='"+name+"riskCodeinfo' size='50'  >";
			//s = s+"<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			
			tdd.innerHTML=s;
			
			
			s = "<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML=s;
			
			document.getElementById("partsinfoIndex").value++;
			}
		} 
		
		//配件合计
		document.getElementById("vo.fittingsAmt").value=jsonObj.obj.totalInfo.partsAll;
 		//工时合计
		document.getElementById("vo.repairAmt").value=jsonObj.obj.totalInfo.workingHoursAll;
		//铺料合计
		document.getElementById("accessoriesAll").value=jsonObj.obj.totalInfo.accessoriesAll;
		//定损合计
		document.getElementById("vo.lossAmt").value=jsonObj.obj.totalInfo.feeAll;
		
	}
	
	function getFileTxt(){
	 	var fso, ts, s ; 
		var ForReading = 1; 
		fso = new ActiveXObject("Scripting.FileSystemObject"); 
		ts = fso.OpenTextFile("d:\\testfile.txt", ForReading); 
		//s = ts.ReadLine(); 
		s = ts.ReadAll(); 
		//document.getElementById("aa").innerHTML=s; 
		onbules(s);
 	}
 	//增加铺料列表
 	function accessories_add(){	
			/* var inscde=inscded();
			var i = document.getElementById("accessoriesIndex").value;
			var serNo = 1;
			if(i > 0){
				 var maxTblFitIndex = document.getElementById("accessoriesInfoList["+(i-1)+"].serialNo").value;
			  	 serNo=parseInt(maxTblFitIndex)+ 1;
			}
			var name = "accessoriesInfoList["+i+"].";
			R=accTab.insertRow(accTab.rows.length-1); 
			
	
			R.className="titleTr"
			 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号' name='"+name+"serialNo' value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			//s = "<input type='text' class='readonlyInput' msg='辅料名称' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = "<input type='text' class='needInput' notempty='true' msg='辅料名称' value ='' name='"+name+"repairName' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='辅料价格' value ='' name='"+name+"accessoriesPrice' size='50' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='数量' value ='' name='"+name+"Num' size='20'  >";
			
			tdd.innerHTML=s;
			s = "<input type='text' class='needInput' notempty='true' msg='辅料小计' value ='' name='"+name+"accessoriesFee' size='20'  >";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			
			tdd.innerHTML=s;
			
			document.getElementById("accessoriesIndex").value++; */
			
			var inscde=inscded();
			var i = document.getElementById("partIndex").value;
			var serNo = 1;
			if(i > 0){
				 var maxTblFitIndex = document.getElementById("partInfoList["+(i-1)+"].serialNo").value;
			  	 serNo=parseInt(maxTblFitIndex)+ 1;
			}
			var name = "partInfoList["+i+"].";
			R=partTab.insertRow(partTab.rows.length); 
			
			R.className="titleTr";
			 
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='readonlyInput' notempty='true' msg='序号' name='"+name+"serialNo' value="+serNo+" size='8' maxlength='50' readonly>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			//s = "<input type='text' class='readonlyInput' msg='规则类型' name='"+name+"jyRepairId' size='2' maxlength='50' style='display:none'>"; 
			s = "<input type='text' class='needInput' notempty='true' msg='规则类型' value ='' name='"+name+"riskType' size='20' maxlength='50'>";
			tdd.innerHTML = s;
			
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML="<input type='text' class='needInput' notempty='true' msg='规则名称' value ='' name='"+name+"ruleName' size='50' maxlength='50'>"; 
			
			tdd=R.insertCell(); 
			tdd.className = "editTd"; 
			s = "<input type='text' class='needInput' notempty='true' msg='风险类型' value ='' name='"+name+"classification' size='20'  >";
			
			tdd.innerHTML=s;
			s = "<input type='text' class='needInput' notempty='true' msg='风险描述' value ='' name='"+name+"riskDescription' size='50'  >";
			//s = s+"<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			
			tdd.innerHTML=s;
			
			s = "<td>&nbsp;<span><span><td>";
			tdd=R.insertCell(); 
			tdd.className = "editTd";
			tdd.innerHTML=s;
			
			document.getElementById("partIndex").value++;
		}

	</script>
</HEAD>
<style>
    .newtitleTr {background-color: #FFDAB9;}
    .clmtitleTr{background-color: #90EE90;}
    .AddTr{background-color: #0000ff;}
</style>
<body onload="msg1.style.display = 'none';init();autolistInit();initServy();FixPos();" onresize="if(isIE) FixPos();" onscroll="if(isIE) FixPos();" onbeforeunload="case_lock_fee();"  style="background-color: #FFFFFF">
	<div align='center' id='msg1' name='msg1' style='position: absolute;height: 251;width: 401;top: 300px;left: 280px;display:none'></div>
	<DIV id=background style="DISPLAY: none"></DIV>
		
	<!-- post/reply dialog -->
	<TABLE class=blkReply id=postbox style="DISPLAY: none" cellSpacing=2 bgColor=#ffffff>
	</TABLE>
	<!-- post/reply dialog end -->
	  
	<!-- message box -->
	<TABLE class=blkReply id=msgBox style="DISPLAY: none" cellSpacing=2 align=right bgColor=#ffffff>
		<TBODY>
			<TR>
				<TD style="PADDING-RIGHT: 1px; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; PADDING-TOP: 1px" width=460 bgColor=#6d91cd height=20>
					<DIV class=popupTitle onmousedown="MDown('msgBox',event)">消息提示</DIV>
				</TD>
			</TR>
			<TR>
				<TD class=lh19 style="PADDING-RIGHT: 20px; PADDING-LEFT: 20px; PADDING-BOTTOM: 5px; PADDING-TOP: 5px; TEXT-ALIGN: center" align=middle bgColor=#ffffff>
					<DIV id=alertPic>
						<IMG height=13 alt=alert src="../images/loading.gif" width=208 align=absMiddle>
						<BR>
						<BR>
						<SPAN id=msgBoxCon></SPAN>
					</DIV>
				</TD>
			</TR>
		</TBODY>
	</TABLE> 
<script language=javascript>
  dispMessage();
</script>
<div id="showmodeldiv" style="filter:alpha(opacity=50);position:absolute;top=0;left=0;width=1000;height=1000;background-color=#C3DAF9;display=none"><center><span style="position:relative;color:#000000"><br><br><br><br><br><br><br><br><br><br><img src="../images/loading.gif"><br><br><font color="#ff0000" size=6>请选择配件，选择完成后关闭配件窗口，然后继续操作该页面</font></span></center></div>  
	
<html:form method="post" action="/survey/surveyAuto">
<input type="hidden" name="fitIndex" value="0">
<input type="hidden" name="recycleFitIndex" value="1">
<input type="hidden" name="repairIndex" value="0">

<input type="hidden" name="accessoriesIndex" value="0">
<input type="hidden" name="riskInfoIndex" value="0">
<input type="hidden" name="partsinfoIndex" value="0">

<input type="hidden" name="lossFeeIndex" value="0">
<html:hidden  property = "clmTms"/>
<html:hidden  property = "plyNos"/>
<html:hidden  property = "upreportFlag"/>
<html:hidden  property = "otherTask"/>
<!-- 页面初始化时间 -->
<html:hidden property="pageInitTm"/>
<html:hidden property="topoolTm"/>
<html:hidden property="appointTm"/>
<!-- 页面初始化时间 -->
<!-- REQ00022141 - 新车险理赔系统--任务分发器需求--分机构上线 add by zhangnn 2016年7月26日 start -->
 <html:hidden property="isValidDpt"/>
 <!-- REQ00022141 - 新车险理赔系统--任务分发器需求--分机构上线 add by zhangnn 2016年7月26日 end -->
<input type="hidden" name="imgmoveUrl" value="<%= imgmoveUrl  %>"/>
<input type="hidden" name="mhd">
<html:hidden property="appointTm"/>
 <html:hidden property="cooperFactoryFlag"/> 
<TABLE width="970" border="0" cellspacing="1" cellpadding="2" class="mainTable">
    

	<tr class="titleTr">
		<td  width="15%" class="titleTd">修理厂名称:</td>
		<td  width="20%" class="editTd">
			<estar:text property="vo.repairFactory" maxlength="50" notempty="true" msg="修理厂名称"  styleClass="editInput" readonly="true"/>&nbsp;
			<span id="showSearchFactoryButton"></span><html:hidden property="repairOldFactory"/>
			<html:hidden property="vo.ispushrepairFlag"/>
			<input type="checkbox" name="cooperCheck"  id="cooperCheck" onclick="setCooperCheck();" />合作修理厂
			<html:hidden property="cooperFactoryCde"/>
		</td>
		<TD  width="15%" class="titleTd">修理厂类型:</TD>
		<TD  width="20%" class="editTd"><estar:select property="vo.factoryType" codeId="027" notempty="true" msg="修理厂类型" styleClass="needInput" onchange="checkManageRate(this)"/></TD>
		<td  width="10%" class="titleTd">车架号:</td>
		<td  width="20%" class="editTd">
<!-- 		<estar:text property="vo.vhlFrm" notempty="true" msg="车架号" maxlength="17" size="20" styleClass="needInput" onblur="checkVhlFrmNo(this)"/> -->
			<bean:define id="vhlFrmCheck" name="surveyAutoForm" property="vhlFrmCheck" type="java.lang.String"/>
			<!-- //REQ00022800--平台改造（三期）--add by sucg 2016-01-27 16:31:18 平台改造商改上线机构车驾号校验 1是上线机构 0是没有上线机构 start -->
			<%if(vhlFrmCheck.equals("0")) {%>
				<estar:text property="vo.vhlFrm" notempty="true" msg="车架号" maxlength="17" size="20" styleClass="needInput" onblur="checkVhlFrmNo(this)"/>
			<%}else{ %>
				<estar:text property="vo.vhlFrm" notempty="true" msg="车架号" maxlength="17" size="20" styleClass="needInput" onblur="vhlFrmCheck(this)"/>
			<%} %>
		<!-- //REQ00022800--平台改造（三期）-商改上线后机构验证车架号-add by sucg 2016-01-27 16:31:18  end -->
		</td>
	</tr>
	<!-- 	2015/7/25 修理厂组织机构代码证和第三者车辆承保公司名称做系统改造  成功   -->
	<tr class="titleTr">
		<td class="titleTd">修理厂组织机构代码:</td>
		<td class="editTd" id="backShopStructureText"><html:text property="vo.backShopStructure" value = ""  maxlength="17" size="20" styleClass="editInput"/></td>
		<td class="titleTd" id="forceThirdCompanyName"  style="display:none">
			交强险第三者<br/>车辆承保公司:
		</td>
		<td id="forceThirdCompanyText" style="display:none" >		
			<estar:nestedSelect property="vo.forceThirdCompany"  dictString="thirdCompany"  styleClass="editInput" style="width: 150px"/>
		</td>
		<td class="titleTd" id="businessThirdCompanyName"  style="display:none">
			商业险第三者<br/>车辆承保公司
		</td>
		<td id="businessThirdCompanyText"  style="display:none">		
			<estar:nestedSelect property="vo.businessThirdCompany" dictString="thirdCompany"  styleClass="editInput" style="width: 150px"/>
		</td>
<!-- 		改造 1、去除交强险第三者车辆承保公司和商业险第三者车辆承保公司勾选框-->
		<%-- <td class="titleTd">
			<html:checkbox property="ftc" onclick="clickFTC()">交强险第三者<br/>车辆承保公司:</html:checkbox>
		</td>
		<td>		
			<estar:nestedSelect property="vo.forceThirdCompany"  codeId="123"  styleClass="editInput" style="width: 150px"/>
		</td>
		<td class="titleTd">
			<html:checkbox property="btc" onclick="clickBTC()">商业险第三者<br/>车辆承保公司</html:checkbox>
		</td>
		<td>		
			<estar:nestedSelect property="vo.businessThirdCompany"  codeId="123"  styleClass="editInput" style="width: 150px"/>
		</td> --%>
	</tr>
	<tr class="titleTr">
		<td  class="titleTd">车牌号:</td>
		<td  class="editTd"><estar:text property="vo.lcnNo" notempty="true" msg="车牌号" maxlength="20" size="20" styleClass="needInput"  onblur="checkCarNo(this),displyLcnRmk()"/></td>
		<td  class="titleTd">发动机号:</td>
		<td  class="editTd"><html:text property="vo.engNo"  maxlength="20"  size="20" styleClass="editInput"/></td>
		<td  class="titleTd">车主:</td>
		<td  class="editTd"><html:text property="vo.drvOwner"  maxlength="20" size="20" styleClass="needInput"/></td>
	</tr>
	<tr class="titleTr" id="lcnRmkTr" style="display: inline">
		<td width="15%" class="titleTd"><nobr>补充车牌信息:</nobr></td>
		<td class="editTd" colspan="5"><html:text property="vo.lcnRmk" maxlength="255" size="160" styleClass="needInput"/></td>
	</tr>
	<tr class="titleTr">
		<td  class="titleTd">驾驶员姓名:</td>
		<td  class="editTd"><estar:text property="vo.driver" notempty="true" msg="驾驶员姓名"   maxlength="20" size="20" styleClass="needInput"  onblur="isCheckName(this)"/></td>
		<td  class="titleTd">驾驶证号:</td>
		<td  class="editTd">
			<!-- //REQ00024954--身份证号真实性校验 add by liuchun 2016年8月17日9:33:28 -->
			<%-- <estar:text property="vo.driveNo" notempty="true" msg="驾驶证号"   maxlength="18" size="20" styleClass="needInput" onblur="cheakDriveNoMB(this);"/> --%>
			<estar:text property="vo.driveNo" notempty="true" msg="驾驶证号"   maxlength="18" size="20" styleClass="needInput" />
		</td>
		<td  class="titleTd">准驾车型:</td>
		<td  class="editTd"><estar:select property="vo.driveType" codeId="012" styleClass="needInput"/></td>
	</tr>
	<tr class="titletr">
		<td class="titleTd"> 驾驶员证件类型：</td>
		<td  class="editTd"><estar:select property="vo.certiType" codeId="117" styleClass="needInput"/></td>
		<td class="titleTd"> 驾驶员证件号码：</td>
		<td  class="editTd"><html:text property="vo.certiNumber" styleClass="needInput" onblur="checkCerti()"/></td>
	</tr>
	<!--  
	<logic:equal value="1" name="surveyAutoForm" property="dptFlag">
		<tr class="titleTr">
			<td  class="titleTd">电话号码:</td>
			<td  class="editTd"><estar:text property="phone"   notempty="true" msg="电话号码" maxlength="20" size="20" styleClass="needInput" /></td>
			<td  class="titleTd" >保险期限:</td>
			<td  class="editTd" ><estar:text property="insuredate"  notempty="true" msg="保险期限" maxlength="20" size="20" styleClass="needInput" /></td>
			<td colspan="2"></td>
		</tr>
	</logic:equal>
	-->
	<tr class="titleTr">
		<td  class="titleTd">生产厂家:</td>
		<td class="editTd">
			<estar:text property="vo.fctNme" notempty="true" msg="生产厂家" readonly="true" styleClass="editInput"/>
		    <!-- html:hidden property="vo.fctCde"/ -->
			<input type="button" id="selectV" name="selectV" value="V" style="width:30" onclick="selectcar()"/>
		</td>
		<td  class="titleTd">车辆品牌:</td>
		<td  class="editTd">
			<estar:text property="vo.carNme" maxlength="60" size="20" msg="车辆品牌" notempty="true" readonly="true" styleClass="editInput"/>
		</td>
		<td  class="titleTd">车型系列:</td>
		<td  class="editTd">
			<html:text property="vo.carSeries" maxlength="60" size="20"  readonly="true" styleClass="editInput"/>
		</td>
	</tr>
	<tr class="titleTr">
		<td class="titleTd">车辆型号:</td>
		<td class="editTd">
			<html:text property="vo.brndNme" maxlength="60" size="20"  readonly="true" styleClass="editInput"/>
			<html:hidden property="vo.brndCde"/>
		</td>
		
	<td class="titleTd">车辆类型:</td>
		<td class="editTd">
			<html:text property="vo.carTyp" maxlength="60" size="20"  readonly="true" styleClass="editInput"/>
		</td>
		<td class="titleTd">生产年份:</td>
		<td class="editTd"><html:text property="vo.prdYear" size="20"  readonly="true" styleClass="editInput"/>
		</td>
		</tr>
	<tr class="titleTr" style="display: none;">
	<td class="titleTd">所属性质:</td>
		 <td class="editTd"><estar:select property="vo.attachType" codeId="338"  msg="所属性质" styleClass="editInput"/></td>
		 <td class="titleTd"> 使用性质:</td>
		 <td class="editTd" colspan="3"><estar:select property="vo.useType"  msg="使用性质" codeId="336" styleClass="editInput" /></td>
	 </tr>
	<tr class="titleTr">
	    <td class="titleTd">号牌种类:</td>
        <td class="editTd">
		<bean:define id="dptCde" name="surveyAutoForm" property="dptCde" type="java.lang.String"/>
			<%if(dptCde==null || dptCde.equals("")){ %>
			     <estar:select property="vo.lcnType" codeId="071" styleClass="needInput" notempty="true" msg="号牌种类"/>
			<%}else if(DptUtils.getDptCdeByBySubDptCde(dptCde,"1")){ %>
			     <estar:select property="vo.lcnType" codeId="071" styleClass="needInput" notempty="true" msg="号牌种类"/>
			<% }else if(DptUtils.getDptCdeByBySubDptCde(dptCde,"2")){%>
			 	<estar:select property="vo.lcnType" codeId="162" styleClass="needInput" notempty="true" msg="号牌种类"/>
			<% }else{%>
				<estar:select property="vo.lcnType" codeId="071" styleClass="needInput" notempty="true" msg="号牌种类"/>
			<%} %>
		</td>
		<td class="titleTd" width="15%">其它交强险赔偿金额:</td>
		<td class="editTd">
			<!-- REQ00024334--理算带入车辆定损其他交强赔付金额计算改造 modify by liuchun 2016年6月28日13:49:06 -->
			<logic:equal name="surveyAutoForm" property="otherForceMustFlag" value="1">
				<estar:text property="vo.othForceAmt" size="10" styleClass="needInput" notempty="true" msg="其他交强险赔偿金额" onchange="checkNum(this);"/>
			</logic:equal>
			<logic:notEqual name="surveyAutoForm" property="otherForceMustFlag" value="1">
				<logic:equal name="surveyAutoForm" property="directFlag"  value="1">
					<!-- 直通车案件 -->
					<html:text property="vo.othForceAmt" size="10" styleClass="needInput" onblur="checkOtherForce(this)"/>
				</logic:equal>
				<logic:notEqual name="surveyAutoForm" property="directFlag"  value="1">
					<!-- 非直通车案件 -->
					<html:text property="vo.othForceAmt" size="10" styleClass="needInput" onchange="checkNum(this);"/>
				</logic:notEqual>
			</logic:notEqual>
			<!-- REQ00024334--理算带入车辆定损其他交强赔付金额计算改造 modify by liuchun 2016年6月28日13:49:06 -->
		</td>
		<TD class="titleTd">车损定损合计:</TD>
		<TD class="editTd"><html:text property="vo.lossAmt" readonly="true" size="10" styleClass="needInput"/></TD>
	</tr>
	<bean:define id="autoFlag" name="surveyAutoForm" property="vo.autoFlag" type="java.lang.String"/>
	<% if("0400002".equals(autoFlag)){ %>
		<tr class="titleTr">
		    <td class="titleTd" >交管车辆类型:</td>
	        <td class="editTd"><estar:select property="vo.autoType" codeId="127" notempty="true" msg="交管车辆类型" styleClass="needInput"/></TD>
	        <td class="titleTd">委托类型：</td>
			<td class="editTd">
				<estar:select property="dispatchVo.devolveType" codeId="403" styleClass="editInput" msg="委托类型" />
				<html:hidden property="dispatchVo.devolveFlag"/>
				<html:hidden property="dispatchVo.devolveCheckFlag"/>
				<html:hidden property="dispatchVo.devolveCheckLossFlag"/>
			</td>
			<td colspan="2"></td>
		</tr>
	<%}else{ %>
		<tr class="titleTr">
		    <td class="titleTd">委托类型：</td>
			<td class="editTd">
				<estar:select property="dispatchVo.devolveType" codeId="403" styleClass="editInput" msg="委托类型" />
				<html:hidden property="dispatchVo.devolveFlag"/>
				<html:hidden property="dispatchVo.devolveCheckFlag"/>
				<html:hidden property="dispatchVo.devolveCheckLossFlag"/>
			</td>
			<td class="titleTd">互碰自赔标志:</td>
			<td class="editTd">
				<logic:equal name="surveyAutoForm" property="vo.autoFlag" value="0400002">
					<html:checkbox property="claimVO.bumpFlag" value="1" onclick="toBump(this);" disabled="true"/>
				</logic:equal>
				<logic:notEqual name="surveyAutoForm" property="vo.autoFlag" value="0400002">
					<html:checkbox property="claimVO.bumpFlag" value="1" onclick="toBump(this);"/>
				</logic:notEqual>
				<html:hidden property="claimVO.accidentTm"/>
				<html:hidden property="claimVO.accidentProvince"/>
				<html:hidden property="claimVO.accidentCity"/>
				<html:hidden property="claimVO.accidentCounty"/>
				<html:hidden property="claimVO.accidentStreet"/>
				<html:hidden property="claimPolicyVO.prodNo"/>
				<input type="hidden" id="disposeDeptFlag" value="0"/>
			</td>
			<td class="titleTd">
				<html:hidden property="vo.autoType"/>
				是否推定全损：
			</td>
			<td class="editTd">
				<estar:select property="vo.isTotalLossFlag" codeId="398" styleClass="needInput" msg="是否推定全损" />
			</td>
		</tr>
	<%} %>
	
	
	<!-- 上海平台反欺诈需求增加字段 是否临时车辆 add by zhangnn 2015-9-15  保单机构为上海、状态为定损、本车   start   -->
	<bean:define id="taskStat" name="surveyAutoForm" property="dispatchVo.taskStat" type="java.lang.String"/>
	<%if(dptCde.substring(0, 3).equals("231")){ %>
	<tr class="titleTr">
			<%if(autoFlag.equals("0400001")){ %>
			<td class="titleTd">
				<html:hidden property="vo.autoType"/>
				是否临时车辆：
			</td>
			<td class="editTd">
				<%if(taskStat.equals("0150001")){ %>
				<estar:select property="vo.isTemporaryFlag" codeId="398" styleClass="needInput" msg="是否临时车辆" />
				<% }else{ %>
				<estar:select disabled = "disabled" property="vo.isTemporaryFlag" codeId="398" styleClass="needInput" msg="是否临时车辆" />
				<% } %>
			</td>
				<td class="titleTd">
				是否水淹
				</td>
				<td class="editTd">
					<html:select property="vo.isWaterFlooded" onchange="isWaterFloodedChange()" styleClass="needInput">
						<html:option value="0">否</html:option>
						<html:option value="1">是</html:option>
					</html:select>
				</td>
				<td class="titleTd">
					水淹等级：
				</td>
				<td class="editTd">
					<html:select property="vo.waterFloodedLevel" disabled = "true" styleClass="needInput">
						<html:option value=""></html:option>
						<% for(int i=1;i<5;i++){%>
						<html:option value="<%=String.valueOf(i)%>"><%=i %> 级</html:option>
						<%} %>
					</html:select>
				</td>
			<%}else{ %>
			<!-- add by sunqi  REQ00027683-上海平台升级  begin  -->
				<td class="titleTd">
					是否水淹
				</td>
				<td class="editTd">
					<html:select property="vo.isWaterFlooded" onchange="isWaterFloodedChange()"  styleClass="needInput">
						<html:option value="0">否</html:option>
						<html:option value="1">是</html:option>
					</html:select>
				</td>
				<td class="titleTd">
					水淹等级：
				</td>
				<td class="editTd">
					<html:select property="vo.waterFloodedLevel" styleClass="needInput">
						<html:option value=""></html:option>
						<% for(int i=1;i<5;i++){%>
						<html:option value="<%=String.valueOf(i)%>"><%=i %> 级</html:option>
						<%} %>
					</html:select>
				</td>
				<td class="titleTd"></td>
				<td class="editTd"></td>
			<%} %>
			<!-- add by sunqi REQ00027683-上海平台升级 end  -->
		</tr>
		<% } %>
		<!-- 上海平台反欺诈需求增加字段 是否临时车辆 add by zhangnn 2015-9-15    end-->
	<!-- add by jianglf  -->
		<% if(dptCde.substring(0, 3).equals("211")){ %>
		<tr class="titleTr">
			<td class="titleTd">
				<html:hidden property="vo.autoType"/>
				是否为火自爆：
			</td>
			<td class="editTd">
				<%if(taskStat.equals("0150001")){ %>
					<html:select property="vo.isFireBumpFlag"  styleClass="needInput" >
						<html:option value="0">否</html:option>
						<html:option value="1">是</html:option>
					</html:select>
				<% }else{ %>
					<html:select property="vo.isFireBumpFlag"  styleClass="needInput"  disabled = "disabled" >
						<html:option value="0">否</html:option>
						<html:option value="1">是</html:option>
					</html:select>
				<% } %>
			</td>	
			<td class="titleTd">
					是否水淹
				</td>
				<td class="editTd">
					<html:select property="vo.isWaterFlooded" onchange="isWaterFloodedChange()"  styleClass="needInput">
						<html:option value="0">否</html:option>
						<html:option value="1">是</html:option>
					</html:select>
				</td>
				<td class="titleTd">
					水淹等级：
				</td>
				<td class="editTd">
					<html:select property="vo.waterFloodedLevel" styleClass="needInput">
						<html:option value=""></html:option>
						<% for(int i=1;i<5;i++){%>
						<html:option value="<%=String.valueOf(i)%>"><%=i %> 级</html:option>
						<%} %>
					</html:select>
				</td>
		</tr>
		<%} %>
	<tr  class="titleTr">
		<td class="titleTd">损失部位:</td>
		<td class="needInput" nowrap="nowrap" colspan="4" style="text-align:left">全车<html:checkbox name="surveyAutoForm" property="fullAuto" value="1"/>
		前部<html:checkbox name="surveyAutoForm" property="foreside" value="1"/>
		左前部<html:checkbox name="surveyAutoForm" property="leftForeside" value="1"/>
		右前部<html:checkbox name="surveyAutoForm" property="rightForeside" value="1"/>
		左侧<html:checkbox name="surveyAutoForm" property="nearside" value="1"/>
		右侧<html:checkbox name="surveyAutoForm" property="starboard" value="1"/>
		左后部<html:checkbox name="surveyAutoForm" property="leftTail" value="1"/>
		右后部<html:checkbox name="surveyAutoForm" property="rigthTail" value="1"/>
		底部<html:checkbox name="surveyAutoForm" property="foot" value="1"/>
		顶部<html:checkbox name="surveyAutoForm" property="top" value="1"/>
		尾部<html:checkbox name="surveyAutoForm" property="tail" value="1"/>
		内部<html:checkbox name="surveyAutoForm" property="inside" value="1"/></td>
		<!-- <td class="editTd">&nbsp;<input type="button" name="ceshi" value="非移动查勘" onclick="testDel(this)" style="display:"/></td> -->
	
	</tr>
	
<%--	<tr class="titleTr">--%>
<%--		<td class="titleTd">事故责任:</td>--%>
<%--		<td class="editTd">--%>
<%--			<estar:select property="claimVO.caseDuty" notempty="true" msg="事故责任" codeId="024" styleClass="needInput" onchange="changeNum(0);"/>--%>
<%--			<input type="hidden" name ="defaultCaseDuty" value ='<bean:write property="claimVO.caseDuty" name="surveyAutoForm"/>'/>--%>
<%--	        <estar:text property="claimVO.dutyPercent" styleClass="needInput" size="6" onchange="checkDuty(this);"/>%--%>
<%--		</td>--%>
<%--		<td class="titleTd"  style="text-align: left;" colspan="4">--%>
<%--			&nbsp;&nbsp;&nbsp;<nested:checkbox property="dispatchVo.remark" value="1"/>--%>
<%--		</td>--%>
<%--	</tr>--%>
	
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr class="titleTr">
		<td colspan="6">
			<marquee direction="left" onmouseover="this.stop();" onmouseout="this.start();" >
				<a href="javascript:showOpen('../inquiry/dealinquiryedit.do?mhd=toView&caseNo=${surveyAutoForm.caseNo}&sysAction=read')"><font color=red>
					<div id="inquiry"> </div>
				</font></a>
			</marquee>
		</td>
	</tr>
	<tr class="titleTr" >
		<td colspan="6" class="hideShowtd" >
		      <table id="fitTab" width="100%" cellspacing="1" cellpadding="2">
				<tr>
				   <td colspan="17" class="listHeadertd"><div align="center">配件项</div></td>
				</tr>
		        <tr>
				   <td colspan="10" class="listHeadertd"><div align="center">定损</div></td>
				   <td colspan="7" class="listHeadertd"><div align="center">核价</div></td>
				</tr>
				<tr>
					<td class="listHeadertd" width="10%"><div align="center">险种名称</div></td>
					<td class="listHeadertd" width="8"><div align="center">序号</div></td>
					<td class="listHeadertd" width="20"><div align="center">配件编号</div></td>
					<td class="listHeadertd" width="20%"><div align="center">配件名称</div></td>
					<td class="listHeadertd" width="1"><div align="center">专修价</div></td>
					<logic:equal name="surveyAutoForm" property="operateFlag"  value="checkPrice">
						<td class="listHeadertd" width="1"><div align="center">市场价</div></td>
					</logic:equal>
					<td class="listHeadertd" width="9"><div align="center">定损价格</div></td>
				    <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 start--%>
					<td class="listHeadertd" width="9"><div align="center">本地价格</div></td>
				    <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 end--%>
					<td class="listHeadertd" width="9" style="display:none"><div align="center">修理厂价格</div></td>
					<td class="listHeadertd" width="9"><div align="center">历史价格</div></td>
					<td class="listHeadertd" width="10"><div align="center">数量</div></td>
					<td class="listHeadertd" width="10"><div align="center">残值</div></td>
					<td class="listHeadertd" width="10"><div align="center">总额</div></td>
					<td class="listHeadertd" width="9"><div align="center">核价</div></td>
					<td class="listHeadertd" width="10"><div align="center">数量</div></td>
					<td class="listHeadertd" width="10"><div align="center">残值</div></td>
					<td class="listHeadertd" width="10"><div align="center">总额</div></td>
					<td class="listHeadertd" width="10"><div align="center"></div></td>
					<%--<td   class="listHeadertd" >旧件回收<input type="checkbox" name="checkAll" value="0" title="回收" onclick="select_all(this)" disabled="true"></td>--%>
					<td class="listHeadertd" width="10"><div align="center"></div></td>
				</tr>
				<bean:define id="clmTms" name="surveyAutoForm" property="clmTms"/>
				<logic:present name="surveyAutoForm" property="autoFittingsList">
					<nested:iterate id="autoFittingsList" name="surveyAutoForm" property="autoFittingsList" indexId="idx">
						<bean:define id="fitType" name="autoFittingsList" property="fitType"/>
						<bean:define id="fitClmTms" name="autoFittingsList" property="clmTms"/>
						<% if(clmTms.equals(fitClmTms)){ %>
						<tr class="<bean:write name="autoFittingsList" property="fitAllStyle"/>">
						<logic:equal name="fitType" value="0510002">
							  <td class="editTd"><estar:nestedSelect property="insCde" dictString="dictIns" styleClass="needInput" msg="险种名称" onchange="checkIns(this);"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="4" styleClass="readonlyInput" property="recycleSeqNo"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="10" styleClass="editInput" property="iniFtnsCde"/></td>
							  <td class="editTd" align="left">
							     <estar:nestedText property="fittingsNme" size="30" styleClass="needInput" notempty="true" msg="配件名称" onchange="modifyObj(this);"/><img src="../images/write.gif" onclick="detail(this)" alt="标准配件明细" style="cursor:pointer;">
							     <nested:hidden property="fitType"/><nested:hidden property="remark"/>
							  </td>
							  <td class="editTd" align="left"><estar:nestedText property="refPrice1" readonly="true" size="5" styleClass="editInput" notempty="true" msg="专修价"/></td>
							  <logic:equal name="surveyAutoForm" property="operateFlag"  value="checkPrice">
							  	<td class="editTd" align="left"><estar:nestedText property="refPrice2" readonly="true" size="5" styleClass="editInput" notempty="true" msg="市场价"/></td> 
							  </logic:equal>
						</logic:equal>
						<logic:notEqual name="fitType" value="0510002">
							  <td class="editTd"><estar:nestedSelect property="insCde" dictString="dictIns" styleClass="needInput" msg="险种名称" onchange="checkIns(this);"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="4" styleClass="readonlyInput" property="recycleSeqNo" readonly="true"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="10" styleClass="editInput" property="iniFtnsCde" readonly="true"/></td>
							  <td class="editTd" align="left">
							     <estar:nestedText property="fittingsNme" size="30" styleClass="needInput" readonly="true" notempty="true" msg="配件名称" onchange="modifyObj(this);"/><img src="../images/write.gif" onclick="detail(this)" alt="标准配件明细" style="cursor:pointer;">
							     <nested:hidden property="fitType"/><nested:hidden property="remark"/>
							  </td>
							  <td class="editTd" align="left"><estar:nestedText property="refPrice1" readonly="true" size="5" styleClass="editInput" notempty="true" msg="专修价"/></td>
							  <logic:equal name="surveyAutoForm" property="operateFlag"  value="checkPrice">
							  	<td class="editTd" align="left"><estar:nestedText property="refPrice2" readonly="true" size="5" styleClass="editInput" notempty="true" msg="市场价"/></td> 
							  </logic:equal>
						</logic:notEqual>
						      <td class="editTd" align="left"><estar:nestedText property="srvyAmt" size="2" styleClass="needInput"  notempty="true" msg="定损报价" onchange="sumFittings(this);modifyObj(this);"  /></td>
							 
							 <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 start--%>
							      <td class="editTd" align="left"><estar:nestedText property="locPrice2" size="2" styleClass="needInput"  notempty="true" msg="本地价格" readonly="true"/></td>
							  <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 end--%>
							  <td class="editTd" style="display:none" align="left"><estar:nestedText property="fitAmt" size="2" styleClass="needInput"  notempty="true" msg="修理厂价格" readonly="true"/></td>
							   
							  <td class="editTd" align="left">
							 	<nested:select  styleClass="needInput" style="width:100%;" property="dbicPrice" onchange="setEdbicPrice(this,${idx})">
							 		<html:option value="">查看</html:option>
						  		    <html:option value="${autoFittingsList.edbicMinPrice}">${autoFittingsList.edbicMinPrice}</html:option>
									<html:option value="${autoFittingsList.edbicAvgPrice}">${autoFittingsList.edbicAvgPrice}</html:option>
									<html:option value="${autoFittingsList.edbicMaxPrice}">${autoFittingsList.edbicMaxPrice}</html:option>
								</nested:select>  
 							  	<nested:hidden property="edbicMinPrice"/>
 							  	<nested:hidden property="edbicAvgPrice"/>
 							  	<nested:hidden property="edbicMaxPrice"/>
	 						  </td>
							  
							  <td class="editTd" align="left"><estar:nestedText property="piece" style="width:26px" styleClass="needInput"  notempty="true" msg="数量" onchange="checkInt();sumFittings(this);modifyObj(this);warnCheckNum(this)"  /></td>
							  <td class="editTd" align="left"><estar:nestedText property="srv" style="width:26px" styleClass="needInput"  notempty="true" msg="残值定损" onchange="sumFittings(this);modifyObj(this)"  /></td>
						<%}else{ %>
						  <tr class="clmtitleTr">
							  <td class="editTd"><estar:nestedSelect property="insCde" dictString="dictIns" styleClass="needInput" msg="险种名称" onchange="checkIns(this);"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="4" styleClass="readonlyInput" property="recycleSeqNo"/></td>
							  <td class="editTd" align="left"><estar:nestedText size="10" styleClass="editInput" property="iniFtnsCde" readonly="true"/></td>
							  <td class="editTd" align="left">
							     <estar:nestedText property="fittingsNme" size="30" styleClass="needInput" readonly="true" notempty="true" msg="配件名称"/><img src="../images/write.gif" onclick="detail(this)" alt="标准配件明细" style="cursor:pointer;">
							     <nested:hidden property="fitType"/><nested:hidden property="remark"/>
							  </td>
							  <td class="editTd" align="left"><estar:nestedText property="refPrice1" readonly="true" size="5" styleClass="editInput" notempty="true" msg="专修价"/></td>
							  <logic:equal name="surveyAutoForm" property="operateFlag"  value="checkPrice">
							  	<td class="editTd" align="left"><estar:nestedText property="refPrice2" readonly="true" size="5" styleClass="editInput" notempty="true" msg="市场价"/></td> 
							  </logic:equal>
						      <td class="editTd" align="left"><estar:nestedText property="srvyAmt" size="2" styleClass="needInput"  notempty="true" msg="定损报价" onchange="sumFittings(this)"/></td>
						      
						      <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 start--%>
							      <td class="editTd" align="left"><estar:nestedText property="locPrice2" size="2" styleClass="needInput"  notempty="true" msg="本地价格" readonly="true"/></td>
						      <%--  REQ00022048--核价核损操作界面展示“本地价格” add by liyd 2015-11-12 end--%>
							  <td class="editTd" style="display:none" align="left"><estar:nestedText property="fitAmt" size="2" styleClass="needInput"  notempty="true" msg="修理厂价格" readonly="true"/></td>
							  <td class="editTd" align="left">
							  <nested:select  styleClass="needInput" style="width:100%;" property="dbicPrice" onchange="setEdbicPrice(this,${idx})">
							 		<html:option value="">查看</html:option>
						  		    <html:option value="${autoFittingsList.edbicMinPrice}">${autoFittingsList.edbicMinPrice}</html:option>
									<html:option value="${autoFittingsList.edbicAvgPrice}">${autoFittingsList.edbicAvgPrice}</html:option>
									<html:option value="${autoFittingsList.edbicMaxPrice}">${autoFittingsList.edbicMaxPrice}</html:option>
								</nested:select>  
 							  	<nested:hidden property="edbicMinPrice"/>
 							  	<nested:hidden property="edbicAvgPrice"/>
 							  	<nested:hidden property="edbicMaxPrice"/>
	 						  </td>
							  <td class="editTd" align="left"><estar:nestedText property="piece" style="width:26px" styleClass="needInput"  notempty="true" msg="数量" onchange="checkInt();sumFittings(this);warnCheckNum(this)"/></td>
							  <td class="editTd" align="left"><estar:nestedText property="srv" style="width:26px" styleClass="needInput"  notempty="true" msg="残值定损" onchange="sumFittings(this)"/></td>
							  
						<%} %>
						<!--  hujl  页面优化   modify  2014-7-22    start -->
							<td class="editTd" align="left">
						  		<nested:text property="totalAmt" readonly="true" styleClass="editInput" size="3"/>
						  		 	<nested:hidden property="firstAmt"/>
							  		<nested:hidden property="clmTms"/>
									<nested:hidden property="autofitId"/>
									<nested:hidden property="level"/>
									<nested:hidden property="recycleCount"/>
									<nested:hidden property="recycleResult"/>
									<nested:hidden property="recycleReason"/>
									<nested:hidden property="recycleDate"/>
									<nested:hidden property="recycleFlag"/>
									<nested:hidden property="recyclePrintId"/>
									<nested:hidden property="fitNmeStyle"/>
									<nested:hidden property="fitAmtStyle"/>
									<nested:hidden property="fitPieceStyle"/>
									<nested:hidden property="fitSrvStyle"/>
									<nested:hidden property="fitAllStyle"/>
									<nested:hidden property="callbackFlagSave"/>
									<nested:hidden property="partId"/>								  
									<nested:hidden property="survyAmt"/>
									<nested:hidden property="amount"/>
									<nested:hidden property="remainderAmt"/>
									<nested:hidden property="updateCde"/>
									
									<!-- 新理赔系统新增 shilk -->
									<nested:hidden property="oldInsCde"/>
									<nested:hidden property="saveFlag"/>
									<nested:hidden property="fittingsCde"/>
									<nested:hidden property="fittSource"/>
									<nested:hidden property="iniFtnsNme"/>
									<nested:hidden property="chgCompSetCode"/>
									<nested:hidden property="chgCompSetName"/>
									<nested:hidden property="refPrice1"/>
									<nested:hidden property="refPrice2"/>
									<nested:hidden property="refPrice3"/>
									<nested:hidden property="locPrice1"/>
									<nested:hidden property="locPrice2"/>
									<nested:hidden property="locPrice3"/>
									<nested:hidden property="partGroupCode"/>
									<nested:hidden property="partGroupName"/>
									<nested:hidden property="ifRemain"/>
									<nested:hidden property="insName"/>
						    </td>
							<bean:define id="checkPiece" name="autoFittingsList" property="checkPiece"/>
							<bean:define id="piece" name="autoFittingsList" property="piece"/>
							<bean:define id="checkAmt" name="autoFittingsList" property="checkAmt"/>
							<bean:define id="srvyAmt" name="autoFittingsList" property="srvyAmt"/>
							<bean:define id="checkSrv" name="autoFittingsList" property="checkSrv"/>
							<bean:define id="srv" name="autoFittingsList" property="srv"/>
							
							<% if(Double.parseDouble(checkAmt+"") != Double.parseDouble(srvyAmt+"")){ %>
								<td class="editTd" align="left"><estar:nestedText property="checkAmt"  styleClass="numCheckInput" size="2" maxlength="7" notempty="true" msg="定损核价" onchange="checkPicAmt(this);"/></td>
							<%}else{ %>
								<td class="editTd" align="left"><estar:nestedText property="checkAmt"  styleClass="editInput" size="2" maxlength="7" notempty="true" msg="定损核价" onchange="checkPicAmt(this);"/></td>
							<%} %>
							
							<% if(Integer.parseInt(checkPiece+"") != Integer.parseInt(piece+"")){ %>
								<td class="editTd" align="left"><estar:nestedText property="checkPiece" styleClass="numCheckInput" style="width:26px" maxlength="10" notempty="true" msg="核价数量" onchange="checkPic(this);checkInt();"/></td>
							<%}else{ %>
								<td class="editTd" align="left"><estar:nestedText property="checkPiece" styleClass="editInput" style="width:26px" maxlength="10" notempty="true" msg="核价数量" onchange="checkPic(this);checkInt();"/></td>
							<%} %>
							
							<% if(Double.parseDouble(checkSrv+"") != Double.parseDouble(checkSrv+"")){ %>
								<td class="editTd" align="left"><estar:nestedText property="checkSrv"  styleClass="numCheckInput" style="width:26px" maxlength="8" notempty="true" msg="残值核价" onchange="checkPicSrv(this)"/></td>
							<%}else{ %>
								<td class="editTd" align="left"><estar:nestedText property="checkSrv"  styleClass="editInput" style="width:26px" maxlength="8" notempty="true" msg="残值核价" onchange="checkPicSrv(this)"/></td>
							<%} %>
							  
							  <td class="editTd" align="left">
								  <estar:nestedText property="chktotAmt" styleClass="editInput" size="3" readonly="true"/>
							  </td>
							  <td class="editTd"><nested:checkbox property="callBackFlag" value="1" title="回收" disabled="true" onclick="select_one(this)" style="display: none"/></td>
							  <td><input name="fitDelBut" type='button' style="height: 1.5em;"  value='删除' onclick="del_row(fitTab)"></td>
						 </tr>
						 <!--  hujl  页面优化   modify  2014-7-22    end -->
						
						 <script>
						 	document.getElementById("fitIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
				</logic:present>
				<tr class="titleTr">
					<td class=td4 colspan=17 nowrap>
						<nobr><!-- <input type="button" name="addfit" value="增加配件" onclick="addStandardFitting()"/> -->
						<!-- 移动查勘案件，启用此按钮 --><input type="button"  id="customfit" name="customfit" value="自定义配件" onclick=" fittings_adds('')"/>
						<a href="#" onclick="javascript:window.open('<%=context%>/download/fitdesc.jsp')">配件IE设置说明</a></nobr>
						定损残值:<html:text property="vo.totalSrv" size="2" styleClass="editInput"/>
						定损管理费比率:<html:text property="vo.manageRate" size="2" styleClass="editInput" onchange="checkNum(this);checkSurveyDgr(this)"/>%
						定损管理费:<html:text property="vo.manageAmt" maxlength="17" size="5"  styleClass="editInput" onchange="checkSurveyPoint(this)"/><html:hidden property="vo.manageAmtStyle"/><html:hidden property="vo.surveyManageAmt"/>
						小计:<html:text property="vo.fittingsAmt" size="3" readonly="true" styleClass="editInput"/>
						核价残值:<html:text property="vo.chkTotalSrv" size="2" styleClass="editInput"/>
						核价管理费比率:<html:text property="vo.chkManageRate" size="2" styleClass="editInput" onchange="checkNum(this);checkPrice(this)"/>%
						核价管理费:<html:text property="vo.chkManageAmt" size="2" readonly="true" styleClass="editInput"/>
						小计: <html:text property="vo.fitChktotAmt" size="3" readonly="true" styleClass="editInput"/>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr>
		<td colspan="6"  class="hideShowtd">
				<table id="repairTab" width="100%" border="0" cellspacing="1" cellpadding="2">
					<tr>
						<td colspan="7" class="listHeadertd"><div align="center">修理项目</div></td>
					</tr>
					<tr >
						<td width=10% class="listHeadertd"><div align="center">险别</div></td>
						<td width=10% class="listHeadertd"><div align="center">序号</div></td>
						<td width=10% class="listHeadertd"><div align="center">工种名称</div></td>
						<td width=15% class="listHeadertd"><div align="center">修理名称</div></td>
						<td width=15% class="listHeadertd" ><div align="center">工时费报价</div></td>
						<td width=15% class="listHeadertd" ><div align="center">工时费核损</div></td>
						<td width=10% class="listHeadertd"><div align="center">操作</div></td>
					</tr>
					<logic:present name="surveyAutoForm" property="autoRepairList">
					<nested:iterate id="autoRepairList" name="surveyAutoForm" property="autoRepairList" indexId="idx">
						 <bean:define id="fitClmTms" name="autoRepairList" property="clmTms"/>
						 <bean:define id="checkAmt" name="autoRepairList" property="checkAmt"/>
						 <bean:define id="repairAmt" name="autoRepairList" property="repairAmt"/>
						 <% if(clmTms.equals(fitClmTms)){ %>
							 <tr class="titleTr">
								  <td><estar:nestedSelect property="insCde" dictString="dictIns" notempty="true"  styleClass="needInput" msg="险种名称" onchange="checkIns(this);"/></td>
								  <td align="left"><nested:text property="serialNo" size="8" maxlength="50" styleClass="readonlyInput" readonly="true"/></td>
								  <td align="left">
								 	 <nested:text property="jyRepairId" size="2" maxlength="50" styleClass="readonlyInput" style="display:none"/>
								 	 <nested:text property="repairNme" size="20" maxlength="50" styleClass="needInput" readonly="true"/>
								  </td>
								  <td align="left"><nested:text property="repairItemNme" size="50" maxlength="50" styleClass="needInput" readonly="true"/></td>
								  <td align="left">
								  		<nested:text property="repairAmt" styleClass="needInput"  onchange="sumRepair(this)" readonly="true"/>
								  		<nested:hidden property="firstAmt"/>
								  </td>
								  <td align="left">
								  	<% if(Double.parseDouble(checkAmt+"") != Double.parseDouble(repairAmt+"")){ %>
										<nested:text property="checkAmt" styleClass="numCheckInput"  onchange="checkLossAmt(this)"/>
									<%}else{ %>
										<nested:text property="checkAmt" styleClass="editInput"  onchange="checkLossAmt(this)"/>
									<%} %>
								  	<nested:hidden property="clmTms"/>
								  	
								  	<!-- 新理赔系统新增shilk (原险别代码、保存标识) -->
								  	<nested:hidden property="oldInsCde"/>
								    <nested:hidden property="saveFlag"/>
								    <nested:hidden property="repairId"/>
								    <!-- 精友返回数据部分 -->
								    <nested:hidden property="repairCde"/>
								    <nested:hidden property="repairItemCde"/>
								    <nested:hidden property="levelCde"/>
								    <nested:hidden property="levelNme"/>
								    <nested:hidden property="hourPrice"/>
								    <nested:hidden property="repairHour"/>
								    <nested:hidden property="repairRemark"/>
								    <nested:hidden property="selfFlag"/>
									<nested:hidden property="repairSource"/>
								  </td>
								  <td><input type='button' name="repairDelBut"  value='删除' onclick="del_row(repairTab)"></td>
							 </tr>
						 <%}else{ %>
							  <tr class="clmtitleTr">
								  <td><estar:nestedSelect property="insCde" dictString="dictIns" notempty="true"  styleClass="needInput" msg="险种名称" disabled="true" onchange="checkIns(this);"/></td>
								  <td align="left"><nested:text property="serialNo" size="8" maxlength="50" styleClass="readonlyInput" readonly="true"/></td>
								  <td align="left">
								 	 <nested:text property="jyRepairId" size="2" maxlength="50" styleClass="readonlyInput" style="display:none"/>
								 	 <nested:text property="repairNme" size="20" maxlength="50" styleClass="needInput" readonly="true"/>
								  </td>
								  <td align="left"><nested:text property="repairItemNme" styleClass="needInput" size="50" readonly="true"/></td>
								  <td align="left">
								  		<nested:text property="repairAmt" styleClass="needInput" onchange="sumRepair(this)" readonly="true"/>
								  		<nested:hidden property="firstAmt"/>
								  </td>
								  <td align="left">
									  <% if(Double.parseDouble(checkAmt+"") != Double.parseDouble(repairAmt+"")){ %>
										<nested:text property="checkAmt" styleClass="numCheckInput"  onchange="checkLossAmt(this)" readonly="true"/>
									<%}else{ %>
										<nested:text property="checkAmt" styleClass="editInput"  onchange="checkLossAmt(this)" readonly="true"/>
									<%} %>
									  <nested:hidden property="clmTms"/>
									  <!-- 新理赔系统新增shilk (原险别代码、保存标识) -->
									  <nested:hidden property="oldInsCde"/>
									  <nested:hidden property="saveFlag"/>
									  <nested:hidden property="repairId"/>
									  <!-- 精友返回数据部分 -->
									  <nested:hidden property="repairCde"/>
									  <nested:hidden property="repairItemCde"/>
									  <nested:hidden property="levelCde"/>
									  <nested:hidden property="levelNme"/>
									  <nested:hidden property="hourPrice"/>
									  <nested:hidden property="repairHour"/>
									  <nested:hidden property="repairRemark"/>
									  <nested:hidden property="selfFlag"/>
									  <nested:hidden property="repairSource"/>
								  </td>
								  <td><input type='button' name="repairDelBut"  value='删除' onclick="del_row(repairTab)"></td>
							 </tr>
						 <%} %>
						 <script>
						 	document.getElementById("repairIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
					</logic:present>
					<tr class="titleTr">
						<td class="editTd"><!-- <input type="button" id="addrepair" value="自定义工时" onclick="repair_add()"/> --></td>
						<td colspan="2"></td>
						<td class="titleTd">小计:</td>
						<td class="editTd" ><html:text property="vo.repairAmt" readonly="true" styleClass="editInput"/></td>
					    <td class="editTd"><html:text property="vo.repChktotAmt" readonly="true" styleClass="editInput"/></td>
						<td class="editTd"></td>
					</tr>
				</table>
		</td>
	</tr>
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr>
		<td colspan="6" class="hideShowtd" >
		      <table id="accTab" width="100%" cellspacing="1" cellpadding="2">
		      	<tr>
				   <td colspan="8" class="listHeadertd"><div align="center">辅料项</div></td>
				</tr>
				<tr >
					<td width=15% class="listHeadertd"><div align="center">序号</div></td>
					<td width=20% class="listHeadertd"><div align="center">辅料名称</div></td>
					<td width=20% class="listHeadertd"><div align="center">辅料价格</div></td>
					<td width=15% class="listHeadertd" ><div align="center">数量</div></td>
					<td width=20% class="listHeadertd" ><div align="center">辅料小计</div></td>
					<td width=10% class="listHeadertd"><div align="center">操作</div></td>
				</tr>
				<logic:present name="surveyAutoForm" property="accessoriesInfoList">
				<nested:iterate id="accessoriesInfoList" name="surveyAutoForm" property="accessoriesInfoList" indexId="idx">
					<tr class="clmtitleTr">
						<td align="left"><input  size="8" maxlength="50" styleClass="readonlyInput" value ="<%=idx.intValue()+1%>" readonly="true"/></td>
						<td align="left"><nested:text property="repairName" size="30" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="accessoriesPrice" size="50" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="num" size="30" maxlength="20" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="accessoriesFee" size="20" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left">
							<nested:hidden property="accessoriesId"/>
							<nested:hidden property="dispatchId"/>
						</td>
					</tr>
						<script>
						 	document.getElementById("accessoriesIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
				</logic:present> 
				<tr class="titleTr">
						<td class="editTd"><!-- <input type="button" id="addrepair" value="自定义工时" onclick="accessories_add()"/> --></td>
						<td colspan="2"></td>
						<td class="titleTd">小计:</td>
						<td class="editTd" ><input  id="accessoriesAll" value="0" readonly="true" styleClass="editInput"/>
						</td>
					    <td class="editTd"><%-- <html:text property="vo.repChktotAmt" readonly="true" styleClass="editInput"/> --%></td>
						<td class="editTd"></td>
				</tr>
				
				
			  </table>
		</td>
	</tr>
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr>
		<td colspan="6" class="hideShowtd" >
		      <table id="partsTab" width="100%" cellspacing="1" cellpadding="2">
		      	<tr>
				   <td colspan="8" class="listHeadertd"><div align="center">零件风险评估</div></td>
				</tr>
				<tr >
						<td width=5% class="listHeadertd"><div align="center">序列</div></td>
						<td width=20% class="listHeadertd"><div align="center">零件名称</div></td>
						<td width=15% class="listHeadertd"><div align="center">零件编码</div></td>
						<td width=15% class="listHeadertd" ><div align="center">零件价格</div></td>
						<td width=15% class="listHeadertd" ><div align="center">险别代码</div></td>
						<td width=30% class="listHeadertd"><div align="center">风险提示</div></td>
				</tr>
				<logic:present name="surveyAutoForm" property="partsInfoList">
				<nested:iterate id="partsInfoList" name="surveyAutoForm" property="partsInfoList" indexId="idx">
					<tr class="clmtitleTr">
						<td align="left"><input  size="8" maxlength="50" styleClass="readonlyInput" value ="<%=idx.intValue()+1%>" readonly="true"/></td>
						<td align="left"><nested:text property="partsName" size="12" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="partsNo" size="10" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="partsPrice" size="10" maxlength="20" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="riskCode" size="10" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="riskCodeinfo" size="50" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left">
							<nested:hidden property="riskcodeId"/>
							<nested:hidden property="dispatchId"/>
						</td>
					</tr>
						<script>
						 	document.getElementById("partsinfoIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
				</logic:present> 
			  </table>
		</td>
	</tr>
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr>
		<td colspan="6" class="hideShowtd" >
		      <table id="partTab" width="100%" cellspacing="1" cellpadding="2">
		      	<tr>
				   <td colspan="8" class="listHeadertd"><div align="center">风险评估</div></td>
				</tr>
				<tr >
						<td width=5% class="listHeadertd"><div align="center">序列</div></td>
						<td width=10% class="listHeadertd"><div align="center">规则类型</div></td>
						<td width=20% class="listHeadertd"><div align="center">规则名称</div></td>
						<td width=15% class="listHeadertd" ><div align="center">风险类型</div></td>
						<td width=40% class="listHeadertd" ><div align="center">风险描述</div></td>
						<td width=10% class="listHeadertd"><div align="center">操作</div></td>
				</tr>
				<logic:present name="surveyAutoForm" property="riskInfoList">
				<nested:iterate id="riskInfoList" name="surveyAutoForm" property="riskInfoList" indexId="idx">
					<tr class="clmtitleTr">
						<td align="left"><input  size="8" maxlength="50" styleClass="readonlyInput" value ="<%=idx.intValue()+1%>" readonly="true"/></td>
						<td align="left"><nested:text property="riskType" size="2" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="ruleName" size="50" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="classification" size="30" maxlength="20" styleClass="needInput" readonly="true"/></td>
						<td align="left"><nested:text property="riskDescription" size="50" maxlength="50" styleClass="needInput" readonly="true"/></td>
						<td align="left">
							<nested:hidden property="partId"/>
							<nested:hidden property="dispatchId"/>
						</td>
					</tr>
						<script>
						 	document.getElementById("riskInfoIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
				</logic:present> 
			  </table>
		</td>
	</tr>	
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr>
		<td colspan="6"  class="hideShowtd" >
		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tr>
				<td colspan="4" class="listHeadertd"><div align="center">费用</div></td>
			</tr>
			<tr>
				<td width=100% colspan=4>
				<table id="feeTab" width="100%" border="0" cellspacing="1" cellpadding="2">
					<tr>
						<td width=20% class="listHeadertd"><div align="center">险别</div></td>
						<td width=15% class="listHeadertd"><div align="center">费用类型</div></td>
						<td width=15% class="listHeadertd" ><div align="center">费用金额</div></td>
						<td width=15% class="listHeadertd" ><div align="center">核损金额</div></td>
						<td width=5% class="listHeadertd"><div align="center">操作</div></td>
					</tr>
					<logic:present name="surveyAutoForm" property="lossFeeList">
					<nested:iterate id="lossFeeList" name="surveyAutoForm" property="lossFeeList" indexId="idx">
						<bean:define id="fitClmTms" name="lossFeeList" property="clmTms"/>
						<bean:define id="checkFee" name="lossFeeList" property="checkFee"/>
						<bean:define id="feeAmt" name="lossFeeList" property="feeAmt"/>
						<% if(clmTms.equals(fitClmTms)){ %>
							<tr class="titleTr">
							  <td><estar:nestedSelect property="insCde" dictString="dictIns" notempty="true"  styleClass="needInput" msg="险种名称" onchange="checkIns(this);"/></td>
							  <td><estar:nestedSelect property="feeType"  codeId="00702"   notempty="true"  styleClass="needInput" msg="费用类型" onchange="selectfeetype(this)" /></td>
							  <td align="left">
							  	<nested:text property="feeAmt" styleClass="needInput" onchange='sumFee(this)'/>
							  	<nested:hidden property="feeKind"/>
							  </td>
							  <td align="left">
							  	<% if(Double.parseDouble(checkFee+"") != Double.parseDouble(feeAmt+"")){ %>
									<nested:text property="checkFee" styleClass="numCheckInput" onchange="checkLossFee(this)"/>
							  	<%}else{ %>
									<nested:text property="checkFee" styleClass="editInput" onchange="checkLossFee(this)"/>
							  	<%} %>
							  	<nested:hidden property="firstAmt"/>
							  	<nested:hidden property="clmTms"/>
							  </td>
							  <td><input type='button' name="lossDelBut" value='删除' onclick="del_row(feeTab)"></td>
							 </tr>
						 <%}else{ %>
						 	<tr class="clmtitleTr">
							  <td><estar:nestedSelect property="insCde" dictString="dictIns" notempty="true"  styleClass="needInput" msg="险种名称" disabled="true" onchange="checkIns(this);"/></td>
							  <td><estar:nestedSelect property="feeType"  codeId="00702"  notempty="true" disabled="true" styleClass="needInput" msg="费用类型"  /></td>
							  <td align="left">
							  	<nested:text property="feeAmt" styleClass="needInput" readonly="true" onchange='sumFee(this)'/>
							  	<nested:hidden property="feeKind"/>
							  </td>
							  <td align="left">
							  	<% if(Double.parseDouble(checkFee+"") != Double.parseDouble(feeAmt+"")){ %>
									<nested:text property="checkFee" styleClass="numCheckInput" onchange="checkLossFee(this)" readonly="true"/>
							  	<%}else{ %>
									<nested:text property="checkFee" styleClass="editInput" onchange="checkLossFee(this)" readonly="true"/>
							  	<%} %>
							  	<nested:hidden property="firstAmt"/>
							  	<nested:hidden property="clmTms"/>
							  </td>
							  <td><input type='button' name="lossDelBut" value='删除' onclick="del_row(feeTab)"></td>
							 </tr>
						 <%} %>
						 <script>
						 	document.getElementById("lossFeeIndex").value = <%=idx.intValue()+1%>;
						 </script>
					</nested:iterate>
					</logic:present>
					<tr class="titleTr">
						<td >
						  <input name="addFee" type=button value="增加费用" onclick="fee_add()">
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						</td>
						<td class="titleTd">小计:</td>
						<td class="editTd"><html:text property="vo.feeAmt" readonly="true" styleClass="editInput"/>&nbsp;小计:</td>
						<td  colspan=""><html:text property="vo.feeChktotAmt" readonly="true" styleClass="editInput"/></td>
						<td  colspan="2"></td>
					</tr>
				</table>
				</td>
			</tr>
		</table>
		</td>
	</tr>
	<tr class="titleTr"><td colspan="6">&nbsp;</td></tr>
	<tr id="third" style="display: none">
		<td colspan=6 class="listHeadertd"><div align="center"><font color="red">三者车交强险信息</font></div></td>
	</tr>
	<tr id="thirdfee" class="titleTr" style="display: none">
		<td class="titleTd">交强险保单号:</td>
		<td class="editTd">
			<html:text property="vo.forcePlyno" maxlength="50" size="20" styleClass="editInput"/>
		</td>
		<td class="titleTd">交强险报案号:</td>
		<td class="editTd">
			<html:text property="vo.forceCaseno" maxlength="50" size="20" styleClass="editInput"/>
		</td>
		<td class="titleTd">交强险投保公司：</td>
		<td class="editTd"><estar:select property="vo.insureCom" codeId="123" styleClass="editInput"/></td>
	</tr>
	<tr id="thirdfee2" class="titleTr" style="display: none">
	   	<td class="titleTd">委托索赔标志：</td>
		<td class="editTd">
			<estar:radio property="vo.dvlvClm" codeId="Y1N0" defaultIndex="1"/>
		</td>
		<td colspan=2>&nbsp;</td>
        <td colspan=2>&nbsp;</td>
	</tr>
	<tr class="titleTr">
	       <td colspan="6" class="editTd">
	        <span id="chelprice" style="display: none"><input type="button"  value="同意核价金额" onclick="upropertMeth('1')"></span>
            <span id="chelloss" style="display: none"><input type="button"  value="同意核损金额" onclick="upropertMeth('2')"></span>
            <span id="csurvey" style="display: none"><input type="button"  value="同意定损金额" onclick="upropertMeth('3')"></span>
            <span id="forcedcheprice" style="display: none"><input type="button"  value="强制通过核价金额" onclick="upropertMeth('1')"></span>
            <span id="forcedcheloss" style="display: none"><input type="button"  value="强制通过核损金额" onclick="upropertMeth('2')"></span>
	      </td>
	</tr>
	<logic:equal name="surveyAutoForm" property="operateFlag"  value="survey">
		<tr class="titleTr">
			<td id="surveyRem" class="titleTd">定损说明：</td>
			<td id="checkText" colspan="3" class="editTd"><html:textarea property="checkLogVO.checkIdea" cols="90" rows="4" styleClass="needInput"/></td>
			<td id="surveydis" colspan="2">&nbsp;</td>
		</tr>
	</logic:equal>
	<logic:equal name="surveyAutoForm" property="operateFlag"  value="checkPrice">
		<tr class="titleTr">
			<td id="checkpTr" class="titleTd">核价意见：</td>
			<td id="checkpTd" class="editTd"><estar:select property="checkLogVO.checkResult" codeId="003"  onchange="setCheckIdea()"  styleClass="needInput"/></td>
     		<td id="priceRem" class="titleTd">核价说明：</td>
			<td id="checkText" colspan="3" class="editTd"><html:textarea property="checkLogVO.checkIdea" cols="90" rows="4" styleClass="needInput"/></td>
		</tr>
	</logic:equal>
	<logic:equal name="surveyAutoForm" property="operateFlag"  value="checkLoss">
		<tr class="titleTr">
			<td id="checkpTr" class="titleTd">核价意见：</td>
			<td id="checkpTd" class="editTd"><estar:select property="checkPriceIdea" codeId="003"  onchange="setCheckIdea()"  styleClass="readonlyInput" disabled="true"/></td>
     		<td id="priceRem" class="titleTd">核价说明：</td>
			<td id="checkText" colspan="3" class="editTd"><html:textarea property="checkPriceRemark" cols="90" rows="4" styleClass="readonlyInput" readonly="true"/></td>
		</tr>
		<tr class="titleTr">
			<td id="checkL" class="titleTd">核损意见：</td>
			<td id="checkpTd" class="editTd"><estar:select property="checkLogVO.checkResult" codeId="003"  onchange="setCheckIdea()"  styleClass="needInput"/></td>
     		<td id="lossRem" class="titleTd">核损说明：</td>
     		<td id="checkText" colspan="3" class="editTd"><html:textarea property="checkLogVO.checkIdea" cols="90" rows="4" styleClass="needInput"/></td>
		</tr>
	</logic:equal>
	<tr class="titleTr" id="caseFlow" style="display: none" >
		<td class="titleTd">案件流程：</td>
		<td colspan="5" class="editTd"><estar:select property="vo.caseFlow" codeId="149" notempty="true" msg="案件流程" styleClass="needInput" disabled="true"/></td>
	</tr>
	<tr class="titleTr">
		<td valign=top colspan="6"><font color="red">历史信息:</font></td>
	</tr>
	<tr class="titleTr">
		<td colspan="6">
		<table width="100%" border="0" cellspacing="1" cellpadding="2" class="listTable">
			<tr>
				<td  width=2% class="listHeadertd"><div align="center">序号</div></td>
				<td width=7% class="listHeadertd"><div align="center">操作人</div></td>
				<td width=10% class="listHeadertd"><div align="center">操作机构</div></td>
				<!-- <td width=12% class="listHeadertd"><div align="center">操作时间</div></td> -->
				<td width=7% class="listHeadertd"><div align="center">操作类型</div></td>
				<td width=7% class="listHeadertd"><div align="center">操作结论</div></td>
				<td width=2% class="listHeadertd"><div align="center">次数</div></td>
				<td width=7% class="listHeadertd"><div align="center">配件金额</div></td>
				<td width=7% class="listHeadertd"><div align="center">操作金额</div></td>
				<td width=15% class="listHeadertd"><div align="center">操作说明</div></td>
				<td width=12% class="listHeadertd"><div align="center">流入时间</div></td>
				<td width=12% class="listHeadertd"><div align="center">流出时间</div></td>
			</tr>
			<logic:present name="surveyAutoForm" property="checkLogList">
			 <logic:iterate id="checkLogList" name="surveyAutoForm" property="checkLogList" indexId="idx">
			   <tr class="titleTr">
				    <td><%=idx.intValue()+1%></td>
				    <td ><bean:write name="checkLogList" property="checkEmpNme"/></td>
				    <td><bean:write name="checkLogList" property="checkDptNme"/></td>
				    <%-- <td><bean:write name="checkLogList" property="checkTm"/></td> --%>
				    <td><estar:writeDict name="checkLogList" property="checkType"/></td>
				    <td><estar:writeDict name="checkLogList" property="checkResult"/></td>
				    <td><bean:write name="checkLogList" property="checkTms"/></td>
				    <td><bean:write name="checkLogList" property="fittingsAmt"/></td>
				    <td><bean:write name="checkLogList" property="totalAmt"/></td>
				    <td><bean:write name="checkLogList" property="checkIdea"/></td>
				    <td>
				    	<logic:empty name="checkLogList" property="appointTm">
				    		 <bean:write name="checkLogList" property="startOperateTm"/>
				       </logic:empty>
					    <logic:notEmpty name="checkLogList" property="appointTm">
					         <bean:write name="checkLogList" property="appointTm"/> 
					    </logic:notEmpty>
				    </td>
				    <td><bean:write name="checkLogList" property="flowoutTm"/></td>
			    </tr>
			 </logic:iterate>
			</logic:present>
		</table>
		</td>
	</tr>
	<tr class="titleTr">
		<td align=center colspan="6">
		  <div id="exceptiveClamInfo"></div>
		</td>
	</tr>
</TABLE>
 <table width="970" border="0" cellspacing="1" cellpadding="1">
	<tr><td colspan="2" height="10"></td></tr>
	<tr class="titleTr">
		<td align="center">
		    <span id="recyckePrintBtn"></span>&nbsp;
		    <input type="button" name="reportedBtn"  value="报案信息" onclick="javascript:to_report('caseNo');"/>
		    <input type=button name="survey" style="width: 80" value="现场查勘"  onclick="javascript:tosurvey();"/>
		    <input type="button" name="addInquiry" value="疑案上报" onclick="checkinquiry();" >
			<input type="button" name="inquiry1" value="疑案详情" onclick="show_inquiry();" >
			<input type="button" name="addFmc" value="重案上报" onclick="openmajor();"/>
			<input type="button" name="major1" value="重案详情" onclick="show_major();"/>
			<logic:equal name="surveyAutoForm" property="isCase" value="1">
				<input type="button" name="traConVehCheck" value="交管车辆查询校验" onclick="traConVCheck()" disabled="disabled">
			</logic:equal>
		</td>
	</tr>
	<tr class="titleTr">
		<td align="center">
			<input type="button" name="addpicBtn"  value="影像资料" style="width:80;" onclick="to_imageSys()"/>
			<input type="button" name="insdel_c" value="案件信息备忘录" onclick="show_pendingCase('${surveyAutoForm.caseNo}')">
			<input type="button" id="add_surveyFee" name="add_surveyFee" value="查勘费预付" onclick="add_feePrepay()" disabled="disabled">
			<input name="save" type=button style="width: 80" value="暂存"  onclick="click_submit('save')"/> 
			<input name="abandbutton" type=button style="width: 80" value="放弃"  onclick="abandon_submit()" disabled/>
			<logic:equal name="surveyAutoForm" property="isValidDpt" value="1">
			<input type="button" id="forward" name="forward" value="转发" disabled="disabled" onclick="to_forward()" />
			</logic:equal>
			<input id="putin" name="putin" type=button style="width: 80" value="提交"  onclick="click_submit('submit');"/> 
			<input type="button" name="close" style="width: 80" value="关闭"  onclick="javascript:window.close();"/>
		</td>
		<td></td>
	</tr>
	<tr class="titleTr"><td colspan="2">&nbsp;</td></tr>
</table>

<html:hidden property="vo.repairFactoryCode"/>
<html:hidden property="dispatchIdByImg"/>
<html:hidden property="dispatchId"/>
<html:hidden property="caseNo"/>
<html:hidden property="saveRecyclePrintId"/>

<html:hidden property="dictIns"/>
<html:hidden property="dictCheck"/>
<html:hidden property="dictFeeType"/>
<html:hidden property="dictFitType"/>

<html:hidden property="vo.dispatchId" />
<html:hidden property="vo.caseNo" />
<html:hidden property="vo.autoFlag" />
<html:hidden property="vo.tms"/>
<html:hidden property="vo.state"/>
<html:hidden property="dispatchVo.dispSubtype"/>
<html:hidden property="dispatchVo.taskStat"/>
<html:hidden property="dispatchVo.checkStat"/>
<html:hidden property="dispatchVo.checkLevel"/>
<html:hidden property="dispatchVo.backType"/>
<html:hidden property="dispatchVo.sendMrk"/>
<html:hidden property="dispatchVo.surveyType"/>
<html:hidden property="dispatchVo.completeTm"/>
<html:hidden property="dispatchVo.surveyEmpCde"/>
<html:hidden property="dispatchVo.surveyEmpNme"/>

<html:hidden property="operateFlag"/>
<html:hidden property="sysAction"/>
<html:hidden property="dptCde"/>
<html:hidden property="checkLogVO.checklogId"/>
<html:hidden property="checkLogVO.dispatchId"/>
<html:hidden property="checkLogVO.checkTms"/>
<html:hidden property="checkLogVO.checkType"/>

<html:hidden property="checkPicTotalAmt"/>
<html:hidden property="checkPicCosAmt"/>
<html:hidden property="checkLossTotalAmt"/>
<html:hidden property="checkPicSignlAmt"/>
<html:hidden property="checkPicManageRate"/>

<html:hidden property="checkPicLevel"/>
<html:hidden property="checkLosLevel"/>
<html:hidden property="userCheckLossLevel"/>

<html:hidden property="actionFlag"/>

<html:hidden property="saveFlag"/>
<input type="hidden" name="feeKind" value="0540001">

<html:hidden property="fittingFlag"/>
<html:hidden property="fittingMsg"/>
<html:hidden property="fittingUrl"/>

<html:hidden property="updateTm"/>
<html:hidden property="userId"/>
<html:hidden property="userName"/>
<html:hidden property="dptId"/>
<html:hidden property="deptName"/>
<html:hidden property="lcnNo"/>
<html:hidden property="thrLonNoString"/>
<input type="hidden" name="newImgFlag" value="<%=newImgFlag%>"/>
<html:hidden property="flag"/>
<html:hidden property="msg"/>

<html:hidden property="factoryNames"/>
<html:hidden property="factoryNamesNo"/>

<html:hidden property="registeredNew"/>
<html:hidden property="deleteRepair"/>
<html:hidden property="inquiryFlag"/>
<html:hidden property="mobileSurveyFlag"/>
<html:hidden property="devolveFlag"/>
<html:hidden property="devolveDptCde"/>
<html:hidden property="bumpDictIns"/>
<html:hidden property="checkStringMsg"/>
<html:hidden property="ischeckPicUpReportMsg"/>
<html:hidden property="forceThirdCompany"/>
<html:hidden property="businessThirdCompany"/>
<html:hidden property="backShopStructure"/>

<html:hidden property="thirdCompany"/>


<html:hidden property="claimVO.directTrainFlag"/>
<html:hidden property="claimVO.caseNo"/>
<html:hidden property="claimVO.caseDuty"/>
<html:hidden property="directTrainOpr"/>
<html:hidden property="directTrainMess"/>
<input type="hidden" id="nonDireFlag" value = "0" />

 <!-- REQ00023899--反欺诈江苏--理赔交管车辆查询 --add by suchengong 2016年5月31日  start  -->
 <html:hidden property="isCase"/>
 <html:hidden property="isTraConVehCheck"/>
 <html:hidden property="isTraConVehConfirm"/>
 <!-- REQ00023899--反欺诈江苏--理赔交管车辆查询 --add by suchengong 2016年5月31日 end  -->

 <!--  REQ00024334--理算带入车辆定损其他交强赔付金额计算改造  add by liuchun 2016年6月28日13:41:56 start-->
 <html:hidden property="otherForceMustFlag"/>
 <html:hidden property="directFlag"/>
 <!--  REQ00024334--理算带入车辆定损其他交强赔付金额计算改造  add by liuchun 2016年6月28日13:41:56 end-->

</html:form>
<script>
	//弹出提示确认是否核价上报
	if(document.getElementById("ischeckPicUpReportMsg").value =='1'){		
		if(window.confirm("当前核价权限不够，是否上报？")){
            document.getElementById("upreportFlag").value="1"; 
        	click_submit('submit');
        } 
	}
	//配件定损金额与核价金额是否一致
	if(document.getElementById("ischeckPicUpReportMsg").value =='2'){				
		alert("配件定损金额与核价金额不一致，不能选择[同意]意见");
	}
	//精友返回或者初始页面时，提示定损数量大于3的配件
	//warnCheckFittingsNum();
	if(document.getElementById("checkStringMsg").value !=''){
		alert(document.getElementById("checkStringMsg").value);
	}
	 	

	var InquiryFlag = document.getElementById("inquiryFlag").value;
	if(InquiryFlag == "1"){
		//if(confirm("该案件以发起疑案流程，经调查存在异常，点击查看具体详情！")){
			toInquiry();
		//}
	}
	var winOpener=window.opener;
	var flag=winOpener.document.getElementById("flag").value;//读取父窗口的车表示。
	var userid=winOpener.document.getElementById("userId").value;//读取父窗口的车表示。
	if(getFieldValue("sysAction")=="endUp"){//并发处理
		alert("对不起，在你之前已有人操作过本次任务！");
	}else if(getFieldValue("sysAction")=="major"){//重案处理
		alert("对不起，案件已经发起重案流程！");
	}else if(getFieldValue("sysAction")=="cooperNoUse"){//REQ00028513--移动查勘二期开发 modify by jianglf 合作修理厂无效
		alert("对不起，您选择的合作修理厂已失效，请更换！");
	}
	
	if(document.getElementById("dispatchVo.taskStat").value=="0150002"||document.getElementById("dispatchVo.checkStat").value=="0390003"||document.getElementById("dispatchVo.taskStat").value=="0150006"){
		document.getElementById("abandbutton").disabled=false;
	}
	if(getFieldValue("vo.autoFlag")=="0400002"){//三者车
		document.getElementById("feeKind").value = "0540002";
		document.all.item("vo.engNo").className="editInput";
	    document.all.item("vo.drvOwner").className="editInput";
	    document.all.item("vo.driveType").className="editInput";
	}else{
		document.getElementById("caseFlow").style.display="";
	}
	
	var operateFlag = getFieldValue("operateFlag");
	if(operateFlag=="survey"){
		if(getFieldValue("upreportFlag")=="3"){
			document.getElementById("chelprice").style.display="inline";
		    document.getElementById("chelloss").style.display="inline"; 
		}
		if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"||getFieldValue("vo.dispatchId")=="0"){//0150003：任务完成
			initSurvey();
		}else {
			var openobj =  new Array();
			openobj[0] = "close";
			openobj[1] = "insdel_c";
			openobj[2] = "addpicBtn";
			setreadonly(openobj);
		}
	}else if(operateFlag=="checkPrice"){
		if(getFieldValue("actionFlag")=="1"){
	        var openobj =  new Array();
			openobj[0] = "close";
			openobj[1] = "insdel_c";
			openobj[2] = "addpicBtn";
			setreadonly(openobj);
	    }else if(getFieldValue("dispatchVo.checkStat")=="0390002"||getFieldValue("dispatchVo.checkStat")=="0390003"){//0390004：任务完成
			initCheckPrice();
			document.getElementById("addFmc").disabled=true;
			document.getElementById("forcedcheprice").style.display= "inline";
		}else {
			var openobj =  new Array();
			openobj[0] = "close";
			openobj[1] = "insdel_c";
			openobj[2] = "addpicBtn";
			setreadonly(openobj);
		}
		
		document.getElementById("csurvey").style.display="inline";	
		//document.getElementById("checkPrice").style.display="inline";	
	}else if(operateFlag=="checkLoss"){
	    if(getFieldValue("actionFlag")=="1"){
	        var openobj =  new Array();
			openobj[0] = "close";
			openobj[1] = "insdel_c";
			openobj[2] = "addpicBtn";
			setreadonly(openobj);
	    }else if((getFieldValue("dispatchVo.taskStat")=="0150003"||getFieldValue("dispatchVo.taskStat")=="0150006")
				&&((getFieldValue("dispatchVo.checkStat")=="0390004")||(getFieldValue("dispatchVo.checkStat")=="0390001"))){//0150007：任务完成
	    	document.getElementById("forcedcheloss").style.display= "inline";	
	    	initCheckLoss();
		}else{
			var openobj =  new Array();
			openobj[0] = "close";
			openobj[1] = "insdel_c";
			openobj[2] = "addpicBtn";
			setreadonly(openobj);
		}
		document.getElementById("csurvey").style.display="inline";
	}else{
	   	var openobj =  new Array();
		openobj[0] = "close";
		openobj[1] = "insdel_c";
		openobj[2] = "addpicBtn";
		setreadonly(openobj);
	}
	
	if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"){
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(定损中)";
		}else{
		    document.title="本车定损信息(定损中)";
		}
	}else if(getFieldValue("dispatchVo.checkStat")=="0390002"||getFieldValue("dispatchVo.checkStat")=="0390003"){
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(核价中)";
		}else{
		    document.title="本车定损信息(核价中)";
		}
	}else if((getFieldValue("dispatchVo.taskStat")=="0150003"||getFieldValue("dispatchVo.taskStat")=="0150006")
			&&((getFieldValue("dispatchVo.checkStat")=="0390004")||(getFieldValue("dispatchVo.checkStat")=="0390001"))){//0150007：任务完成
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(核损中)";
		}else{
		    document.title="本车定损信息(核损中)";
		}
	}else{
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(任务完成)";
		}else{
		    document.title="本车定损信息(任务完成)";
		}		
	}
	if(getFieldValue("saveFlag")=="1"){
		if(getFieldValue("directTrainOpr")=="1"){
			if(confirm("理赔直通车案件需要先进行免赔率信息录入，是否确定？")){
				openNonper();
			}
		}else{
			alert("操作已成功！");
			var a = new Array();
			a[0] = document.getElementById("vo.dispatchId").value;
			a[1] = document.getElementById("vo.lcnNo").value;
			a[2] = document.getElementById("vo.drvOwner").value;
			a[3] = document.getElementById("vo.vhlFrm").value;
			a[4] = document.getElementById("vo.factoryType").options[document.getElementById("vo.factoryType").selectedIndex].text;
			a[5] = document.getElementById("vo.repairFactory").value;
			a[6] = document.getElementById("vo.brndNme").value;
			a[7] = document.getElementById("vo.lossAmt").value;
			a[8] = document.getElementById("dispatchVo.taskStat").value;
			a[9] = document.getElementById("dispatchVo.checkStat").value;
			a[10] = document.getElementById("dispatchVo.surveyEmpNme").value;
			//window.returnValue = a;
			window.opener.insertAuto(a,flag,userid);
			 
			if(getFieldValue("sysAction")=="submit"||getFieldValue("sysAction")=="abandon"){
				var openobj =  new Array();
				openobj[0] = "close";
				openobj[1] = "insdel_c";
				openobj[2] = "addpicBtn";
				setreadonly(openobj);
			}
		}
	}else if(getFieldValue("saveFlag")=="devolveBf"){	//与委托并发
		alert("该任务当前的操作机构为"+getFieldValue("sysAction")+",您没有该机构的操作权限！");
	}else if(getFieldValue("saveFlag")=="directRuleErr"){
		alert(getFieldValue("sysAction"));
	}
	//REQ00024306--直通车计算及移动查勘接口改造  add limingyue 2016-06-16-10:10---start
	else if(getFieldValue("saveFlag")=="directRulePayErr"){
		if(confirm("理赔直通车案件需要先录入支付信息，是否确定？")){
				show_PayInfo();
			}
	}
	//REQ00024306--直通车计算及移动查勘接口改造  add limingyue 2016-06-16-10:10---end
	
	/*
	var jj=document.getElementById("fitIndex").value;
	for(var i=0;i<jj;i++){
	    if(parseFloat(getFieldValue("autoFittingsList["+i+"].checkPiece"))!=parseFloat(getFieldValue("autoFittingsList["+i+"].piece"))){
	    	document.getElementById("autoFittingsList["+i+"].checkPiece").className="numCheckInput";
	    }
	    if(parseFloat(getFieldValue("autoFittingsList["+i+"].checkAmt"))!=parseFloat(getFieldValue("autoFittingsList["+i+"].srvyAmt"))){
	       document.getElementById("autoFittingsList["+i+"].checkAmt").className="numCheckInput";
	    }
	    if(parseFloat(getFieldValue("autoFittingsList["+i+"].checkSrv"))!=parseFloat(getFieldValue("autoFittingsList["+i+"].srv"))){
	       document.getElementById("autoFittingsList["+i+"].checkSrv").className="numCheckInput";
	    }
	}
	var ii=document.getElementById("repairIndex").value;
	for(var j=0;j<ii;j++){
	   	if(parseFloat(getFieldValue("autoRepairList["+j+"].checkAmt"))!=parseFloat(getFieldValue("autoRepairList["+j+"].repairAmt"))){
	        document.getElementById("autoRepairList["+j+"].checkAmt").className="numCheckInput";
	   	}
	}
	var hh = document.getElementById("lossFeeIndex").value;
	for(var k=0;k<hh;k++){
	  	if(parseFloat(getFieldValue("lossFeeList["+k+"].checkFee"))!=parseFloat(getFieldValue("lossFeeList["+k+"].feeAmt"))){
	    	document.getElementById("lossFeeList["+k+"].checkFee").className="numCheckInput";
	   	}
	}
	**/
	if(getFieldValue("fittingFlag")=="1"){
	 	if(getFieldValue("fittingMsg")==""){
	 		var url =  "../survey/fittingRedirct.do";
			window.showModalDialog(url,document,"dialogHeight:700px;dialogWidth:1015px;dialogTop=0,dialogLeft=0,center=yes,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
	 	}else{
			alert(getFieldValue("fittingMsg"));	 	
	 	}
	 	var url =  "../survey/fittingRedirct.do";
		window.showModalDialog(url,document,"dialogHeight:700px;dialogWidth:1015px;dialogTop=0,dialogLeft=0,center=yes,status=yes,toolbar=no,menubar=no,location=no,scrollbars =yes");
		//window.open(url);
	}
</script>

<script type="text/javascript">
//配件列表初始化
	var fIndex=document.getElementById("fitIndex").value;
// 	for(var i=0;i<fIndex;i++){   
		//document.getElementById("autoFittingsList["+i+"].fittingsNme").className=getFieldValue("autoFittingsList["+i+"].fitNmeStyle");
		//document.getElementById("autoFittingsList["+i+"].srvyAmt").className=getFieldValue("autoFittingsList["+i+"].fitAmtStyle");
		//document.getElementById("autoFittingsList["+i+"].piece").className=getFieldValue("autoFittingsList["+i+"].fitPieceStyle");
		//document.getElementById("autoFittingsList["+i+"].srv").className=getFieldValue("autoFittingsList["+i+"].fitSrvStyle");
		//fitAllStyle
// 	}
	if(getFieldValue("vo.manageAmtStyle")!="")
		//document.getElementById("vo.manageAmt").className=getFieldValue("vo.manageAmtStyle");
</script>

<script type="text/javascript">
	var operateFlag = getFieldValue("operateFlag");
	var flag = document.getElementById("putin").disabled;
	if(operateFlag!="survey"){ // 不等于查勘时
		if(getFieldValue("saveFlag")=="1"){
		  document.getElementById("exceptiveClamInfo").innerHTML="<iframe name='exceptiveClamInfoFrame' width='100%' src='../common/exceptiveClam.do?mhd=toShow&flag=1&caseNo=<%=(String)request.getParameter("caseNo")%>' frameborder='0' scrolling='auto'/>";
		} else if(!flag){
		  document.getElementById("exceptiveClamInfo").innerHTML="<iframe name='exceptiveClamInfoFrame' width='100%' src='../common/exceptiveClam.do?mhd=toShow&flag=0&claimLink=00P0204&caseNo=<%=(String)request.getParameter("caseNo")%>' frameborder='0' scrolling='auto'/>";
		}
	}
	//案件锁定状态
    if(document.getElementById("flag").value == "-1"){
		alert(document.getElementById("msg").value);
		var openobj =  new Array();
		openobj[0] = "close";
		openobj[1] =  "reportedBtn";
		openobj[2] =  "survey";
		openobj[3] = "addpicBtn";
		openobj[4] = "insdel_c";
		setreadonly(openobj);		
	}
</script>
<script type="text/javascript">
//REQ00028513--移动查勘二期开发 add by jianglf 选择合作修理厂  核价核损管控
	var cooperFactoryFlag = getFieldValue("cooperFactoryFlag");
	if("1"==cooperFactoryFlag){
		document.getElementById("cooperCheck").checked="checked";
		document.getElementById("vo.repairFactory").disabled="disabled";
		document.getElementById("vo.factoryType").disabled="disabled";
	}
</script>
<script type="text/javascript">
	 var operateFlag = getFieldValue("operateFlag");
	 //经核查，配件回收功能目前系统中并未开放，故此处不需对 回收标志做处理    modify by hujl  2014-7-22  start  //	
	 /*
	 if(operateFlag=="checkLoss"){ // 等于核损时
		var fitIndex=document.getElementById("fitIndex").value;
		var checkLosLevel=document.getElementById("userCheckLossLevel").value;//当前核损人的级别
				
		for(var i=0;i<parseInt(fitIndex);i++){
			var fitlevel=document.getElementById("autoFittingsList["+i+"].level").value;//配件修改级别
			var recycleResult=document.getElementById("autoFittingsList["+i+"].recycleResult").value;//回收结果  等 "" 就没有确认，其他确认。
			var clmTms=document.getElementById("autoFittingsList["+i+"].clmTms").value;//确认标志，等1就确认，0没有确认。
            
			if((fitlevel==""||fitlevel=="0"||parseInt(checkLosLevel)>=parseInt(fitlevel))&&recycleResult==""&&clmTms==0){//当前操作人的级别大于或的等于配件的可操作级别，方的修改回收。
				document.getElementById("autoFittingsList["+i+"].callBackFlag").disabled=false;
				//全部回收的 checkBox 是否 disabled				
// 				 if (document.getElementById("checkAll").disabled) {
// 				  document.getElementById("checkAll").disabled=false;
// 				} 
			}
		}		
	} else if (operateFlag=="survey") { // 定损时
	  var fitIndex=document.getElementById("fitIndex").value;
	  for(var i=0;i<parseInt(fitIndex);i++){
			var recycleFlag=document.getElementById("autoFittingsList["+i+"].recycleFlag").value;//回收完成标志（0：未完成，1：完成）
						
			// 在定损的时如果是理算/核赔退回的任务且回收标志为回收，该任务不能修改或是删除
			if(recycleFlag=="1"){
				readonlyFitlist(i);
				document.getElementsByName("fitDelBut")[i].disabled=true;
			}
		}
	}
	
	if(getFieldValue("saveFlag")=="1" || document.getElementById("dispatchVo.taskStat").value=="0150007"){	
		var fitIndex=document.getElementById("fitIndex").value;
		//document.getElementById("checkAll").disabled=true;
	    for(var i=0;i<parseInt(fitIndex);i++){
	      document.getElementById("autoFittingsList["+i+"].callBackFlag").disabled=true;
		}
    }
	//核损完	
	if(document.getElementById("dispatchVo.taskStat").value=="0150007"){	
		var recyckePrintHtml = ""; 
	    for(var i=0;i<parseInt(fitIndex);i++){
			var callBackFlag=document.getElementById("autoFittingsList["+i+"].callBackFlag").checked;//回收标志取得
			if (callBackFlag) {
			   recyckePrintHtml = "<input type=button value='回收单' onclick='printRecycle()'/>";
			   break;
			}
		}
		document.getElementById("recyckePrintBtn").innerHTML=recyckePrintHtml;	 
	}
    
    */
    //经核查，配件回收功能目前系统中并未开放，故此处不需对 回收标志做处理    modify by hujl  2014-7-22  end  //
	
	sumFittings(document.getElementById("autoFittingsList[0].srvyAmt"));	//精友返回后，计算配件金额
	sumRepair(document.getElementById("autoRepairList[0].repairAmt"));	//精友返回后，计算工时金额
	
	/***************核价金额录入控制**************/
	var operateFlag = getFieldValue("operateFlag");
	if(operateFlag!="checkPrice"){	// 核价
		setPriceReadonly('true');
	}
	/************为不同保存状态的配件和工时置颜色标识 start*************/
	setJyBgColor();
	/************为不同保存状态的配件和工时置颜色标识 end*************/
	
	
	/*****************非委托任务不展示委托类型 shilk start*****************/
	//判断定损核价核损环节是否委托
	var devolveFlag = "";
	if(operateFlag=="survey"){		//定损
		devolveFlag = document.getElementById("dispatchVo.devolveFlag").value;
	}else if(operateFlag=="checkPrice"){	//核价
		devolveFlag = document.getElementById("dispatchVo.devolveCheckFlag").value;
	}else if(operateFlag=="checkLoss"){		//核损
		devolveFlag = document.getElementById("dispatchVo.devolveCheckLossFlag").value;
	}
  	if(devolveFlag != "1"){	//若当前环节未委托
  		document.getElementById("dispatchVo.devolveType").value = "";
  		document.getElementById("dispatchVo.devolveType").disabled = true;	
  	}
  	/*****************非委托任务不展示委托类型 shilk end*****************/
  	
  	/***************按钮控制代码 start**************/
  	if(operateFlag != "survey"){
  		document.getElementById("customfit").disabled = true;
  		document.getElementById("addrepair").disabled = true;
  	}
  	/***************按钮控制代码 end**************/
  	
  	/*********************查勘费预付按钮控制 start********************/
  	if(getFieldValue("operateFlag") == "survey"){
  		if(document.getElementById("putin").disabled){
			document.getElementById("add_surveyFee").disabled = true;
		}else{
			document.getElementById("add_surveyFee").disabled = false;
		}
  	}
  	/*********************查勘费预付按钮控制 end********************/	
  	/***********************江苏反欺诈***************************/
  	if(!document.getElementById("putin").disabled){
  		jiangSuAntifraud(getFieldValue("caseNo"));
  	}
  	//成功 看是否存在重案、疑案。 都存在，都可以点 不存在不可以
 	getInquiry(getFieldValue("caseNo"),document.getElementById("inquiry1"),document.getElementById("major1"));
	//<!-- 	2015/7/28修理厂组织机构代码证和第三者车辆承保公司名称做系统改造  成功   -->
	// REQ00021303 add by chenggong 2015-8-20 --辽宁三者车定损环节增加录入字段   
	document.getElementById("forceThirdCompany").value=document.getElementById("vo.forceThirdCompany").value;
    document.getElementById("businessThirdCompany").value=document.getElementById("vo.businessThirdCompany").value;
    document.getElementById("backShopStructure").value=document.getElementById("vo.backShopStructure").value;
	if(getFieldValue("dispatchVo.taskStat")=="0150001"||getFieldValue("dispatchVo.taskStat")=="0150002"){
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(定损中)";
		   	document.getElementById("forceThirdCompanyName").style.display="inline";
		   	document.getElementById("forceThirdCompanyText").style.display="inline";
		   	document.getElementById("businessThirdCompanyName").style.display="inline";
		   	document.getElementById("businessThirdCompanyText").style.display="inline";
// 		    document.getElementById("forceThirdCompany").value=document.getElementById("vo.forceThirdCompany").value;
// 		    document.getElementById("businessThirdCompany").value=document.getElementById("vo.businessThirdCompany").value;
// 		    document.getElementById("backShopStructure").value=document.getElementById("vo.backShopStructure").value;
		}else{
		    document.title="本车定损信息(定损中)";
		    document.getElementById("backShopStructureText").colSpan="5";
		}
	}else if(getFieldValue("dispatchVo.checkStat")=="0390002"||getFieldValue("dispatchVo.checkStat")=="0390003"){
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(核价中)";
			document.getElementById("forceThirdCompanyName").style.display="inline";
		   	document.getElementById("forceThirdCompanyText").style.display="inline";
		   	document.getElementById("businessThirdCompanyName").style.display="inline";
		   	document.getElementById("businessThirdCompanyText").style.display="inline";
		}else{
		    document.title="本车定损信息(核价中)";
		    document.getElementById("backShopStructureText").colSpan="5";
		}
		document.getElementById("vo.backShopStructure").disabled=true;
	    document.getElementById("vo.forceThirdCompany").disabled=true;
	    document.getElementById("vo.businessThirdCompany").disabled=true;
// 	    document.getElementById("forceThirdCompany").value=document.getElementById("vo.forceThirdCompany").value;
// 	    document.getElementById("businessThirdCompany").value=document.getElementById("vo.businessThirdCompany").value;
// 	    document.getElementById("backShopStructure").value=document.getElementById("vo.backShopStructure").value;
	}else if((getFieldValue("dispatchVo.taskStat")=="0150003"||getFieldValue("dispatchVo.taskStat")=="0150006")
			&&((getFieldValue("dispatchVo.checkStat")=="0390004")||(getFieldValue("dispatchVo.checkStat")=="0390001"))){//0150007：任务完成
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(核损中)";
			document.getElementById("forceThirdCompanyName").style.display="inline";
		   	document.getElementById("forceThirdCompanyText").style.display="inline";
		   	document.getElementById("businessThirdCompanyName").style.display="inline";
		   	document.getElementById("businessThirdCompanyText").style.display="inline";
		   
		}else{
		    document.title="本车定损信息(核损中)";
		    document.getElementById("backShopStructureText").colSpan="5";
		}
		document.getElementById("vo.backShopStructure").disabled=true;
	    document.getElementById("vo.forceThirdCompany").disabled=true;
	    document.getElementById("vo.businessThirdCompany").disabled=true;
// 	    document.getElementById("forceThirdCompany").value=document.getElementById("vo.forceThirdCompany").value;
// 		document.getElementById("businessThirdCompany").value=document.getElementById("vo.businessThirdCompany").value;
// 		document.getElementById("backShopStructure").value=document.getElementById("vo.backShopStructure").value;
	}else{
		if(getFieldValue("vo.autoFlag")=="0400002"){
			document.title="三者车定损信息(任务完成)";
			document.getElementById("forceThirdCompanyName").style.display="inline";
		   	document.getElementById("forceThirdCompanyText").style.display="inline";
		   	document.getElementById("businessThirdCompanyName").style.display="inline";
		   	document.getElementById("businessThirdCompanyText").style.display="inline";
		   	
		}else{
		    document.title="本车定损信息(任务完成)";
		    document.getElementById("backShopStructureText").colSpan="5";
		}
// 		document.getElementById("vo.backShopStructure").disabled=true;
// 	    document.getElementById("vo.forceThirdCompany").disabled=true;
// 	    document.getElementById("vo.businessThirdCompany").disabled=true;
// 	    document.getElementById("forceThirdCompany").value=document.getElementById("vo.forceThirdCompany").value;
// 	    document.getElementById("businessThirdCompany").value=document.getElementById("vo.businessThirdCompany").value;
// 	    document.getElementById("backShopStructure").value=document.getElementById("vo.backShopStructure").value;
	}
	// REQ00021303 add by chenggong 2015-8-20 --辽宁三者车定损环节增加录入字段   
	var va=getFieldValue("dptCde");
	var dptc=va.substr(0, 5);
	var dptd=va.substr(0,3);
	var startT=document.getElementById("dispatchVo.completeTm").value;
	if(dptd=="221"){
		if(dptc!='22102'&&(startT>"2015-08-08 00:00:00"||startT=="")){
			document.getElementById("vo.backShopStructure").className="needInput";
			document.getElementById("vo.forceThirdCompany").className="needInput";
			document.getElementById("vo.businessThirdCompany").className="needInput";
		}
	}

	//REQ00022141 - 新车险理赔系统--任务分发器需求--分机构上线 add by zhangnn 2016年7月25日 
	if(getFieldValue("isValidDpt") == "1"){
		//---------------任务分发器 - 转发模块 控制核价、核损暂存页面【转发】按钮禁用 add by zhangnn 2015-11-9-----------------------
		if(document.getElementById("operateFlag").value=="checkPrice" || document.getElementById("operateFlag").value=="checkLoss"){
			document.getElementById("forward").removeAttribute("disabled");
			var sysAction = document.getElementById("sysAction").value;
			if(sysAction == "0" || sysAction == "submit"){
				document.getElementById("forward").disabled = "disabled";
			}
		}
	}

	//REQ00024334--理算带入车辆定损其他交强赔付金额计算改造
	//add by liuchun 2016年6月28日13:40:33 无需页面再计算其他交强险赔付金额
	//calOthForceAmt();	//计算其他交强险赔付的值（车损险）

</script>
</BODY>
</html>
